(()=>{var e={43:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var n={onEnterInner:function(){this.game.mulle.user.Car.hasMedal(2)||(this.game.mulle.playAudio("05d010v0"),this.game.mulle.user.Car.addMedal(2))}};const i=n},57:(e,t,r)=>{"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,s=[],u=!0,l=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||o(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){if(e){if("string"==typeof e)return a(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(e,t):void 0}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,u(n.key),n)}}function u(e){var t=function(e,t){if("object"!=n(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=n(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==n(t)?t:t+""}r.d(t,{A:()=>l});const l=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.game=t,this.name_cache={},this.movie_cache={}},r=[{key:"getDirectorImage",value:function(e,t,r){var n=e.mulle.getDirectorImage(t,r);return[n.key,n.frame]}},{key:"getSpriteSheetImage",value:function(e,t){var r,n=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=o(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(u)throw a}}}}(game.cache.getImage(e,!0).frameData.getFrames());try{for(n.s();!(r=n.n()).done;){var i=r.value;if(i.dirNum===t)return i}}catch(e){n.e(e)}finally{n.f()}console.error("No image with cast number",t)}},{key:"button",value:function(e,t,r,n,o,a,s,u){var l,c,f,h,m,d=arguments.length>8&&void 0!==arguments[8]&&arguments[8];if(s){var p=i(this.getDirectorImage(e,a,s),2);l=p[0],h=p[1],f=l}else l=null;if(u){var y=i(this.getDirectorImage(e,a,u),2);c=y[0],m=y[1],f=c}else c=null,m={name:void 0};if(l&&c&&l!==c)throw Error("Frames are from different sprite sheets");if(null===t&&null===r&&m&&(t=320-m.regpoint.x,r=240-m.regpoint.y),d){var g=i(this.CenterToOuter(t,r,m.height,m.width),2);t=g[0],r=g[1]}return new Phaser.Button(e,t,r,f,n,o,h.name,m.name,null,null)}},{key:"rectangleButton",value:function(e,t,r,n,i,o,a,s,u){var l=this.button(e,t,r,o,a,s,u);return l.height=n,l.width=i,l}},{key:"sprite",value:function(e,t,r,n,o){var a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],u=i(this.getDirectorImage(e,n,o),2),l=u[0],c=u[1];if(null===t&&null===r&&(t=320-c.regpoint.x,r=240-c.regpoint.y),a){var f=i(this.CenterToOuter(t,r,c.height,c.width),2);t=f[0],r=f[1]}var h=new Phaser.Sprite(e,t,r,l,c.name);return s&&(h.pivot=c.regpoint),h}},{key:"CenterToOuter",value:function(e,t,r,n){return[e-n/2,t-r/2]}}],(t=[{key:"getImageByCastNumber",value:function(e,t){if(this.movie_cache[e]&&this.movie_cache[e][t])return this.movie_cache[e][t];var r=this.game.cache.getKeys(Phaser.Cache.IMAGE);for(var n in r){var i=game.cache.getImage(r[n],!0),o=i.frameData.getFrames();for(var a in o){var s=o[a];if(s.dirFile===e&&s.dirNum===t)return console.log("match",s),this.movie_cache[s.dirFile][s.dirNum]=[i.key,o[a].name],[i.key,o[a].name]}}return console.error("Unable to find image",name),[!1,!1]}},{key:"getNamedImage",value:function(e){if(this.name_cache[e])return this.name_cache[e];var t=this.game.cache.getKeys(Phaser.Cache.IMAGE);for(var r in t){var n=game.cache.getImage(t[r],!0),i=n.frameData.getFrames();for(var o in i)if(i[o].dirName===e)return console.log("match",i[o]),this.name_cache[e]=[n.key,i[o].name],[n.key,i[o].name]}return console.error("Unable to find image",e),[!1,!1]}}])&&s(e.prototype,t),r&&s(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}()},60:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o});var n=r(702),i={onCreate:function(){var e=this,t=new n.default(this,"CDDATA.CXT");t.add("idle","normal",1,4,!0),t.add("parting","Parting").onComplete.add(function(){e.animations.play("parted")}),t.add("parted","Outer",1,4,!0),t.add("gathering","Gathering").onComplete.add(function(){e.animations.play("idle")}),this.animations.play("idle")},onEnterInner:function(e){var t=this;if(this.game.mulle.user.Car.getProperty("horntype",0)>=5){if(this.animations.play("parting"),!this.playedSound)this.game.mulle.playAudio(["05e050v0","05e049v0","05e044v0","05e042v0","05d013v0"][this.game.mulle.user.Car.getProperty("horntype",0)-1]),this.playedSound=!0,this.game.mulle.playAudio(this.def.Sounds[1]).onStop.addOnce(function(){t.playedSound=null})}else{if(!this.playedSound)this.playedSound=!0,this.game.mulle.playAudio(this.def.Sounds[0]).onStop.addOnce(function(){t.playedSound=null});e.speed=0,e.stepback(2),this.enteredInner=!1}},onExitInner:function(){this.animations.play("gathering")},onExitOuter:function(){this.game.mulle.stopAudio(this.def.Sounds[1])}};const o=i},173:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var n={onCreate:function(){},onEnterOuter:function(e){var t=this;console.log("fill gas");var r=this.game.mulle.playAudio("31e006v0");e.enabled=!1,e.speed=0,r.onStop.addOnce(function(){e.enabled=!0}),game.time.events.repeat(330,10,function(){e.fuelCurrent=t.game.math.clamp(e.fuelCurrent+e.fuelMax/10,0,e.fuelMax)},this)}};const i=n},212:(e,t,r)=>{var n={"./CBridge":504,"./CBridge.js":504,"./Cows":826,"./Cows.js":826,"./FarAway":43,"./FarAway.js":43,"./Ferry":472,"./Ferry.js":472,"./Gas":173,"./Gas.js":173,"./Goats":60,"./Goats.js":60,"./Hill":949,"./Hill.js":949,"./Picture":970,"./Picture.js":970,"./Racing":976,"./Racing.js":976,"./Sound":643,"./Sound.js":643,"./Stop":478,"./Stop.js":478,"./Teleport":257,"./Teleport.js":257,"./WBridge":620,"./WBridge.js":620,"./animation":702,"./animation.js":702};function i(e){var t=o(e);return r(t)}function o(e){if(!r.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}i.keys=function(){return Object.keys(n)},i.resolve=o,e.exports=i,i.id=212},257:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var n={onCreate:function(){console.error("unfinished object",this.id,this)},onEnterInner:function(){}};const i=n},472:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var n={onCreate:function(){this.setDirectorMember(this.def.FrameList.normal[0]),console.log("ferry",this),this.ferryStep=0,this.isOnFerry=!1,this.fromX=this.x,this.fromY=this.y,this.ferryLoop()},ferryLoop:function(){var e=this,t=this.game.state.states[this.game.state.current].driveCar,r=t.position.distance(this.position),n=[new Phaser.Point(254,177),new Phaser.Point(369,224)];(this.isOnFerry&&(this.isOnFerry=!1,this.removeChild(t),t.oldParent.addChild(t),t.enabled=!0,t.position.set(n[this.ferryStep].x,n[this.ferryStep].y),t.bringToTop()),r<40&&!this.isOnFerry&&(this.isOnFerry=!0,t.direction=0===this.ferryStep?14:7,t.enabled=!1,t.oldParent=t.parent,this.addChild(t),t.position.set(16,16),t.bringToTop()),0===this.ferryStep)&&game.add.tween(this).to({x:this.optionalData.EndLoc.x,y:this.optionalData.EndLoc.y},3e3,Phaser.Easing.Linear.None,!0).onComplete.addOnce(function(){game.time.events.add(Phaser.Timer.SECOND,function(){e.ferryStep++,e.ferryLoop()},e)});1===this.ferryStep&&game.add.tween(this).to({x:this.fromX,y:this.fromY},3e3,Phaser.Easing.Linear.None,!0).onComplete.addOnce(function(){game.time.events.add(Phaser.Timer.SECOND,function(){e.ferryStep=0,e.ferryLoop()},e)})},onEnterInner:function(){}};const i=n},478:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var n={onCreate:function(){this.animationHelper.static("normal",this.opt.Direction),console.log(this.def.FrameList)},onEnterInner:function(e){e.speed=0,e.stepback(2)}};const i=n},504:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var n={onCreate:function(){this.animationHelper.add("normal","normal",this.opt.Direction,3,!0,!0),this.animations.play("normal"),this.game.mulle.playAudio(this.def.Sounds[0])},onEnterOuter:function(e){console.log(this.animations.frame),this.animations.frame>37&&(e.speed=0,e.stepback(2))}};const i=n},620:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var n={onCreate:function(){var e=this;this.animationHelper.static("normal",this.opt.Direction),this.animationHelper.add("splash","Splash",this.opt.Direction).onComplete.add(function(){e.visible=!1},this)},onEnterInner:function(e){var t=this,r=this.game.mulle.user.Car.getProperty("weight");r>=20?(console.log("Car weight ",r),console.log("Car too heavy, bridge broken"),this.animations.play("splash"),e.speed=0,e.stepback(9),this.playedSound||(this.playedSound=!0,this.game.mulle.playAudio(this.def.Sounds[0]).onStop.addOnce(function(){t.game.mulle.playAudio(t.def.Sounds[1])}))):(console.log("Light car"),this.game.mulle.user.Car.hasMedal(6)||(this.game.mulle.playAudio("05d010v0"),this.game.mulle.user.Car.addMedal(6)))}};const i=n},632:(e,t,r)=>{"use strict";r.d(t,{A:()=>p});var n=r(913);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,s=[],u=!0,l=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,u(n.key),n)}}function u(e){var t=function(e,t){if("object"!=i(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==i(t)?t:t+""}function l(e,t,r){return t=h(t),function(e,t){if(t&&("object"==i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,c()?Reflect.construct(t,r||[],h(e).constructor):t.apply(e,r))}function c(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(c=function(){return!!e})()}function f(){return f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=h(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},f.apply(null,arguments)}function h(e){return h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},h(e)}function m(e,t){return m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},m(e,t)}var d={};const p=function(){function e(t,r,n){var i,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),(i=l(this,e,[t,r,n,o,a])).regPoint=new PIXI.Point(0,0),i.movie="",i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&m(e,t)}(e,Phaser.Sprite),t=e,r=[{key:"updatePivot",value:function(){this._frame?this._frame.regpoint?(this.regPoint.set(this._frame.regpoint.x,this._frame.regpoint.y),this.pivot.set(this.regPoint.x,this.regPoint.y)):console.warn("no regpoint",this._frame,this.key,this._frame.name):console.warn("no frame")}},{key:"setFrame",value:function(t){var r,n,i,o,a;(r=e,n="setFrame",i=this,a=f(h(1&(o=3)?r.prototype:r),n,i),2&o&&"function"==typeof a?function(e){return a.apply(i,e)}:a)([t]),this.updatePivot()}},{key:"setFrameId",value:function(e){var t=this.game.mulle.findFrameById(e);return!!t&&(this.loadTexture(t[0],t[1]),!0)}},{key:"setDirectorMember",value:function(e,t){if(!(e&&t&&d[e+"_"+t])){var r=this.game.cache.getKeys(Phaser.Cache.IMAGE);for(var n in r){var i=this.game.cache.getImage(r[n],!0),o=i.frameData.getFrames();for(var a in o)if(t){if(o[a].dirFile===e&&(o[a].dirNum===t||o[a].dirName===t))return d[e+"_"+t]=[i.key,o[a].name],this.loadTexture(i.key,o[a].name),!0}else if(o[a].dirNum===e||o[a].dirName===e)return this.loadTexture(i.key,o[a].name),!0}return console.error("set member fail",e,t),!1}this.loadTexture(d[e+"_"+t][0],d[e+"_"+t][1])}},{key:"loadDirectorTexture",value:function(e){var t=o(this.game.director.getNamedImage(e),2),r=t[0],n=t[1];this.loadTexture(r,n)}},{key:"addAnimation",value:function(e,t,r,n){var i=this,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=[];return t.forEach(function(e){a.push(i.game.mulle.getDirectorImage(e[0],e[1]).name)}),this.animations.add(e,a,r,n,o)}},{key:"addDirectorAnimation",value:function(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=o(n.A.createAnimation(this.game,this.movie,t,r),2),s=a[0],u=a[1];return this.key?this.key!==s&&console.error("Tried to add animation using frames from a different sprite sheet"):this.key=s,this.animations.add(e,u,10,i)}}],r&&s(t.prototype,r),i&&s(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r,i}()},643:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var n={onCreate:function(){console.error("unfinished object",this.id,this)},onEnterInner:function(){}};const i=n},702:(e,t,r)=>{"use strict";function n(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||o(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,s=[],u=!0,l=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||o(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){if(e){if("string"==typeof e)return a(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(e,t):void 0}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,l(n.key),n)}}function l(e){var t=function(e,t){if("object"!=s(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=s(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==s(t)?t:t+""}r.r(t),r.d(t,{default:()=>c});const c=function(){return e=function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"CDDATA.CXT";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.sprite=t,this.game=t.game,this.movie=r},t=[{key:"hasFrames",value:function(){return"object"===s(this.sprite.def.FrameList)&&this.sprite.FrameList.length>0}},{key:"hasNamedAnimations",value:function(){if(this.hasDirections())return!Array.isArray(this.sprite.FrameList[1]);var e=Object.keys(this.sprite.FrameList);return"object"===s(this.sprite.FrameList[e[0]])}},{key:"hasDirections",value:function(){return void 0!==this.sprite.FrameList[1]}},{key:"getFrames",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=this.sprite.FrameList;if(this.hasDirections()){if(void 0===r[t])return console.error("Invalid direction ".concat(t," for MapObject ").concat(this.sprite.id)),[];if(!this.hasNamedAnimations())return r[t];r=r[t]}if(this.hasNamedAnimations())return void 0===r[e]?(console.error("Invalid animation ".concat(e," for MapObject ").concat(this.sprite.id)),[]):r[e];throw Error("No frames found for animation "+e+" direction "+t+"in map object "+this.sprite.id)}},{key:"resolveDirectorFrames",value:function(e){console.log("resolve frames",e);var t,r,n,a=[],s=function(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=o(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return s=e.done,e},e:function(e){u=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(u)throw a}}}}(e);try{for(s.s();!(n=s.n()).done;){var u=n.value;if("Dummy"!==u){if(isNaN(+u)){var l=i(this.game.director.getNamedImage(u),2);t=l[0],r=l[1]}else{var c=i(this.game.director.getImageByCastNumber(this.movie,u),2);t=c[0],r=c[1]}if(!r)throw Error("Unable to resolve frame "+u);console.log("Frame matched as",t,r),a.push(r)}}}catch(e){s.e(e)}finally{s.f()}return this.sprite.key!==t&&this.sprite.loadTexture(t),console.log("Frames resolved to",a),a}},{key:"add",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:12,o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=arguments.length>5&&void 0!==arguments[5]&&arguments[5],s=this.getFrames(t,r);if(console.log("Director frames",s),s=this.resolveDirectorFrames(s),a){var u=s;s=n(s).reverse().concat(u)}return console.log("Frames",s),this.sprite.animations.add(e,s,i,o)}},{key:"static",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=this.getFrames(e,t);"Dummy"!==r[0]&&(r=this.resolveDirectorFrames(r),this.sprite.loadTexture(this.sprite.key,r[0]))}},{key:"playAudio",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(this.sprite.Sounds[e])return this.game.mulle.playAudio(this.sprite.Sounds[e],t);console.error("No sound with key ".concat(e))}}],t&&u(e.prototype,t),r&&u(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}()},826:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var n={onCreate:function(){var e=this;this.animationHelper.add("idle","normal",1,12,!0),this.animationHelper.add("parting","Parting",1,5).onComplete.add(function(){e.animations.play("parted")}),this.animationHelper.add("parted","Outer",1,12,!0),this.animationHelper.add("gathering","Gathering").onComplete.add(function(){e.animations.play("idle")}),this.animations.play("idle")},onEnterInner:function(e){var t=this;if(this.game.mulle.user.Car.getProperty("horntype",0)>=1){if(this.animations.play("parting"),!this.playedSound)this.game.mulle.playAudio(["05e050v0","05e049v0","05e044v0","05e042v0","05d013v0"][this.game.mulle.user.Car.getProperty("horntype",0)-1]),this.playedSound=!0,this.game.mulle.playAudio(this.def.Sounds[1]).onStop.addOnce(function(){t.playedSound=null})}else{if(!this.playedSound)this.playedSound=!0,this.game.mulle.playAudio(this.def.Sounds[0]).onStop.addOnce(function(){t.playedSound=null});e.speed=0,e.stepback(2),this.enteredInner=!1}},onExitInner:function(){this.animations.play("gathering")},onExitOuter:function(){this.game.mulle.stopAudio(this.def.Sounds[1])}};const i=n},913:(e,t,r)=>{"use strict";r.d(t,{A:()=>f});var n=r(57);function i(e){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},i(e)}function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,s=[],u=!0,l=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||s(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=s(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){u=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw o}}}}function s(e,t){if(e){if("string"==typeof e)return u(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(e,t):void 0}}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,c(n.key),n)}}function c(e){var t=function(e,t){if("object"!=i(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==i(t)?t:t+""}const f=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return t=e,i=[{key:"offset",value:function(e,t){var r,n=[],i=a(e);try{for(i.s();!(r=i.n()).done;){var o=r.value;n.push(o+t)}}catch(e){i.e(e)}finally{i.f()}return n}},{key:"resolveDirectorFrames",value:function(e,t,r){if(!t)return console.error("Movie not set"),[];var i,s,u,l=[],c=[],f=a(r);try{for(f.s();!(u=f.n()).done;){var h=u.value;if("Dummy"!==h){var m=o(n.A.getDirectorImage(e,t,h),2);i=m[0],s=m[1],l.push(s.name),c.push(s)}}}catch(e){f.e(e)}finally{f.f()}return[i,l,c]}},{key:"createAnimation",value:function(t,r,n,i){var o=e.offset(i,n-1);return this.resolveDirectorFrames(t,r,o)}},{key:"addAnimation",value:function(t,r,i,o){var s,u=arguments.length>4&&void 0!==arguments[4]&&arguments[4],l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:12,c=[],f=a(e.offset(i,o-1));try{for(f.s();!(s=f.n()).done;){var h=s.value,m=n.A.getSpriteSheetImage(t.key,h);null===m&&console.error("Unable to find image",movie,member),c.push(m.name)}}catch(e){f.e(e)}finally{f.f()}return t.animations.add(r,c,l,u)}}],(r=null)&&l(t.prototype,r),i&&l(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r,i}()},949:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var n={onEnterInner:function(){if(console.log("enter hill, custom object",this),"#SmallHill"===this.opt.HillType)this.game.mulle.user.Car.criteria.SmallHill||this.game.mulle.playAudio(this.def.Sounds[0]);else if(this.game.mulle.user.Car.criteria.BigHill){var e=this.def.SetWhenDone.Medals[0];this.game.mulle.user.Car.hasMedal(e)||this.game.mulle.user.Car.addMedal(e)}else this.game.mulle.playAudio(this.def.Sounds[1])}};const i=n},970:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var n={onCreate:function(){this.setDirectorMember(this.def.FrameList.normal[0]),this.SpriteInfo.Over&&this.bringToTop()},onEnterInner:function(){}};const i=n},976:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});var n=r(632),i={};function o(e){return Math.round(100*e)/100}function a(e,t){var r=t.x-e.x,n=e.y-t.y;0===n&&(n=.1);var i=Math.atan(r/n);return r>0?n>0||(i+=Math.PI):i+=n>0?2*Math.PI:Math.PI,i/=Math.PI,0===(i=Math.round(16*i/2))&&(i=16),i}i.ObjectId=7,i.onCreate=function(){var e=this;this.isRacing=!1,this.nrOfTimesPassed=0,this.mustEnterFrom=this.opt.EnterDir,this.board=new n.A(this.game,this.opt.Board.x,this.opt.Board.y),this.board.setDirectorMember("CDDATA.CXT","31b045v0"),this.game.add.existing(this.board),this.boardText1=new Phaser.Text(this.game,15,10,"",{font:"16px arial",fill:"#00ff00"}),this.board.addChild(this.boardText1),this.boardText2=new Phaser.Text(this.game,15,40,"",{font:"16px arial",fill:"#00ff00"}),this.board.addChild(this.boardText2),this.boardLoop=this.game.time.events.loop(Phaser.Timer.SECOND/15,function(){e.isRacing&&(e.boardText1.text=o((Date.now()-e.raceStart)/1e3))}),this.networkListener=function(t){var r=JSON.parse(t.data);r.race&&(console.log("race msg",r.race),r.race[0]&&(e.boardText1.text=o(r.race[0].time)+" "+r.race[0].name),r.race[1]&&(e.boardText2.text=o(r.race[1].time)+" "+r.race[1].name))},this.game.mulle.net.socket.addEventListener("message",this.networkListener)},i.onEnterInner=function(e){var t=a(e.position,this.position),r=Math.abs(this.mustEnterFrom-t);if(r>8&&(r=16-r),r<=3)if(this.enteredFrom=1,this.isRacing){if(1===this.nrOfTimesPassed){console.log("finish race"),this.game.mulle.playAudio(this.def.Sounds[1]),this.isRacing=!1;var n=(Date.now()-this.raceStart)/1e3;this.boardText1.text=o(n)+" "+this.game.mulle.user.UserId,this.game.mulle.net.send({race:n}),alert(n)}}else console.log("start race"),this.game.mulle.playAudio(this.def.Sounds[0]),this.raceStart=Date.now(),this.isRacing=!0,this.nrOfTimesPassed=0;else this.enteredFrom=-1},i.onExitInner=function(e){if(this.isRacing){console.log("exit inner");var t=a(e.position,this.position),r=Math.abs(this.mustEnterFrom-t);r>8&&(r=16-r),r<=3?-1===this.enteredFrom&&(this.nrOfTimesPassed--,console.log("passed minus",this.nrOfTimesPassed)):1===this.enteredFrom&&(this.nrOfTimesPassed++,console.log("passed plus",this.nrOfTimesPassed))}},i.onDestroy=function(){this.board.destroy(),this.game.time.events.remove(this.boardLoop),this.game.mulle.net.socket.removeEventListener("message",this.networkListener)};const s=i}},t={};function r(n){var i=t[n];if(void 0!==i)return i.exports;var o=t[n]={exports:{}};return e[n](o,o.exports,r),o.exports}r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,n(i.key),i)}}function n(t){var r=function(t,r){if("object"!=e(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,r||"default");if("object"!=e(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==e(r)?r:r+""}function i(t,r,n){return r=a(r),function(t,r){if(r&&("object"==e(r)||"function"==typeof r))return r;if(void 0!==r)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t)}(t,o()?Reflect.construct(r,n||[],a(t).constructor):r.apply(t,n))}function o(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(o=function(){return!!e})()}function a(e){return a=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},a(e)}function s(e,t){return s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},s(e,t)}const u=function(){function e(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),i(this,e,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t)}(e,Phaser.State),r=e,(n=[{key:"preload",value:function(){this.game.load.image("loading","loading.png")}},{key:"create",value:function(){var e=this;this.game.scale.fullScreenScaleMode=Phaser.ScaleManager.SHOW_ALL,this.game.scale.scaleMode=Phaser.ScaleManager.SHOW_ALL,this.game.scale.refresh(),this.game.mulle.networkEnabled?(this.game.mulle.net.connect(),this.game.mulle.net.socket.addEventListener("open",function(t){"boot"===e.game.state.current&&e.game.state.start("load")}),this.game.mulle.net.socket.addEventListener("close",function(t){"boot"===e.game.state.current?(alert("Server ej tillgänglig, multiplayer avstängt."),e.game.state.start("load")):alert("Anslutningen till servern avbröts.")}),this.game.state.onStateChange.add(function(t){e.game.mulle.net.send({scene:t})})):this.game.state.start("load")}}])&&t(r.prototype,n),o&&t(r,o),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,o}();function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,f(n.key),n)}}function f(e){var t=function(e,t){if("object"!=l(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=l(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==l(t)?t:t+""}const h=function(){return e=function e(t,r,n){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.game=t,this.partId=parseInt(r),this.data=n,this.junkView=this.data.junkView,this.UseView=this.data.UseView,this.UseView2=this.data.UseView2,this.description=this.data.description,this.Requires=this.data.Requires,this.Covers=this.data.Covers,0!==this.data.master?this.master=this.data.master:this.master=!1,this.MorphsTo=!!this.data.MorphsTo&&this.data.MorphsTo,this.new=[],this.data.new)for(var i=0;i<this.data.new.length;i++){var o=this.data.new[i];this.new.push({id:o[0],fg:o[1][0],bg:o[1][1],offset:new Phaser.Point(o[2][0],o[2][1])})}if(this.offset=new Phaser.Point(this.data.offset[0],this.data.offset[1]),this.properties={},this.data.Properties)for(var a in this.data.Properties)this.properties[a.toLowerCase()]=this.data.Properties[a]},t=[{key:"getProperty",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(e=e.toLowerCase(),this.properties[e])return this.properties[e];if(this.MorphsTo)for(var r in this.MorphsTo){var n=this.game.mulle.getPart(this.MorphsTo[r]);if(n){if(n.getProperty(e,t))return n.getProperty(e,t)}else console.error("invalid part",this.MorphsTo[r])}return t}}],t&&c(e.prototype,t),r&&c(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}();function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,p(n.key),n)}}function p(e){var t=function(e,t){if("object"!=m(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=m(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==m(t)?t:t+""}function y(e,t,r){return t=v(t),function(e,t){if(t&&("object"==m(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,g()?Reflect.construct(t,r||[],v(e).constructor):t.apply(e,r))}function g(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(g=function(){return!!e})()}function v(e){return v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},v(e)}function b(e,t){return b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},b(e,t)}const w=function(){function e(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),y(this,e,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&b(e,t)}(e,Phaser.State),t=e,(r=[{key:"preload",value:function(){this.load.json("MapsDB","data/maps.hash.json"),this.load.json("MissionsDB","data/missions.hash.json"),this.load.json("ObjectsDB","data/objects.hash.json"),this.load.json("PartsDB","data/parts.hash.json"),this.load.json("WorldsDB","data/worlds.hash.json"),this.game.load.pack("cutscenes","assets/cutscenes.json",null,this),this.game.load.pack("characters","assets/characters.json",null,this),this.game.load.pack("carparts","assets/carparts.json",null,this),this.game.load.pack("shared","assets/shared.json",null,this),this.game.load.pack("ui","assets/ui.json",null,this),this.game.load.onLoadComplete.add(this.loadComplete,this),this.progress=game.add.graphics(0,0),this.loadImage=this.game.add.sprite(202.5,145.5,"loading")}},{key:"loadRender",value:function(){if(this.progress){var e=this.game.load.progressFloat/100;this.progress.clear(),this.progress.beginFill("0x333333",1),this.progress.drawRect(170,400,300,32),this.progress.endFill(),this.progress.beginFill("0x65C265",1),this.progress.drawRect(170,400,300*e,32),this.progress.endFill(),this.progress.beginFill("0x65C265",1)}}},{key:"create",value:function(){var e=this.game.cache.getJSON("PartsDB");for(var t in e)this.game.mulle.PartsDB[t]=new h(this.game,t,e[t]);this.game.mulle.MapsDB=this.game.cache.getJSON("MapsDB"),this.game.mulle.WorldsDB=this.game.cache.getJSON("WorldsDB"),this.game.mulle.ObjectsDB=this.game.cache.getJSON("ObjectsDB"),this.game.mulle.addAudio("shared"),this.game.mulle.addAudio("carparts"),this.game.mulle.loadData()}},{key:"loadComplete",value:function(){this.ready=!0}},{key:"fileComplete",value:function(e,t,r,n,i){}},{key:"update",value:function(){this.ready&&this.game.state.start(window.location.hash?window.location.hash.substr(1):"menu")}},{key:"shutdown",value:function(){this.loadImage&&this.loadImage.destroy(),this.progress&&this.progress.destroy()}}])&&d(t.prototype,r),n&&d(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r,n}();function P(e){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},P(e)}function k(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,S(n.key),n)}}function S(e){var t=function(e,t){if("object"!=P(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=P(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==P(t)?t:t+""}const O=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.game=t},(t=[{key:"connect",value:function(){var e=this;if(this.connected)return console.error("Already connected"),!1;var t=this.game.mulle.networkServer;console.log("[network]","connect",t),this.socket=new WebSocket(t),this.socket.addEventListener("open",function(e){console.log("[network]","connected")}),this.socket.addEventListener("close",function(t){console.warn("[network]","disconnected",t),e.socket=null}),this.socket.addEventListener("message",function(e){(e=JSON.parse(event.data)).error&&alert(e.error),e.message&&alert(e.message)})}},{key:"disconnect",value:function(){this.socket.close()}},{key:"send",value:function(e){return!!this.socket&&this.socket.readyState===WebSocket.OPEN&&void this.socket.send(JSON.stringify(e))}},{key:"connected",get:function(){return this.socket&&this.socket.readyState===WebSocket.OPEN}}])&&k(e.prototype,t),r&&k(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}();function j(e){return j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},j(e)}function D(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,A(n.key),n)}}function A(e){var t=function(e,t){if("object"!=j(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=j(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==j(t)?t:t+""}const C=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.game=t,this.cursorName=null,this.activator=null,this.default="Standard",this._current=null,this._previous=null,this._history=[]},(t=[{key:"current",get:function(){return this._current},set:function(e){e?this._history.push(e):this._history.splice(-1,1),this.refresh(),this._current=e}},{key:"reset",value:function(){this._history=[],this._current=null,this.refresh()}},{key:"add",value:function(e){-1===this._history.indexOf(e)&&this._history.push(e),this.refresh()}},{key:"remove",value:function(e){var t=-1!==this._history.indexOf(e);t&&this._history.splice(t,1),this.refresh()}},{key:"refresh",value:function(){this._history.length>0?this.game.canvas.className="C_"+this._history[this._history.length-1]:this.game.canvas.className="C_"+this.default}},{key:"setCursor",value:function(e,t){t?(this.activator=e,this.cursorName=t,this.game.canvas.className="cursor-"+this.cursorName):(this.activator=null,this.cursorName=null,this.game.canvas.className="")}},{key:"addHook",value:function(e,t){e.events.onInputOver.add(this.cursorOver,this,null,t),e.events.onInputOut.add(this.cursorOut,this,null,t)}},{key:"cursorOver",value:function(e,t,r){if(r){var n=r(e,"over",t);n?this.setCursor(e,n):this.setCursor(e,null)}}},{key:"cursorOut",value:function(e,t,r){if(r){var n=r(e,"out",t);n?this.setCursor(e,n):this.setCursor(e,null)}}}])&&D(e.prototype,t),r&&D(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}();var x=r(632);function R(e){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},R(e)}function _(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,T(n.key),n)}}function T(e){var t=function(e,t){if("object"!=R(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=R(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==R(t)?t:t+""}function E(e,t,r){return t=I(t),function(e,t){if(t&&("object"==R(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,M()?Reflect.construct(t,r||[],I(e).constructor):t.apply(e,r))}function M(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(M=function(){return!!e})()}function I(e){return I=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},I(e)}function B(e,t){return B=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},B(e,t)}const N=function(){function e(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),E(this,e,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&B(e,t)}(e,Phaser.State),t=e,(r=[{key:"preload",value:function(){this.game.mulle.activeCutscene&&(console.log("cutscene",this.key,this.game.mulle.activeCutscene),this.cutscene=new x.A(this.game,320,240),this.cutscene.setDirectorMember("00.CXT",this.game.mulle.activeCutscene),this.game.add.existing(this.cutscene),this.progress=game.add.graphics(0,0))}},{key:"loadRender",value:function(){if(this.progress){var e=this.game.load.progressFloat/100;this.progress.clear(),this.progress.beginFill("0x333333",1),this.progress.drawRect(170,400,300,32),this.progress.endFill(),this.progress.beginFill("0x65C265",1),this.progress.drawRect(170,400,300*e,32),this.progress.endFill(),this.progress.beginFill("0x65C265",1)}}},{key:"create",value:function(){this.cutscene&&(console.log("destroy cutscene"),this.cutscene.destroy(),this.game.mulle.activeCutscene=null,this.progress.destroy()),this.game.mulle.user||(this.game.mulle.user=this.game.mulle.UsersDB[Object.keys(this.game.mulle.UsersDB)[0]],window.location.hash=this.key,this.game.mulle.net.send({name:this.game.mulle.user.UserId}),this.game.mulle.net.send({parts:this.game.mulle.user.Car.Parts})),this.game.mulle.cursor.reset()}}])&&_(t.prototype,r),n&&_(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r,n}();function L(e){return L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},L(e)}function F(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,X(n.key),n)}}function X(e){var t=function(e,t){if("object"!=L(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=L(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==L(t)?t:t+""}function H(e,t,r){return t=W(t),function(e,t){if(t&&("object"==L(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,U()?Reflect.construct(t,r||[],W(e).constructor):t.apply(e,r))}function U(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(U=function(){return!!e})()}function J(){return J="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=W(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},J.apply(null,arguments)}function W(e){return W=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},W(e)}function V(e,t){return V=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},V(e,t)}const G=function(e){function t(e,r,n,i){var o,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=H(this,t,[e,r,n])).actorName=i;var s="00.CXT";if("mulleDefault"===o.actorName)o.setDirectorMember(s,271),o.addAnimation("idle",[[s,271]],10,!0,!1),o.addAnimation("scratchChin",[[s,271],[s,272],[s,273],[s,274],[s,275],[s,276]],10,!1,!1),o.addAnimation("scratchHead",[[s,277],[s,278],[s,279],[s,280],[s,281],[s,282]],10,!1,!1),o.addAnimation("lookPlayer",[[s,287],[s,288]],10,!0,!1),o.addAnimation("talkPlayer",[[s,289],[s,290],[s,291],[s,292],[s,293],[s,294],[s,295]],10,!0,!1),o.addAnimation("talkRegular",[[s,296],[s,297],[s,298],[s,299],[s,300],[s,301],[s,302]],10,!0,!1),o.addAnimation("lookLeft",[[s,283]],10,!0,!1),o.addAnimation("turnBack",[[s,285]],10,!0,!1);else if("mulleSit"===o.actorName)o.setDirectorMember(s,245),o.addAnimation("idle",[[s,245]],0,!0,!1),o.addAnimation("wave",[[s,246],[s,247],[s,248],[s,249],[s,250],[s,251],[s,252],[s,251],[s,250],[s,249],[s,248],[s,247]],10,!0,!1),o.addAnimation("lookPlayer",[[s,253]],0,!0,!1),o.addAnimation("talkPlayer",[[s,253],[s,254],[s,255],[s,256],[s,257],[s,258],[s,259],[s,260]],10,!0,!1),o.addAnimation("smilePlayer",[[s,261],[s,262],[s,263]],5,!0,!1);else if("mulleMenuHead"===o.actorName){var u="10.DXR";o.setDirectorMember(u,126),o.addAnimation("idle",[[u,126]],0,!0,!1),o.addAnimation("point",[[u,136],[u,137],[u,137],[u,137],[u,137],[u,137],[u,137],[u,137],[u,137],[u,136],[u,126]],10,!1,!1)}else if("mulleMenuMouth"===o.actorName)s="10.DXR",o.setDirectorMember(s,115),o.addAnimation("idle",[[s,115]],5,!0,!1),o.addAnimation("blink",[[s,123]],5,!0,!1),o.addAnimation("lookPlayer",[[s,115]],5,!0,!1),o.addAnimation("talkPlayer",[[s,115],[s,116],[s,117],[s,118],[s,119],[s,120],[s,121],[s,122]],10,!0,!1);else if("figge"===o.actorName)s="92.DXR",o.setDirectorMember(s,17),o.addAnimation("idle",[[s,17]]),o.addAnimation("talkPlayer",[[s,17],[s,18],[s,19],[s,20],[s,21],[s,22],[s,23],[s,24],[s,25]],10,!0,!1);else if("salkaRight"===o.actorName)s="85.DXR",o.setDirectorMember(s,26),o.addAnimation("idle",[[s,26],[s,27],[s,28],[s,29],[s,30],[s,29],[s,28],[s,27]],15,!0,!1);else if("salkaLeft"===o.actorName)s="92.DXR",o.setDirectorMember(s,40),o.addAnimation("idle",[[s,40],[s,41],[s,42],[s,43],[s,44],[s,43],[s,42],[s,41]],15,!0,!1);else if("buffa"===o.actorName)o.setDirectorMember(s,214),o.addAnimation("idle",[[s,214]],10,!0,!1),o.addAnimation("scratch1",[[s,214],[s,215]],10,!0,!1),o.addAnimation("sleep_intro",[[s,214],[s,216],[s,217],[s,218]],10,!1,!1),o.addAnimation("sleep_loop",[[s,219],[s,220]],1,!1,!1),o.addAnimation("bark",[[s,222],[s,223]],10,!0,!1);else if("judge"===o.actorName){s="94.DXR",o.setDirectorMember(s,31),o.addAnimation("idle",[[s,31]],10,!0),o.addAnimation("talk",[[s,43],[s,44],[s,45],[s,46],[s,47]],10,!0),o.addAnimation("raiseScore",[[s,32],[s,33],[s,34],[s,35]],5,!1).onComplete.add(function(){console.log("raise hook"),o.silenceAnimation="idleScore",o.talkAnimation="talkScore",o.animations.play("idleScore"),o.displayScore()}),o.addAnimation("idleScore",[[s,36]],10,!1),o.addAnimation("talkScore",[[s,37],[s,38],[s,39],[s,41],[s,42]],10,!0),o.addAnimation("lowerScore",[[s,35],[s,34],[s,33],[s,32]],5,!1).onComplete.add(function(){console.log("lower hook"),o.silenceAnimation="idle",o.talkAnimation="talk",o.animations.play("idle")})}else if("figgeDoor"===o.actorName){s="03.DXR",o.setDirectorMember(s,81),o.addAnimation("enter",[[s,81],[s,82],[s,83],[s,84],[s,85]],10,!1).onComplete.add(function(){o.animations.play("entered")}),o.addAnimation("entered",[[s,86]],10,!0),o.addAnimation("exit",[[s,85],[s,84],[s,83],[s,82],[s,81]],10,!1),o.addAnimation("talk",[[s,86],[s,87],[s,88],[s,89],[s,90],[s,91],[s,92],[s,93]],10,!0),o.talkAnimation="talk",o.silenceAnimation="entered"}else if("stureSad"===o.actorName)s="88.DXR",o.setDirectorMember(s,41),o.addAnimation("idle",[[s,41]],10,!1),o.addAnimation("talk",[[s,42],[s,43],[s,44],[s,44],[s,45]],10,!0);else if("stureHappy"===o.actorName)s="88.DXR",o.setDirectorMember(s,33),o.addAnimation("idle",[[s,33]],10,!1),o.addAnimation("talk",[[s,34],[s,35],[s,36],[s,36],[s,37]],8,!0);else if("garson"===o.actorName)s="87.DXR",o.setDirectorMember(s,15),o.addAnimation("idle",[[s,15]],10,!1),o.addAnimation("talk",[[s,16],[s,17],[s,18]],8,!0);else if("miaBody"===o.actorName)s="86.DXR",o.setDirectorMember(s,55),o.addAnimation("idle",[[s,55]],10,!1),o.addAnimation("catchIntro",[[s,55],[s,56],[s,57],[s,58]],10,!1),o.addAnimation("catchEnd",[[s,47],[s,48],[s,49],[s,50]],10,!1);else if("miaHead"===o.actorName)s="86.DXR",o.setDirectorMember(s,62),o.addAnimation("idle",[[s,62]],10,!1),o.addAnimation("talk",[[s,63],[s,64],[s,65],[s,66],[s,67]],10,!0),o.addAnimation("idleCat",[[s,69]],10,!1),o.addAnimation("talkCat",[[s,69],[s,70],[s,71],[s,72],[s,73],[s,74]],10,!0);else if("cat"===o.actorName){s="86.DXR",o.setDirectorMember(s,30),o.addAnimation("idle",[[s,30]],10,!1);for(var l=[],c=0;c<12;c++)l.push([s,31+c]);o.addAnimation("jump1",l,10,!1);for(l=[],c=0;c<4;c++)l.push([s,42+c]);o.addAnimation("jump2",l,10,!1)}else a||console.error("invalid actor",o.actorName);return o.onCue=new Phaser.Signal,o.isTalking=!1,o.sentenceNum=0,o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&V(e,t)}(t,e),r=t,n=[{key:"talk",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(this.isTalking=!0,this.talkAudio&&(console.warn("talk while already talking"),this.resetTalk()),this.actorName,n?this.onCue.add(n):this.onCue.add(function(e){"silence"===e[1].toLowerCase()&&t.animations.play(t.silenceAnimation?t.silenceAnimation:"lookPlayer",0),"talk"===e[1].toLowerCase()&&t.animations.play(t.talkAnimation?t.talkAnimation:"talkPlayer")}),this.talkAudio=this.game.mulle.playAudio(e),!this.talkAudio)return console.error("invalid talk audio",this,e),this.talkAudio=null,!1;var i=this.game.mulle.subtitle.getData(e);if(i){var o=1,a=i.lines,s=a.length;if(this.talkAudio.extraData&&this.talkAudio.extraData.cue){var u=this.talkAudio.extraData.cue.find(function(e){return"talk"===e[1].toLowerCase()});o=u?u.length:1}if(1===o)if(s>1)for(var l in this.actorName,a)if(0===l)this.game.mulle.subtitle.showLine(a[l],i.actor);else{var c=900*Math.log(a[l].length);this.game.time.events.add(c,function(){t.game.mulle.subtitle.showLine(a[l],i.actor)})}else this.actorName,this.game.mulle.subtitle.showLine(a[0],i.actor);else this.actorName,this.talkAudio.extraData.cue,this.onCue.add(function(e){"talk"===e[1].toLowerCase()&&(t.game.mulle.subtitle.showLine(a[t.sentenceNum],i.actor),t.sentenceNum++)})}else console.warn("no subtitle",e);this.cuesCompleted={},this.talkAudio.isDecoded?this.onAudioPlay():this.talkAudio.onPlay.add(this.onAudioPlay,this),this.onEnd=r,this.onEnd&&this.talkAudio.onStop.add(this.onEnd),this.talkAudio.onStop.add(this.onAudioStop,this),this.talkAudio.onResume.add(function(){console.log("resume")},this)}},{key:"onAudioPlay",value:function(){var e=this;this.animations.play(this.talkAnimation?this.talkAnimation:"talkPlayer"),this.talkLoop=this.game.time.events.loop(Phaser.Timer.SECOND/15,function(){e.talkAudio.extraData&&e.talkAudio.extraData.cue?e.talkAudio.extraData.cue.forEach(function(t,r){!e.cuesCompleted[r]&&e.talkAudio.currentTime>=t[0]&&(e.onCue.dispatch(t),e.cuesCompleted[r]=!0)}):console.warn("no cue points",e.talkAudio)},this)}},{key:"onAudioStop",value:function(){var e=this.animations.getAnimation("idle");e?e.play():this.silenceAnimation?(this.silenceAnimation,this.animations.play(this.silenceAnimation)):console.warn("No silence animation for actor",this.actorName),this.resetTalk(),this.isTalking=!1}},{key:"resetTalk",value:function(){this.sentenceNum=0,this.talkAudio&&(this.talkAudio.onPlay.remove(this.onAudioPlay,this),this.talkAudio.onStop.remove(this.onAudioStop,this),this.onEnd&&this.talkAudio.onStop.remove(this.onEnd),this.talkAudio.stop(),this.talkAudio=null),this.talkLoop&&(this.game.time.events.remove(this.talkLoop),this.talkLoop=null),this.onCue.removeAll()}},{key:"destroy",value:function(){var e,r,n,i,o;this.resetTalk(),(e=t,r="destroy",n=this,o=J(W(1&(i=3)?e.prototype:e),r,n),2&i&&"function"==typeof o?function(e){return o.apply(n,e)}:o)([])}}],n&&F(r.prototype,n),i&&F(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(x.A);function q(e){return q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},q(e)}function K(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Y(n.key),n)}}function Y(e){var t=function(e,t){if("object"!=q(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=q(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==q(t)?t:t+""}const $=function(){return e=function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.game=t,this.properties={},this.quickProperties={},this.criteria={},r?(this.Parts=r.Parts,this.Name=r.Name,this.Medals=r.Medals,this.CacheList=r.CacheList):(this.Parts=[1,82,133,152],this.Name="",this.Medals=[],this.CacheList=[])},t=[{key:"getParts",value:function(){var e=this,t=[];return this.Parts.forEach(function(r){t.push(e.game.mulle.PartsDB[r])}),t}},{key:"hasPart",value:function(e){return-1!==this.Parts.indexOf(parseInt(e))}},{key:"hasMedal",value:function(e){return this.Medals.includes(e)}},{key:"addMedal",value:function(e){this.Medals.push(e),console.log("Added medal ".concat(e)),console.log("Medals",this.Medals)}},{key:"hasCache",value:function(e){return-1!==this.CacheList.indexOf(e)}},{key:"addCache",value:function(e){return!this.hasCache(e)&&(this.CacheList.push(e),!0)}},{key:"removeCache",value:function(e){var t=this.CacheList.indexOf(e);return-1!==t&&(this.CacheList.splice(t,1),!0)}},{key:"resetCache",value:function(){this.CacheList=[]}},{key:"Parts",get:function(){return this._Parts},set:function(e){this._Parts=e,this.updateStats()}},{key:"getProperty",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return void 0!==this.properties[e.toLowerCase()]?this.properties[e.toLowerCase()]:t}},{key:"getQuickProperty",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return void 0!==this.quickProperties[e.toLowerCase()]?this.quickProperties[e.toLowerCase()]:t}},{key:"updateStats",value:function(){var e=this,t=this.getParts();this.properties={},this.quickProperties={},["weight","break","durability","grip","steering","acceleration","speed","strength","fuelconsumption","fuelvolume","electricconsumption","electricvolume","comfort","funnyfactor","horn","exhaustpipe","lamps","loadcapacity","enginetype","horntype","pedals"].forEach(function(t){e.properties[t]=0,e.quickProperties[t]=0}),t.forEach(function(t){e.properties.weight+=t.getProperty("weight",0),e.properties.break+=t.getProperty("break",0),e.properties.durability=Math.max(t.getProperty("durability",0),e.properties.durability),e.properties.grip+=t.getProperty("grip",0),e.properties.steering=Math.max(t.getProperty("steering",0),e.properties.steering),e.properties.acceleration=Math.max(t.getProperty("acceleration",0),e.properties.acceleration),e.properties.speed=Math.max(t.getProperty("speed",0),e.properties.speed),e.properties.strength+=t.getProperty("strength",0),e.properties.fuelconsumption+=t.getProperty("fuelconsumption",0),e.properties.fuelvolume+=t.getProperty("fuelvolume",0),e.properties.electricconsumption+=t.getProperty("electricconsumption",0),e.properties.electricvolume+=t.getProperty("electricvolume",0),e.properties.comfort+=t.getProperty("comfort",0),e.properties.funnyfactor+=t.getProperty("funnyfactor",0),t.getProperty("horn",0)&&(e.properties.horn=1),t.getProperty("exhaustpipe",0)&&(e.properties.exhaustpipe=1),t.getProperty("lamps",0)&&(e.properties.lamps=1),t.getProperty("pedals",0)&&(e.properties.pedals=1),e.properties.loadcapacity+=t.getProperty("loadcapacity",0),e.properties.enginetype=Math.max(t.getProperty("enginetype",0),e.properties.enginetype),e.properties.horntype=Math.max(t.getProperty("horntype",0),e.properties.horntype)}),5===this.properties.speed?this.quickProperties.speed=27*this.properties.speed/25:this.quickProperties.speed=20*this.properties.speed/25,this.quickProperties.break=3*this.properties.break/100,0===this.quickProperties.acceleration&&(this.quickProperties.acceleration=1),this.quickProperties.acceleration=2*this.properties.acceleration/100,this.quickProperties.steering=this.properties.steering+21,this.quickProperties.fuelvolume=12*this.properties.fuelvolume,this.quickProperties.fuelconsumption=this.properties.fuelconsumption,this.criteria={MudGrip:8,HolesDurability:3,BigHill:3,SmallHill:2},this.criteria.MudGrip=this.getProperty("grip",0)>this.criteria.MudGrip,this.criteria.HolesDurability=this.getProperty("durability",0)>this.criteria.HolesDurability,this.criteria.BigHill=this.getProperty("strength",0)>this.criteria.BigHill,this.criteria.SmallHill=this.getProperty("strength",0)>this.criteria.SmallHill,this.properties,this.quickProperties}},{key:"isRoadLegal",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.getProperty("enginetype"))return e&&this.game.mulle.actors.mulle.talk("03d013v0"),!1;var t=0;return this.getParts().forEach(function(e){e.getProperty("grip")&&t++,9===e.getProperty("grip")&&(t=2)}),t<2?(e&&this.game.mulle.actors.mulle.talk("03d012v0"),!1):0===this.getProperty("break")?(e&&this.game.mulle.actors.mulle.talk("03d018v0"),!1):0===this.getProperty("fuelconsumption")?(e&&this.game.mulle.actors.mulle.talk("03d013v0"),!1):0===this.getProperty("electricvolume")?(e&&this.game.mulle.actors.mulle.talk("03d014v0"),!1):0===this.getProperty("fuelvolume")?(e&&this.game.mulle.actors.mulle.talk("03d015v0"),!1):0===this.getProperty("acceleration")?(e&&this.game.mulle.actors.mulle.talk("03d016v0"),!1):0!==this.getProperty("steering")||(e&&this.game.mulle.actors.mulle.talk("03d017v0"),!1)}},{key:"toJSON",value:function(){return{Parts:this.Parts,Name:this.Name,Medals:this.Medals,CacheList:this.CacheList}}}],t&&K(e.prototype,t),r&&K(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}();function Q(e){return Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Q(e)}function z(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Z(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Z(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function Z(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function ee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,te(n.key),n)}}function te(e){var t=function(e,t){if("object"!=Q(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Q(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Q(t)?t:t+""}const re=function(){return e=function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.game=t,r?(r.UserId,this.fromJSON(r)):this.setDefaults(),this.calculateParts()},t=[{key:"setDefaults",value:function(){this.UserId="",this.Car=new $(this.game),this.Junk={Pile1:{66:new Phaser.Point(296,234),29:new Phaser.Point(412,311),143:new Phaser.Point(416,186),178:new Phaser.Point(570,255)},Pile2:{215:new Phaser.Point(545,222),47:new Phaser.Point(386,304),12:new Phaser.Point(239,269),140:new Phaser.Point(352,187)},Pile3:{153:new Phaser.Point(512,153),131:new Phaser.Point(464,298),307:new Phaser.Point(246,285),112:new Phaser.Point(561,293),30:new Phaser.Point(339,189)},Pile4:{190:new Phaser.Point(182,143),23:new Phaser.Point(346,203),126:new Phaser.Point(178,301),211:new Phaser.Point(75,193)},Pile5:{6:new Phaser.Point(192,377),90:new Phaser.Point(102,290),203:new Phaser.Point(33,122),158:new Phaser.Point(186,164),119:new Phaser.Point(375,268)},Pile6:{2:new Phaser.Point(160,351),214:new Phaser.Point(130,172),210:new Phaser.Point(281,300),121:new Phaser.Point(85,275)},shopFloor:{},yard:{}},this.NrOfBuiltCars=0,this.Saves=[],this.CompletedMissions=[],this.OwnStuff=[],this.myLastPile=1,this.gifts=[],this.toYardThroughDoor=!0,this.givenMissions=[],this.figgeIsComing=!1,this.missionIsComing=!1,this.savedCars=[],this.language=this.game.mulle.defaultLanguage}},{key:"addStuff",value:function(e){return!this.hasStuff(e)&&(this.OwnStuff.push(e),this.save(),!0)}},{key:"removeStuff",value:function(e){if(!this.hasStuff(e))return!1;var t=this.OwnStuff.indexOf(e);return this.OwnStuff.splice(t,1),this.save(),!0}},{key:"hasStuff",value:function(e){return-1!==this.OwnStuff.indexOf(e)}},{key:"hasPart",value:function(e){for(var t in this.Junk)if(-1!==Object.keys(this.Junk[t]).indexOf(e)||-1!==Object.keys(this.Junk[t]).indexOf(e.toString()))return!0;if(-1!==this.Car.Parts.indexOf(e)||-1!==this.Car.Parts.indexOf(e.toString()))return!0;var r,n=z(this.Car.Parts);try{for(n.s();!(r=n.n()).done;){var i=r.value,o=this.game.mulle.PartsDB[i];if(o.master&&e===o.master)return!0}}catch(e){n.e(e)}finally{n.f()}return!1}},{key:"addPart",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return!!this.Junk[e]&&(r||(r=new Phaser.Point(this.game.rnd.integerInRange(0,640),this.game.rnd.integerInRange(0,480))),this.Junk[e][t]=r,console.log("part added",e,t,r),n||this.save(),!0)}},{key:"calculateParts",value:function(){this.availableParts={};var e={Postal:[],JunkMan:[13,20,17,89,290,120,18,19,173,21,297,22,24,25,185,26,27,28,32,35,91,132,129,134,137,146,149,154,168,216,174,175,177,189,191,192,193,233,199,208,209,212,221,227,229,235,251,264,278,294,295,14],Destinations:[162,99,172,54,306,287,113,283,9],Random:[33,38,41,42,43,176,48,53,55,64,65,74,75,76,92,93,100,101,104,107,116,130,96,155,161,181,186,195,196,200,213,219,220,222,228,230,234,236,239,242,245,248,254,257,260,261,265,271,272,273,286,288,296]};for(var t in e){this.availableParts[t]=[];var r,n=z(e[t]);try{for(n.s();!(r=n.n()).done;){var i=r.value;this.hasPart(i)||this.availableParts[t].push(i)}}catch(e){n.e(e)}finally{n.f()}}console.log("availableParts",this.availableParts)}},{key:"getRandomPart",value:function(){return this.calculateParts(),this.game.rnd.pick(this.availableParts.Random)}},{key:"save",value:function(){console.log("save data",this.UserId),window.localStorage.setItem("mulle_SaveData",JSON.stringify(this.game.mulle.UsersDB))}},{key:"fromJSON",value:function(e){this.UserId=e.UserId,this.Car=new $(this.game,e.Car),this.Junk=e.Junk,this.NrOfBuiltCars=e.NrOfBuiltCars,this.Saves=e.Saves,this.CompletedMissions=e.CompletedMissions,this.OwnStuff=e.OwnStuff?e.OwnStuff:[],this.myLastPile=e.myLastPile,this.gifts=e.gifts,this.toYardThroughDoor=e.toYardThroughDoor,this.givenMissions=e.givenMissions,this.figgeIsComing=e.figgeIsComing,this.missionIsComing=e.missionIsComing,this.savedCars=e.savedCars,this.language=this.game.mulle.defaultLanguage}},{key:"toJSON",value:function(){return{UserId:this.UserId,Car:this.Car,Junk:this.Junk,NrOfBuiltCars:this.NrOfBuiltCars,CompletedMissions:this.CompletedMissions,OwnStuff:this.OwnStuff,givenMissions:this.givenMissions,myLastPile:this.myLastPile,savedCars:this.savedCars}}}],t&&ee(e.prototype,t),r&&ee(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}();function ne(e){return ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ne(e)}function ie(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oe(n.key),n)}}function oe(e){var t=function(e,t){if("object"!=ne(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=ne(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ne(t)?t:t+""}function ae(e,t,r){return t=ue(t),function(e,t){if(t&&("object"==ne(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,se()?Reflect.construct(t,r||[],ue(e).constructor):t.apply(e,r))}function se(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(se=function(){return!!e})()}function ue(e){return ue=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ue(e)}function le(e,t){return le=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},le(e,t)}const ce=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ae(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&le(e,t)}(t,e),r=t,(n=[{key:"preload",value:function(){this.game.load.pack("menu","assets/menu.json",null,this)}},{key:"create",value:function(){var e=this;this.game.mulle.addAudio("menu");var t=new x.A(this.game,320,240);t.setDirectorMember("10.DXR",2),this.game.add.existing(t);var r=new x.A(this.game,139,296);r.setDirectorMember("10.DXR",125),this.game.add.existing(r);var n=new G(this.game,139,296,"mulleMenuHead");n.animations.play("idle"),this.game.add.existing(n);var i=new G(this.game,139,296,"mulleMenuMouth");i.animations.play("idle"),this.game.add.existing(i),this.nameInput=document.createElement("input"),this.nameInput.style.position="absolute",this.nameInput.style.top="60px",this.nameInput.style.left="90px",this.nameInput.style.border="none",this.nameInput.style.font="28px serif",this.nameInput.style.padding="4px",this.nameInput.style.background="none",this.nameInput.style.width="180px",this.nameInput.addEventListener("keyup",function(t){var r=e.nameInput.value;if(13===t.keyCode){if(e.game.mulle.UsersDB[r])e.game.mulle.user=e.game.mulle.UsersDB[r];else{var n=new re(e.game);n.UserId=r,e.game.mulle.UsersDB[r]=n,e.game.mulle.saveData(),e.game.mulle.user=n}e.game.mulle.activeCutscene="00b011v0",e.game.mulle.net.send({name:r}),e.game.state.start("garage")}}),document.getElementById("player").appendChild(this.nameInput);var o=60,a=function(t){var r=e.game.add.text(350,o,t,{font:"24px serif"});r.inputEnabled=!0,r.events.onInputOver.add(function(t){e.game.canvas.className="cursor-point"},e),r.events.onInputOut.add(function(t){e.game.canvas.className=""},e),r.events.onInputUp.add(function(r){e.game.canvas.className="",e.game.mulle.user=e.game.mulle.UsersDB[t],e.game.mulle.activeCutscene="00b011v0",e.game.mulle.net.send({name:t}),e.game.state.start("garage")},e),o+=25};for(var s in this.game.mulle.UsersDB)a(s);this.game.mulle.subtitle.setLines("11d001v0","swedish",["- Hej!","- Jag heter {Mulle Meck}!","- Vill du bygga bilar med mig?","- Skriv ditt namn så kan vi sätta igång.","- Har du byggt förr så klickar du på ditt namn i {listan}."],"mulle"),this.game.mulle.subtitle.setLines("11d001v0","english",["- Hello!","- My name is {Mulle Meck}!","- Do you want to build cars with me?","- Write down your name so we can start.","- If you've been here before, click your name in the {list}."],"mulle"),this.game.mulle.playAudio("10e001v0",function(){i&&(e.game.mulle.playAudio("10e002v0"),i.talk("11d001v0",null,function(e){"silence"===e[1]&&i.animations.play("idle",0),"talk"===e[1]&&i.animations.play("talkPlayer"),"point"===e[1]&&(n.animations.play("point"),console.log("do point"))}))}),this.game.input.keyboard.addKey(Phaser.Keyboard.C).onDown.add(function(){e.game.state.start("credits")}),this.game.input.keyboard.addKey(Phaser.Keyboard.W).onDown.add(function(){e.game.state.start("worldselect")})}},{key:"shutdown",value:function(){this.nameInput&&this.nameInput.parentNode.removeChild(this.nameInput),this.game.sound.stopAll(),this.nameInput=null}}])&&ie(r.prototype,n),i&&ie(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(N);function fe(e){return fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fe(e)}function he(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return me(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?me(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function me(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function de(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pe(n.key),n)}}function pe(e){var t=function(e,t){if("object"!=fe(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==fe(t)?t:t+""}function ye(e,t){if(t&&("object"==fe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function ge(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(ge=function(){return!!e})()}function ve(e){return ve=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ve(e)}function be(e,t){return be=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},be(e,t)}const we=function(e){function t(e,r,n,i){var o,a,s,u,l=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),a=this,u=[e,n,i],s=ve(s=t),(o=ye(a,ge()?Reflect.construct(s,u||[],ve(a).constructor):s.apply(a,u))).part_id=r,o.car=null,o.canAttach=!1,o.activeMorph=null,o.activeView=null,o.noAttach=!1,o.snapSound=!1,o.snapDistance=40,o.justDetached=!1,o.groundSound=!1,o.noPhysics=l,o.dropTargets=[],o.dragTicks=0,!o.game.mulle.PartsDB[o.part_id])return console.error("invalid part",o.part_id),ye(o);o.partData=o.game.mulle.getPart(o.part_id),o.sound_floor="00e001v0",o.sound_attach="03e003v0";var c=o.getProperty("weight");if(c&&(c>=4?(o.sound_attach="03e003v2",o.sound_floor="00e003v0"):c>=2&&(o.sound_attach="03e003v1",o.sound_floor="00e002v0")),o.default={junkView:e.mulle.getDirectorImage("CDDATA.CXT",o.partData.junkView),UseView:e.mulle.getDirectorImage("CDDATA.CXT",o.partData.UseView),UseView2:e.mulle.getDirectorImage("CDDATA.CXT",o.partData.UseView2),offset:o.partData.offset.clone()},console.log("default",o.default),o.morphs=null,o.partData.MorphsTo){o.morphs=[];for(var f=0;f<o.partData.MorphsTo.length;f++){var h=o.partData.MorphsTo[f],m=o.game.mulle.getPart(h);o.morphs.push({partId:h,partData:m,junkView:e.mulle.getDirectorImage("CDDATA.CXT",m.junkView),UseView:e.mulle.getDirectorImage("CDDATA.CXT",m.UseView),UseView2:e.mulle.getDirectorImage("CDDATA.CXT",m.UseView2),offset:m.offset.clone()})}}return o.setImage("junkView"),o.inputEnabled=!0,o.input.enableDrag(!1),o.cursor="Grab",o.events.onInputOver.add(function(){o.game.mulle.cursor.current="Grab"}),o.events.onInputOut.add(function(){o.game.mulle.cursor.current=null}),o.events.onDragStart.add(o.onGrab.bind(o)),o.events.onDragStop.add(o.onDrop.bind(o)),o.events.onDragUpdate.add(o.onMove.bind(o)),o.noPhysics||(o.game.physics.enable(o,Phaser.Physics.ARCADE),o.body.collideWorldBounds=!0,o.body.onWorldBounds=new Phaser.Signal,o.body.onWorldBounds.add(o.onHitGround,o)),o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&be(e,t)}(t,e),r=t,n=[{key:"setImage",value:function(e){var t=null!=this.activeMorph?this.morphs[this.activeMorph]:this.default;this.key===t[e].key&&this.animations.frameName===t[e].name||(this.key===t[e].key?this.frameName=t[e].name:this.loadTexture(t[e].key,t[e].name),this.activeView=e,this.activeMorph,t[e].key,t[e].name)}},{key:"onMove",value:function(e,t,r,n,i,o){if(this.dropTargets){var a,s=he(this.dropTargets);try{for(s.s();!(a=s.n()).done;){var u=a.value;if(u[0].hitArea){if(u[0].hitArea.contains(t.x-u[0].position.x,t.y-u[0].position.y)){u[0].isHovering||(u[0].cursor=u[0].cursorDrag,u[0].events.onInputOver.dispatch(),u[0].isHovering=!0);break}u[0].isHovering&&(u[0].cursor=u[0].cursorHover,u[0].events.onInputOut.dispatch(),u[0].isHovering=null)}}}catch(e){s.e(e)}finally{s.f()}}if(this.car){if(!this.justDetached&&this.noAttach)return this.activeMorph=null,this.canAttach=!1,"junkView"!==this.activeView&&this.setImage("junkView"),this.dragTicks++,void(60===this.dragTicks&&this.game.mulle.actors.mulle.talk("03d04"+this.game.rnd.integerInRange(0,2)+"v0"));var l=this.default.junkView.frame.regpoint;if(this.morphs){for(var c=0;c<this.morphs.length;c++){var f=this.morphs[c],h=f.UseView.frame.regpoint,m=r-l.x+h.x,d=n-l.y+h.y-f.offset.y,p=this.car.x+f.offset.x,y=this.car.y+f.offset.y;if(this.game.math.distance(m,d,p,y)<this.snapDistance){if(!this.checkCanAttach(c))continue;return this.position.set(p,y),this.canAttach=!0,this.activeMorph=c,this.setImage("UseView"),void(this.snapSound||(this.game.mulle.playAudio(this.sound_attach),this.snapSound=!0))}}this.snapSound&&(this.game.mulle.playAudio(this.sound_attach),this.snapSound=!1),this.canAttach=!1,this.activeMorph=null,this.setImage("junkView")}else h=this.default.UseView.frame.regpoint,m=r-l.x+h.x,d=n-l.y+h.y,this.game.math.distance(m,d,this.car.x,this.car.y)<this.snapDistance&&this.checkCanAttach()?(this.setImage("UseView"),this.position.set(this.car.x,this.car.y),this.canAttach=!0,this.snapSound||(this.game.mulle.playAudio(this.sound_attach),this.snapSound=!0)):(this.setImage("junkView"),this.canAttach=!1,this.snapSound&&(this.game.mulle.playAudio(this.sound_attach),this.snapSound=!1))}}},{key:"checkCanAttach",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;if(null!=e&&this.morphs){if(this.morphs[e].partData.Requires)for(var t in this.morphs[e].partData.Requires)if(this.car.usedPoints[this.morphs[e].partData.Requires[t]])return!1;if(this.morphs[e].partData.Covers)for(var t in this.morphs[e].partData.Covers)if(this.car.coveredPoints[this.morphs[e].partData.Covers[t]])return!1}if(this.partData.Requires){var r=!1;for(var t in this.partData.Requires)if(this.car.points[this.partData.Requires[t]]){r=!0;break}if(!r)return!1;for(var t in this.partData.Requires)if(this.car.usedPoints[this.partData.Requires[t]])return!1;for(var t in this.partData.Covers)if(this.car.coveredPoints[this.partData.Covers[t]])return!1}return!0}},{key:"onGrab",value:function(){var e=this;if(this.dragTicks=0,this.bringToTop(),this.groundSound=!1,this.noPhysics||(this.body.moves=!1),this.car)if(this.morphs){var t=this.morphs.length;this.morphs.forEach(function(r,n){e.checkCanAttach(n)||t--}),this.noAttach=t<=0}else this.noAttach=!this.checkCanAttach()}},{key:"onDrop",value:function(e,t){if(this.justDetached||Phaser.Point.distance(this.position,this.input.dragStartPoint)<5&&this.playDescription(),this.snapSound=!1,this.noPhysics?this.game.mulle.playAudio(this.sound_floor):(this.body.moves=!0,this.body.velocity.set(0)),this.justDetached=!1,!this.noAttach&&this.canAttach){var r=this.part_id;return null!==this.activeMorph&&(r=this.morphs[this.activeMorph].partId),console.log("attach part by drag",r),this.events.onInputOut.dispatch(),this.destroy(),void this.car.attach(r)}if(this.activeMorph=null,this.setImage("junkView"),this.dropTargets){var n,i=he(this.dropTargets);try{for(i.s();!(n=i.n()).done;){var o=n.value;if(o[0].hitArea&&o[0].hitArea.contains(t.x-o[0].position.x,t.y-o[0].position.y)){var a=this.game;if(o[1](this))return a.mulle.cursor.remove(o[0].cursor),void(o[0].cursor=o[0].cursorHover)}}}catch(e){i.e(e)}finally{i.f()}}if(this.dropRects){for(var s=!1,u=0;u<this.dropRects.length;u++)if(this.dropRects[u].contains(this.x,this.y)){s=!0;break}if(!s){var l=this.game.rnd.pick(this.dropRects);this.game.add.tween(this).to({x:l.randomX,y:l.randomY},1e3,Phaser.Easing.Cubic.Out,!0)}}}},{key:"onHitGround",value:function(){this.groundSound||(this.game.mulle.playAudio(this.sound_floor),this.groundSound=!0)}},{key:"playDescription",value:function(){this.game.mulle.actors.mulle&&this.game.mulle.actors.mulle.talk(this.partData.description)}},{key:"getProperty",value:function(e){return this.partData.getProperty(e)}}],n&&de(r.prototype,n),i&&de(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(x.A);function Pe(e){return Pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pe(e)}function ke(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Se(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Se(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function Se(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Oe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,je(n.key),n)}}function je(e){var t=function(e,t){if("object"!=Pe(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Pe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Pe(t)?t:t+""}function De(e,t,r){return t=xe(t),function(e,t){if(t&&("object"==Pe(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Ae()?Reflect.construct(t,r||[],xe(e).constructor):t.apply(e,r))}function Ae(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Ae=function(){return!!e})()}function Ce(){return Ce="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=xe(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},Ce.apply(null,arguments)}function xe(e){return xe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},xe(e)}function Re(e,t){return Re=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Re(e,t)}const _e=function(){function e(t,r,n,i){var o,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),(o=De(this,e,[t])).x=r,o.y=n,o.parts=i||o.game.mulle.user.Car.Parts,o.locked=a,o.partSprites={},o.points={},o.layers={},o.usedPoints={},o.coveredPoints={},o.mulleSit=null,o.hasDriver=s,o.onAttach=new Phaser.Signal,o.onDetach=new Phaser.Signal,o.onRefresh=new Phaser.Signal,o.refresh(),o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Re(e,t)}(e,Phaser.Group),t=e,r=[{key:"refresh",value:function(){var e=this;this.points={},this.layers={},this.usedPoints={},this.coveredPoints={},this.removeAll(!0),this.partSprites={};var t=function(){var t=e.parts[r],n=e.game.mulle.getPart(t);if(!n)return console.error("invalid part",t),1;if(e.partSprites[t]={},n.new&&n.new.forEach(function(t,r){e.points[t.id]={fg:t.fg,bg:t.bg,offset:t.offset}}),n.Requires&&n.Requires.forEach(function(t){e.usedPoints[t]=!0}),n.UseView){var i=new x.A(e.game,0,0);i.setDirectorMember("CDDATA.CXT",n.UseView),i.partId=t,i.layer=n.Requires[0],i.sortIndex=e.points[i.layer]?e.points[i.layer].fg:8,i.position.add(n.offset.x,n.offset.y),!e.locked&&n.Requires&&(i.inputEnabled=!0,i.events.onInputOver.add(function(){e.game.mulle.cursor.current="Grab"}),i.events.onInputOut.add(function(){e.game.mulle.cursor.current=null}),i.events.onInputDown.add(function(r){e.game.mulle.cursor.current=null,e.detach(t)},e.game)),e.add(i),e.partSprites[t].fg=i}if(n.UseView2){var o=new x.A(e.game,0,0);o.setDirectorMember("CDDATA.CXT",n.UseView2),o.partId=t,o.layer=n.Requires[0],o.sortIndex=e.points[o.layer].bg?e.points[o.layer].bg:7,o.is_bg=!0,o.position.add(n.offset.x,n.offset.y),e.add(o),e.partSprites[t].bg=o}};for(var r in this.parts)t();for(var n in this.hasDriver&&(this.mulleSit=new G(this.game,0,0,"mulleSit"),this.mulleSit.isMulle=!0,this.mulleSit.sortIndex=18,this.addChild(this.mulleSit),this.game.mulle.actors.mulle=this.mulleSit),this.points)this.layers[n]={fg:this.points[n].fg,bg:this.points[n].bg};this.sortLayers(),this.onRefresh.dispatch(),this.points}},{key:"sortLayers",value:function(){this.customSort(function(e,t){return e.sortIndex<t.sortIndex?-1:1})}},{key:"attach",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return!this.locked&&(this.parts.push(parseInt(e)),this.onAttach.dispatch(e),this.refresh(),t||this.save(),!0)}},{key:"detach",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.locked)return!1;var r=this.parts.indexOf(e);if(-1===r)return!1;var n=this.game.mulle.getPart(e),i=this.partSprites[e].fg.worldPosition.clone(),o=n.master?n.master:e;if(this.parts.splice(r,1),this.onDetach.dispatch(e,o,i),this.refresh(),t){var a=new we(this.game,o);a.car=this,a.justDetached=!0,this.junkParts.addChild(a),a.position.set(i.x,i.y),a.position.add(a.regPoint.x,a.regPoint.y),a.input.startDrag(this.game.input.activePointer),this.game.mulle.playAudio(a.sound_attach)}return this.save(),!0}},{key:"destroy",value:function(){var t,r,n,i,o;this.mulleSit&&this.game.mulle.actors.mulle===this.mulleSit&&(this.game.mulle.actors.mulle=null),(t=e,r="destroy",n=this,o=Ce(xe(1&(i=3)?t.prototype:t),r,n),2&i&&"function"==typeof o?function(e){return o.apply(n,e)}:o)([])}},{key:"trash",value:function(){var e,t,r,n=ke(this.parts);try{for(n.s();!(r=n.n()).done;)(e=r.value)>1&&((t=this.game.mulle.PartsDB[e]).master&&(e=t.master),this.game.mulle.user.addPart("Pile1",e,null,!0))}catch(e){n.e(e)}finally{n.f()}this.parts=[1],this.game.mulle.user.Car.Medals=[],this.game.mulle.user.Car.Name="",this.refresh(),this.save()}},{key:"save",value:function(){this.game.mulle.user.Car.Parts=this.parts}}],r&&Oe(t.prototype,r),n&&Oe(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r,n}();function Te(e){return Te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Te(e)}function Ee(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Me(n.key),n)}}function Me(e){var t=function(e,t){if("object"!=Te(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Te(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Te(t)?t:t+""}function Ie(e,t,r){return t=Le(t),function(e,t){if(t&&("object"==Te(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Be()?Reflect.construct(t,r||[],Le(e).constructor):t.apply(e,r))}function Be(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Be=function(){return!!e})()}function Ne(){return Ne="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=Le(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},Ne.apply(null,arguments)}function Le(e){return Le=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Le(e)}function Fe(e,t){return Fe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Fe(e,t)}const Xe=function(){function e(t,r,n,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),(o=Ie(this,e,[t,r,n])).opt=i,o.displaySprite=new x.A(o.game,o.x,o.y),o.opt.imageDefault&&(o.displaySprite.setDirectorMember(o.opt.imageDefault[0],o.opt.imageDefault[1]),o.game.add.existing(o.displaySprite),o.displaySprite._frame?o.hitArea=new Phaser.Rectangle(-o.displaySprite.regPoint.x,-o.displaySprite.regPoint.y,o.displaySprite._frame.width,o.displaySprite._frame.height):console.error("no hit area",o)),o.input.useHandCursor=!1,o.cursor="Click",o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Fe(e,t)}(e,Phaser.Button),t=e,r=[{key:"onInputOverHandler",value:function(){this.cursor&&(this.game.mulle.cursor.current=this.cursor),this.displaySprite&&this.opt.imageHover&&this.displaySprite.setDirectorMember(this.opt.imageHover[0],this.opt.imageHover[1]),this.opt.soundHover&&this.game.mulle.playAudio(this.opt.soundHover)}},{key:"onInputOutHandler",value:function(){this.game.mulle.cursor.current=null,this.displaySprite&&this.opt.imageDefault&&this.displaySprite.setDirectorMember(this.opt.imageDefault[0],this.opt.imageDefault[1]),this.opt.soundDefault&&this.game.mulle.playAudio(this.opt.soundDefault)}},{key:"onInputUpHandler",value:function(){this.opt.click()}},{key:"onDown",value:function(){}},{key:"destroy",value:function(t){var r,n,i,o,a;(r=e,n="destroy",i=this,a=Ne(Le(1&(o=3)?r.prototype:r),n,i),2&o&&"function"==typeof a?function(e){return a.apply(i,e)}:a)([t]),this.displaySprite.destroy()}},{key:"hide",value:function(){this.visible=!1,this.displaySprite.visible=!1}},{key:"show",value:function(){this.visible=!0,this.displaySprite.visible=!0}}],n=[{key:"fromRectangle",value:function(t,r,n,i,o,a){var s=new e(t,r,n,a);return s.width=i,s.height=o,s}}],r&&Ee(t.prototype,r),n&&Ee(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r,n}();function He(e){return He="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},He(e)}function Ue(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Je(n.key),n)}}function Je(e){var t=function(e,t){if("object"!=He(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=He(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==He(t)?t:t+""}function We(e,t,r){return t=Ge(t),function(e,t){if(t&&("object"==He(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Ve()?Reflect.construct(t,r||[],Ge(e).constructor):t.apply(e,r))}function Ve(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Ve=function(){return!!e})()}function Ge(e){return Ge=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ge(e)}function qe(e,t){return qe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},qe(e,t)}const Ke=function(e){function t(e,r,n){var i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=We(this,t,[e,r,n])).startX=r,i.startY=n,i.isShowing=!1,i.setDirectorMember("00.CXT",97),i.inputEnabled=!0,i.events.onInputOver.add(function(){e.add.tween(i).to({x:i.startX-40,y:i.position.y},Phaser.Timer.SECOND/5,Phaser.Easing.Linear.None,!0),i.game.mulle.playAudio("00e040v0")}),i.events.onInputOut.add(function(){e.add.tween(i).to({x:i.startX,y:i.position.y},Phaser.Timer.SECOND/5,Phaser.Easing.Linear.None,!0)}),i.events.onInputDown.add(i.toggleToolbox),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&qe(e,t)}(t,e),r=t,(n=[{key:"toggleToolbox",value:function(e,t){e.isShowing?e.isShowing=!e.hideToolbox():e.isShowing=e.showToolbox()}},{key:"showToolbox",value:function(){}},{key:"hideToolbox",value:function(){}}])&&Ue(r.prototype,n),i&&Ue(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(x.A);function Ye(e){return Ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ye(e)}function $e(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Qe(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Qe(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function Qe(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function ze(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ze(n.key),n)}}function Ze(e){var t=function(e,t){if("object"!=Ye(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Ye(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Ye(t)?t:t+""}const et=function(){return e=function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:["english","swedish"];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.game=t,this.topic=r,this.languages=n},t=[{key:"preload",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e||(e=this.topic);var t,r=$e(this.languages);try{for(r.s();!(t=r.n()).done;){var n=t.value;this.game.load.json(e+"Subs","data/subtitles/"+n+"/"+e+".json")}}catch(e){r.e(e)}finally{r.f()}}},{key:"load",value:function(e){e||(e=this.topic);var t,r=$e(this.languages);try{for(r.s();!(t=r.n()).done;){var n=t.value;if(this.game.mulle.subtitle.database[n]){var i=this.game.cache.getJSON(e+"Subs");for(var o in i)this.game.mulle.subtitle.database[n][o]=i[o]}else console.error("Invalid subtitle language "+n)}}catch(e){r.e(e)}finally{r.f()}}}],t&&ze(e.prototype,t),r&&ze(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}();function tt(e){return tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tt(e)}function rt(e){return function(e){if(Array.isArray(e))return nt(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return nt(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?nt(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function nt(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function it(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ot(n.key),n)}}function ot(e){var t=function(e,t){if("object"!=tt(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=tt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==tt(t)?t:t+""}function at(e,t,r){return t=ct(t),function(e,t){if(t&&("object"==tt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,st()?Reflect.construct(t,r||[],ct(e).constructor):t.apply(e,r))}function st(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(st=function(){return!!e})()}function ut(e,t,r,n){var i=lt(ct(1&n?e.prototype:e),t,r);return 2&n&&"function"==typeof i?function(e){return i.apply(r,e)}:i}function lt(){return lt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=ct(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},lt.apply(null,arguments)}function ct(e){return ct=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ct(e)}function ft(e,t){return ft=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ft(e,t)}const ht=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),at(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ft(e,t)}(t,e),r=t,(n=[{key:"preload",value:function(){this.DirResource="03.DXR",ut(t,"preload",this,3)([]),this.game.load.pack("garage","assets/garage.json",null,this),this.game.load.json("partNames","data/part_names.json"),this.subtitles=new et(this.game,"garage",["dutch","english"]),this.subtitles.preload(),this.subtitles.preload("carparts")}},{key:"hasCarChanged",value:function(){var e=this.game.mulle.user.Car.Parts;if(e.length!==this.enterParts.length)return!0;for(var t=0,r=e.length;t<r;t++)if(e[t]!==this.enterParts[t])return console.log("Car has changed, different parts",t,e[t],this.enterParts[t]),!0;return!1}},{key:"figge",value:function(){var e=this;this.game.mulle.user.calculateParts(),this.game.mulle.playAudio("03e009v0",function(){e.game.mulle.playAudio("03d043v0",function(){var t=new G(e.game,320,240,"figgeDoor");e.game.add.existing(t),e.game.mulle.actors.figge=t,e.door_junk.onInputOverHandler(),e.game.mulle.playAudio("02e016v0",function(){t.animations.play("enter").onComplete.addOnce(function(){e.game.mulle.actors.figge.talk("03d044v0",function(){t.animations.play(t.silenceAnimation),e.game.mulle.actors.mulle.silenceAnimation="idle",e.game.mulle.actors.mulle.talkAnimation="talkRegular",e.game.mulle.actors.mulle.talk("03d045v0",function(){e.game.mulle.actors.mulle.silenceAnimation="lookPlayer",e.game.mulle.actors.mulle.talkAnimation="talkPlayer",e.game.mulle.actors.figge.talk("03d046v0",function(){t.destroy(),e.door_junk.onInputOutHandler(),e.game.mulle.playAudio("02e015v0",function(){e.game.mulle.actors.figge=null,e.game.mulle.playAudio("03e010v0",function(){console.log("figge done")})})})})})})})})}),this.figgeGiveParts()}},{key:"figgeGiveParts",value:function(){if(this.game.mulle.user.availableParts.JunkMan.length>0){for(var e=0;e<3;e++){var t=this.game.mulle.user.availableParts.JunkMan[e];if(!t)break;this.game.mulle.user.addPart("yard",t,null,!0),console.log("figge add part",t)}return this.game.mulle.user.save(),!0}return!1}},{key:"makePart",value:function(e,t,r){var n=this,i=new we(this.game,e,t,r);return i.car=this.car,i.junkParts=this.junkParts,i.dropTargets.push([this.door_junk,function(t){return t.destroy(),n.game.mulle.user.Junk.Pile1[e]={x:n.game.rnd.integerInRange(0,640),y:240},n.game.mulle.playAudio("00e004v0"),!0}]),i.dropTargets.push([this.door_side,function(t){return t.destroy(),n.game.mulle.user.Junk.yard[e]={x:n.game.rnd.integerInRange(0,640),y:240},n.game.mulle.playAudio("00e004v0"),!0}]),i.dropTargets.push([this.door_garage,function(t){return t.destroy(),n.game.mulle.user.Junk.yard[e]={x:n.game.rnd.integerInRange(0,640),y:240},n.game.mulle.playAudio("00e004v0"),!0}]),this.junkParts.addChild(i),i}},{key:"create",value:function(){var e=this;ut(t,"create",this,3)([]),this.car=null,this.junkPile=null,this.junkParts=null,this.door_junk=null,this.mulleActor=null,this.toolbox=null,this.popupMenu=null,this.door_junk=null,this.door_garage=null,this.door_side=null,this.game.physics.startSystem(Phaser.Physics.ARCADE),this.game.physics.arcade.gravity.y=800,this.game.mulle.addAudio("garage"),this.subtitles.load(),this.subtitles.load("carparts"),this.enterParts=rt(this.game.mulle.user.Car.Parts);var r=new x.A(this.game,320,240);for(var n in r.setDirectorMember("03.DXR",33),this.game.add.existing(r),this.door_junk=new Xe(this.game,320,240,{imageDefault:["03.DXR",34],imageHover:["03.DXR",35],soundDefault:"02e015v0",soundHover:"02e016v0",click:function(){e.game.mulle.activeCutscene=70,e.game.state.start("junk")}}),this.door_junk.cursor="Click",this.door_junk.cursorHover="Click",this.door_junk.cursorDrag="MoveIn",this.game.add.existing(this.door_junk),this.door_garage=new Xe(this.game,320,240,{imageDefault:["03.DXR",36],imageHover:["03.DXR",37],soundDefault:"02e015v0",soundHover:"02e016v0",click:function(){e.game.mulle.user.Car.isRoadLegal(!0)&&(e.game.mulle.activeCutscene=67,e.game.mulle.user.toYardThroughDoor=!1,e.game.state.start("yard"),e.hasCarChanged()&&(isNaN(e.game.mulle.user.NrOfBuiltCars)&&(e.game.mulle.user.NrOfBuiltCars=0),e.game.mulle.user.NrOfBuiltCars+=1,e.game.mulle.user.figgeIsComing=!0,e.game.mulle.user.missionIsComing=!0,console.log("Increase NrOfBuiltCars to ",e.game.mulle.user.NrOfBuiltCars)))}}),this.door_garage.cursor="Left",this.door_garage.cursorHover="Left",this.door_garage.cursorDrag="MoveLeft",this.game.add.existing(this.door_garage),this.door_side=new Xe(this.game,320,240,{imageDefault:["03.DXR",38],imageHover:["03.DXR",39],soundDefault:"02e015v0",soundHover:"02e016v0",click:function(){e.game.mulle.activeCutscene=68,e.game.mulle.user.toYardThroughDoor=!0,e.game.state.start("yard")}}),this.door_side.cursor="Left",this.door_side.cursorHover="Left",this.door_side.cursorDrag="MoveLeft",this.game.add.existing(this.door_side),this.car_camera=Xe.fromRectangle(this.game,589,62,41,117,{imageHover:["03.DXR",104],soundHover:"02e011v0",click:function(){e.game.mulle.activeCutscene=86,e.game.state.start("album",!0,!1,"save")}}),this.game.add.existing(this.car_camera),this.album=Xe.fromRectangle(this.game,383,41,50,28,{imageHover:["03.DXR",103],soundHover:"02e011v0",click:function(){e.game.mulle.activeCutscene=83,e.game.state.start("album",!0,!1,"load")}}),this.game.add.existing(this.album),this.car=new _e(this.game,368,240,null,!1),this.game.add.existing(this.car),this.car.onDetach.add(function(t,r,n){var i=e.makePart(r,n.x,n.y);i.justDetached=!0,i.position.add(i.regPoint.x,i.regPoint.y),i.input.startDrag(e.game.input.activePointer),e.game.mulle.playAudio(i.sound_attach)}),this.mulleActor=new G(this.game,118,188,"mulleDefault"),this.game.add.existing(this.mulleActor),this.game.mulle.actors.mulle=this.mulleActor,this.junkParts=this.game.add.group(),this.junkParts.pileName="shopFloor",this.car.junkParts=this.junkParts,this.game.mulle.user.Junk.shopFloor){var i=this.game.mulle.user.Junk.shopFloor[n];this.makePart(n,i.x,i.y)}if(console.log("Built cars",this.game.mulle.user.NrOfBuiltCars),console.log("Built cars mod",this.game.mulle.user.NrOfBuiltCars%3),this.game.mulle.user.NrOfBuiltCars%3==0&&this.game.mulle.user.figgeIsComing&&(console.log("Figge is coming!"),this.game.mulle.user.figgeIsComing=0,this.game.mulle.user.figgeBeenHere=1,this.figge()),this.toolbox=new Ke(this.game,657,432),this.game.add.existing(this.toolbox),this.toolbox.showToolbox=function(){e.blockSprite=new x.A(e.game,0,0),e.blockSprite.width=640,e.blockSprite.height=480,e.blockSprite.inputEnabled=!0,e.blockSprite.input.useHandCursor=!1,e.game.add.existing(e.blockSprite),e.popupMenu=new x.A(e.game,320,200),e.popupMenu.setDirectorMember("00.CXT",84),e.game.add.existing(e.popupMenu);var t,r={Trash:[165,125,245,260],Diploma:[265,127,345,264],quit:[365,125,445,266],Cancel:[460,210,528,365]},n={Trash:"09d001v0",quit:"09d003v0",Diploma:"09d002v0",Cancel:"09d004v0"},i={Trash:function(){e.car.trash()},Diploma:function(){e.game.mulle.activeCutscene=81,e.game.state.start("diploma",!0,!1,e.key)},Cancel:function(){e.toolbox.toggleToolbox(e.toolbox)},quit:function(){e.game.state.start("menu")}};e.popupMenuButtons=e.game.add.group();var o=function(o){var a=r[o],s=new Phaser.Button(e.game,a[0],a[1]-40);s.width=a[2]-a[0],s.height=a[3]-a[1],s.onInputOver.add(function(){t&&t.stop(),t=e.game.mulle.playAudio(n[o])}),s.onInputDown.add(function(){t&&t.stop(),i[o]()}),e.popupMenuButtons.addChild(s)};for(var a in r)o(a);return!0},this.toolbox.hideToolbox=function(){return e.blockSprite.destroy(),e.popupMenu.destroy(),e.popupMenuButtons.destroy(),!0},this.game.mulle.cheats){var o=this.game.cache.getJSON("partNames");document.getElementById("cheats").innerHTML="";var a=document.createElement("button");a.innerHTML="Figge",a.className="button",a.addEventListener("click",function(){e.figge()}),document.getElementById("cheats").appendChild(a);var s=function(t){if(e.game.mulle.PartsDB[t].master)return 1;var r=e.game.mulle.user.hasPart(t),n=document.createElement("button");n.innerHTML=o&&o[t]?"("+t+") "+o[t]:t,n.className="button",r&&n.setAttribute("style","background: #222"),n.addEventListener("click",function(){if(r)for(var n in e.game.mulle.user.Junk)t in e.game.mulle.user.Junk[n]&&(console.log("Remove part ".concat(t," from ").concat(n)),delete e.game.mulle.user.Junk[n][t]);e.makePart(t,320,240)}),document.getElementById("cheats").appendChild(n)};for(var u in this.game.mulle.PartsDB)s(u)}this.game.input.keyboard.addKey(Phaser.Keyboard.C).onDown.add(function(){e.game.state.start("credits")}),this.game.input.keyboard.addKey(Phaser.Keyboard.W).onDown.add(function(){e.game.state.start("worldselect")})}},{key:"shutdown",value:function(){var e=this;console.log("shutdown garage"),this.game.mulle.user.Junk.shopFloor={},this.junkParts.forEach(function(t){e.game.mulle.user.Junk.shopFloor[t.part_id]={x:t.x,y:t.y}}),this.game.mulle.user.save(),this.game.mulle.net.send({parts:this.game.mulle.user.Car.Parts}),this.game.mulle.actors.mulle=null,document.getElementById("cheats").innerHTML="",ut(t,"shutdown",this,3)([])}}])&&it(r.prototype,n),i&&it(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(N);function mt(e){return mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mt(e)}function dt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pt(n.key),n)}}function pt(e){var t=function(e,t){if("object"!=mt(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=mt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==mt(t)?t:t+""}function yt(e,t,r){return t=vt(t),function(e,t){if(t&&("object"==mt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,gt()?Reflect.construct(t,r||[],vt(e).constructor):t.apply(e,r))}function gt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(gt=function(){return!!e})()}function vt(e){return vt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},vt(e)}function bt(e,t){return bt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},bt(e,t)}const wt=function(e){function t(e,r,n){var i,o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(i=yt(this,t,[e,r,n,"mulleJunkYard",!0])).movie="02.DXR";var a;return a=o?246:226,i.setDirectorMember(i.movie,a),i.addDirectorAnimation("idle",a,[1],!0),i.addDirectorAnimation("talk",a,[1,2,3,4,5,6,7,8],!0),i.addDirectorAnimation("talkPlayer",a,[10,11,12,13,14,15,16,17,18],!0),i.addDirectorAnimation("lookPlayer",a,[10],!0),i}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&bt(e,t)}(t,e),r=t,n&&dt(r.prototype,n),i&&dt(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(G);var Pt=r(57);function kt(e){return kt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},kt(e)}function St(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,s=[],u=!0,l=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ot(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ot(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ot(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function jt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Dt(n.key),n)}}function Dt(e){var t=function(e,t){if("object"!=kt(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=kt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==kt(t)?t:t+""}function At(e,t,r){return t=_t(t),function(e,t){if(t&&("object"==kt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Ct()?Reflect.construct(t,r||[],_t(e).constructor):t.apply(e,r))}function Ct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Ct=function(){return!!e})()}function xt(e,t,r,n){var i=Rt(_t(1&n?e.prototype:e),t,r);return 2&n&&"function"==typeof i?function(e){return i.apply(r,e)}:i}function Rt(){return Rt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_t(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},Rt.apply(null,arguments)}function _t(e){return _t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_t(e)}function Tt(e,t){return Tt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Tt(e,t)}const Et=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=At(this,t)).piles={1:{bg:"02b001v0",door:85,right:162,left:174,rect:[[193,260,637,400],[291,193,637,263],[361,153,636,194]]},2:{bg:"02b002v0",door:87,right:164,left:176,rect:[[210,252,654,380],[256,174,651,262],[365,120,667,188]]},3:{bg:"02b003v0",door:89,right:166,left:178,rect:[[150,281,639,380],[127,162,643,291],[183,100,639,164]]},4:{bg:"02b004v0",door:91,right:168,left:180,rect:[[0,324,425,404],[3,174,425,325],[3,90,425,182]]},5:{bg:"02b005v0",door:93,right:170,left:182,rect:[[6,268,450,412],[5,180,411,275],[0,100,303,189]]},6:{bg:"02b006v0",door:95,right:172,left:184,rect:[[0,275,400,390],[1,201,368,283],[4,135,270,203]]}},e.pile_actors={1:{mulle:{pos:[90,309]}},2:{mulle:{pos:[86,290]}},3:{mulle:{pos:[90,309]}},4:{mulle:{pos:[561,229]}},5:{mulle:{pos:[570,270]}},6:{mulle:{pos:[520,297]}}},e.thoughtSounds=["02d001v0","02d002v0","02d003v0","02d004v0","02d005v0"],e.sortSounds=["02d006v0","02d007v0","02d008v0"],e.shopFullSounds=["02d009v0","02d010v0","02d011v0"],e.pileFullSounds=["02d013v0","02d014v0","02d015v0"],e}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Tt(e,t)}(t,e),r=t,(n=[{key:"preload",value:function(){xt(t,"preload",this,3)([]),this.game.load.pack("junk","assets/junk.json",null,this),this.subtitles=new et(this.game,"junk",["dutch","english"]),this.subtitles.preload("carparts")}},{key:"savePile",value:function(){var e=this;console.log("save junk parts",this.currentPile),this.game.mulle.user.Junk["Pile"+this.currentPile]={},this.junkParts.forEach(function(t){e.game.mulle.user.Junk["Pile"+e.currentPile][t.part_id]={x:t.x,y:t.y}}),this.game.mulle.user.save()}},{key:"setPile",value:function(e){var t=this;this.junkParts&&(this.savePile(),this.junkParts.destroy(),this.game.mulle.user.save()),this.currentPile=e;var r=this.piles[this.currentPile];this.background&&this.background.destroy(),this.background=new x.A(this.game,320,240),this.background.setDirectorMember("02.DXR",r.bg),this.game.add.existing(this.background);var n=this.currentPile-1;n<1&&(n=6);var i=this.currentPile+1;i>6&&(i=1),this.doorShop&&this.doorShop.destroy(),this.doorShop=new Xe(this.game,320,240,{imageDefault:["02.DXR",r.door],imageHover:["02.DXR",r.door+1],soundDefault:"02e015v0",soundHover:"02e016v0",click:function(){t.game.mulle.activeCutscene=71,t.game.state.start("garage")}}),this.game.add.existing(this.doorShop),this.arrowRight&&this.arrowRight.destroy(),this.arrowRight=new Xe(this.game,320,240,{imageDefault:["02.DXR",r.right],imageHover:["02.DXR",r.right+1],click:function(){t.setPile(i)}}),this.game.add.existing(this.arrowRight),this.arrowLeft&&this.arrowLeft.destroy(),this.arrowLeft=new Xe(this.game,320,240,{imageDefault:["02.DXR",r.left],imageHover:["02.DXR",r.left+1],click:function(){t.setPile(n)}}),this.game.add.existing(this.arrowLeft),this.dropRects=[];for(var o=0;o<r.rect.length;o++){var a=new Phaser.Rectangle;a.left=r.rect[o][0],a.top=r.rect[o][1],a.right=r.rect[o][2],a.bottom=r.rect[o][3],this.dropRects.push(a)}var s,u=this.pile_actors[this.currentPile];this.game.mulle.actors.mulle=new wt(this.game,u.mulle.pos[0],u.mulle.pos[1],this.currentPile>3),this.game.add.existing(this.game.mulle.actors.mulle),s=this.currentPile>3?210:209;var l=St(Pt.A.getDirectorImage(this.game,"02.DXR",s),2),c=l[0],f=l[1],h=new x.A(this.game,u.mulle.pos[0],u.mulle.pos[1],c,f);h.setDirectorMember("02.DXR",s),this.game.add.existing(h),this.buffaActor=new G(this.game,320,320,"buffa"),this.buffaActor.animations.play("idle"),this.game.add.existing(this.buffaActor),this.game.mulle.actors.buffa=this.buffaActor,this.game.time.events.loop(5e3,function(){Math.random()>.5&&t.buffaActor.animations.play("scratch1")}),this.junkParts=this.game.add.group(),console.log("spawn junk parts");var m=this.game.mulle.user.Junk["Pile"+this.currentPile],d=function(e){console.log(e);var r=new we(t.game,e,m[e].x,m[e].y,!0);r.dropRects=t.dropRects,r.dropTargets.push([t.doorShop,function(r){return r.destroy(),t.game.mulle.user.Junk.shopFloor[e]={x:t.game.rnd.integerInRange(0,640),y:240},t.savePile(),t.game.mulle.playAudio("00e004v0"),!0}]),r.dropTargets.push([t.arrowLeft,function(r){return r.destroy(),t.game.mulle.user.Junk["Pile"+n][e]={x:t.game.rnd.integerInRange(0,640),y:240},t.savePile(),t.game.mulle.playAudio("00e004v0"),!0}]),r.dropTargets.push([t.arrowRight,function(r){return r.destroy(),t.game.mulle.user.Junk["Pile"+i][e]={x:t.game.rnd.integerInRange(0,640),y:240},t.savePile(),t.game.mulle.playAudio("00e004v0"),!0}]),t.junkParts.addChild(r)};for(var p in m)d(p)}},{key:"create",value:function(){xt(t,"create",this,3)([]),this.background=null,this.doorShop=null,this.arrowRight=null,this.arrowLeft=null,this.dropRects=null,this.junkPile=null,this.junkParts=null,this.setPile(1),this.game.mulle.addAudio("junk"),this.subtitles.load("carparts"),this.game.mulle.playAudio("02e010v0")}},{key:"shutdown",value:function(){console.log("junk shutdown"),this.game.mulle.stopAudio("02e010v0"),this.savePile(),this.game.mulle.user.save()}},{key:"render",value:function(){}}])&&jt(r.prototype,n),i&&jt(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(N);function Mt(e){return Mt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Mt(e)}function It(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Bt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?It(Object(r),!0).forEach(function(t){Nt(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):It(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Nt(e,t,r){return(t=Ft(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Lt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ft(n.key),n)}}function Ft(e){var t=function(e,t){if("object"!=Mt(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Mt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Mt(t)?t:t+""}const Xt=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.game=t,this.missions=null},(t=[{key:"load",value:function(){return this.missions||(this.missions=this.game.cache.getJSON("MissionsDB")),this.missions}},{key:"getNextMission",value:function(){this.load();var e=this.game.mulle.user;for(var t in this.missions){var r=this.missions[t];if(-1===e.givenMissions.indexOf(parseInt(t))&&-1===e.CompletedMissions.indexOf(parseInt(t)))return Bt({id:parseInt(t)},r)}return null}},{key:"getPendingTelephoneMission",value:function(){this.load();var e=this.game.mulle.user;for(var t in this.missions){var r=this.missions[t];if(-1===e.givenMissions.indexOf(parseInt(t))&&-1===e.CompletedMissions.indexOf(parseInt(t))&&"#Telephone"===r.type)return Bt({id:parseInt(t)},r)}return null}},{key:"getPendingMailMission",value:function(){this.load();var e=this.game.mulle.user;for(var t in this.missions){var r=this.missions[t];if(-1===e.givenMissions.indexOf(parseInt(t))&&-1===e.CompletedMissions.indexOf(parseInt(t))&&"#Mail"===r.type)return Bt({id:parseInt(t)},r)}return null}},{key:"markAsGiven",value:function(e){var t=this.game.mulle.user;-1===t.givenMissions.indexOf(e)&&(t.givenMissions.push(e),t.save())}},{key:"markAsCompleted",value:function(e){var t=this.game.mulle.user;-1===t.CompletedMissions.indexOf(e)&&(t.CompletedMissions.push(e),t.save())}},{key:"isCompleted",value:function(e){return-1!==this.game.mulle.user.CompletedMissions.indexOf(e)}},{key:"isGiven",value:function(e){return-1!==this.game.mulle.user.givenMissions.indexOf(e)}}])&&Lt(e.prototype,t),r&&Lt(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}();function Ht(e){return Ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ht(e)}function Ut(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Jt(n.key),n)}}function Jt(e){var t=function(e,t){if("object"!=Ht(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Ht(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Ht(t)?t:t+""}function Wt(e,t,r){return t=Kt(t),function(e,t){if(t&&("object"==Ht(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Vt()?Reflect.construct(t,r||[],Kt(e).constructor):t.apply(e,r))}function Vt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Vt=function(){return!!e})()}function Gt(e,t,r,n){var i=qt(Kt(1&n?e.prototype:e),t,r);return 2&n&&"function"==typeof i?function(e){return i.apply(r,e)}:i}function qt(){return qt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=Kt(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},qt.apply(null,arguments)}function Kt(e){return Kt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Kt(e)}function Yt(e,t){return Yt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Yt(e,t)}const $t=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Wt(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Yt(e,t)}(t,e),r=t,(n=[{key:"preload",value:function(){Gt(t,"preload",this,3)([]),this.game.load.pack("yard","assets/yard.json",null,this),this.game.load.pack("garage","assets/garage.json",null,this),this.subtitles=new et(this.game,"yard",["dutch","english"]),this.subtitles.preload()}},{key:"create",value:function(){var e=this;Gt(t,"create",this,3)([]),this.game.mulle.addAudio("yard"),this.game.mulle.addAudio("garage"),this.subtitles.load(),this.car=null,this.junkParts=null,this.door_side=null,this.door_garage=null,this.game.physics.startSystem(Phaser.Physics.ARCADE),this.game.physics.arcade.gravity.y=800;var r=new x.A(this.game,320,240);r.setDirectorMember("04.DXR",37),this.game.add.existing(r),this.missionSystem=new Xt(this.game);var n,i=this.missionSystem.getPendingMailMission(),o=this.missionSystem.getPendingTelephoneMission();if(n=new Xe(this.game,320,240,i?{imageDefault:["CDDATA.CXT",906],click:function(){e.kickMail(i)}}:{imageDefault:["04.DXR",42],imageHover:["04.DXR",43],soundDefault:"04e009v0",soundHover:"04e010v0",click:function(){e.mulleActor&&e.mulleActor.talk("04d001v0")}}),this.game.add.existing(n),this.mailbox=n,o&&this.kickTelephone(o),this.game.mulle.user.toYardThroughDoor)this.door_side=new Xe(this.game,320,240,{imageDefault:["04.DXR",13],imageHover:["04.DXR",14],soundDefault:"02e015v0",soundHover:"02e016v0",click:function(t){e.game.mulle.activeCutscene="00b011v0",e.game.state.start("garage")}}),this.game.add.existing(this.door_side),this.door_garage=new Xe(this.game,320,240,{imageDefault:["04.DXR",40],imageHover:["04.DXR",41],soundDefault:"02e015v0",soundHover:"02e016v0",click:function(t){e.game.mulle.activeCutscene="00b016v0",e.game.state.start("garage")}}),this.game.add.existing(this.door_garage),this.door_side.cursor="Right",this.door_side.cursorHover="Right",this.door_side.cursorDrag="MoveRight",this.mulleActor=new G(this.game,67,173,"mulleDefault"),this.game.add.existing(this.mulleActor),this.buffaActor=new G(this.game,320,350,"buffa"),this.buffaActor.animations.play("idle"),this.game.add.existing(this.buffaActor),this.game.mulle.actors.buffa=this.buffaActor,this.game.time.events.loop(6e3,function(){var t=Math.random();t>.7?e.buffaActor.animations.play("bark"):t>.4&&e.buffaActor.animations.play("scratch1")}),1===this.game.mulle.user.figgeBeenHere&&(this.game.mulle.user.figgeBeenHere=0,this.mulleActor.talk("04d021v0")),1===this.game.mulle.user.mail&&this.mulleActor.talk("04d020v0");else{var a=new Xe(this.game,320,240,{imageDefault:["04.DXR",16],click:function(t){e.game.mulle.activeCutscene="00b008v0",e.game.mulle.lastSession=null,e.game.mulle.user.Car.resetCache(),e.game.state.start("world")}});this.game.add.existing(a),a.cursor="Click",this.door_side=new x.A(this.game,320,240),this.door_side.setDirectorMember("04.DXR",13),this.game.add.existing(this.door_side),this.door_garage=new Xe(this.game,320,240,{imageDefault:["04.DXR",41],imageHover:["04.DXR",41],click:function(t){e.game.mulle.activeCutscene="00b015v0",e.game.state.start("garage")}}),this.door_garage.hitArea=new Phaser.Rectangle(220,-190,100,240),this.game.add.existing(this.door_garage),this.car=new _e(this.game,368,240,null,!0,!0),this.game.add.existing(this.car)}this.door_garage.cursor="Right",this.door_garage.cursorHover="Right",this.door_garage.cursorDrag="MoveRight",this.junkParts=this.game.add.group(),this.junkParts.pileName="yard";var s=function(t){var r=e.game.mulle.user.Junk.yard[t],n=new we(e.game,t,r.x,r.y);n.junkParts=e.junkParts,n.dropTargets.push([e.door_side,function(r){return r.destroy(),e.game.mulle.user.Junk.shopFloor[t]={x:e.game.rnd.integerInRange(0,640),y:240},e.game.mulle.playAudio("00e004v0"),!0}]),n.dropTargets.push([e.door_garage,function(r){return r.destroy(),e.game.mulle.user.Junk.shopFloor[t]={x:e.game.rnd.integerInRange(0,640),y:240},e.game.mulle.playAudio("00e004v0"),!0}]),e.junkParts.addChild(n)};for(var u in this.game.mulle.user.Junk.yard)s(u);if(this.game.mulle.playAudio("02e010v0"),this.game.mulle.cheats){document.getElementById("cheats").innerHTML="";for(var l=function(){var t=f[c],r=document.createElement("button");r.innerHTML=t,r.className="button",r.addEventListener("click",function(r){e.game.state.start(t,!0,!1,e.key)}),document.getElementById("cheats").appendChild(r)},c=0,f=Object.values(this.game.mulle.scenes);c<f.length;c++)l();var h=document.createElement("button");h.innerHTML="Mail",h.className="button",h.addEventListener("click",function(){e.game.mulle.user.mail=1,console.log("Set mail to 1")}),document.getElementById("cheats").appendChild(h)}console.log("Yard","through door")}},{key:"kickTelephone",value:function(e){var t=this;console.log("kickTelephone:",e),this.phoneSmall=new x.A(this.game,50,50),this.phoneSmall.setDirectorMember("03.DXR",20),this.game.add.existing(this.phoneSmall),this.tmpLoc={x:50,y:50},this.currentSound=this.game.mulle.playAudio("03e001v0"),this.frameCount=0,this.currentMission=e,this.shakeTimer=this.game.time.events.loop(100,function(){t.frameCount++,t.currentSound&&!t.currentSound.isPlaying?t.finishPhone():t.frameCount%2==0?t.phoneSmall.x=t.tmpLoc.x-2:t.phoneSmall.x=t.tmpLoc.x+2})}},{key:"finishPhone",value:function(){var e=this;console.log("finishPhone"),this.shakeTimer&&this.game.time.events.remove(this.shakeTimer),this.phoneSmall&&(this.phoneSmall.x=this.tmpLoc.x,this.phoneSmall.destroy()),this.phoneBig=new x.A(this.game,320,240),this.phoneBig.setDirectorMember("03.DXR",73),this.game.add.existing(this.phoneBig),this.currentMission&&this.currentMission.sound&&(this.currentSound=this.game.mulle.playAudio(this.currentMission.sound,function(){e.hangUp()}))}},{key:"hangUp",value:function(){console.log("hangUp"),this.phoneBig&&this.phoneBig.destroy(),this.missionSystem.markAsGiven(this.currentMission.id),this.game.mulle.user.missionIsComing=0,this.currentMission=null}},{key:"kickMail",value:function(e){var t=this;console.log("kickMail:",e),this.missionSystem.markAsGiven(e.id),this.game.mulle.user.missionIsComing=0,e.image&&(this.mailOverlay=new x.A(this.game,320,240),this.mailOverlay.setDirectorMember("CDDATA.CXT",1100),this.game.add.existing(this.mailOverlay)),e.sound&&(this.currentSound=this.game.mulle.playAudio(e.sound,function(){t.finishMail()})),this.mailClickFinish=this.game.input.onDown.add(function(){t.currentSound&&!t.currentSound.isPlaying&&t.finishMail()})}},{key:"finishMail",value:function(){console.log("finishMail"),this.mailOverlay&&(this.mailOverlay.destroy(),this.mailOverlay=null),this.mailbox&&this.mailbox.setDirectorMember("04.DXR",42),this.mailClickFinish&&(this.game.input.onDown.remove(this.mailClickFinish),this.mailClickFinish=null)}},{key:"shutdown",value:function(){var e=this;this.game.mulle.stopAudio("02e010v0"),console.log("shutdown yard"),this.game.mulle.user.Junk.yard={},this.junkParts.forEach(function(t){e.game.mulle.user.Junk.yard[t.part_id]={x:t.x,y:t.y}}),this.game.mulle.user.save(),Gt(t,"shutdown",this,3)([])}}])&&Ut(r.prototype,n),i&&Ut(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(N);function Qt(e){return Qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qt(e)}function zt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Zt(n.key),n)}}function Zt(e){var t=function(e,t){if("object"!=Qt(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Qt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Qt(t)?t:t+""}const er=function(){return e=function e(t,r,n,i,o){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"serif";!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.input=document.createElement("input"),this.input.style.position="absolute",this.input.style.top="".concat(n,"px"),this.input.style.left="".concat(r,"px"),this.input.style.border="none",this.input.style.font="".concat(o,"px ").concat(a),this.input.style.background="none",this.input.style.width="".concat(i,"px"),this.input.addEventListener("keyup",function(e){13===e.keyCode&&console.log("Enter pressed")}),document.getElementById("player").appendChild(this.input)},(t=[{key:"text",value:function(e){this.input.value=e}},{key:"value",value:function(){return this.input.value}},{key:"type",value:function(e){this.input.setAttribute("type",e),this.input.setAttribute("accept","*.car")}},{key:"id",value:function(e){this.input.setAttribute("id",e)}},{key:"onChange",value:function(e){this.input.addEventListener("change",e)}},{key:"remove",value:function(){document.getElementById("player").removeChild(this.input)}}])&&zt(e.prototype,t),r&&zt(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}();function tr(e){return tr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tr(e)}function rr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nr(n.key),n)}}function nr(e){var t=function(e,t){if("object"!=tr(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=tr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==tr(t)?t:t+""}function ir(e,t,r){return t=sr(t),function(e,t){if(t&&("object"==tr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,or()?Reflect.construct(t,r||[],sr(e).constructor):t.apply(e,r))}function or(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(or=function(){return!!e})()}function ar(){return ar="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=sr(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},ar.apply(null,arguments)}function sr(e){return sr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},sr(e)}function ur(e,t){return ur=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ur(e,t)}const lr=function(e){function t(e,r){var n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(n=ir(this,t,[e,320,240,"",""])).callback=r,n.setDirectorMember("13.DXR",32),n.leftPoint=n.x-n.width/2,n.topPoint=n.y-n.height/2,n.input_path=new er(n.game,n.leftPoint+14,n.topPoint+7,302,12),n.input_file=new er(n.game,170,n.topPoint+228,n.leftPoint+65,24),n.input_file.type("file"),n.input_file.id("file"),n.input_file.input.setAttribute("accept","*.car"),n.buttonOk=n.relativeRectangleButton(263,209,64,32,{click:function(){var e=n.input_file.input.files[0],t=new FileReader;t.onload=function(e){n.callback(e.target.result),n.destroy()},t.readAsText(e)}}),n.game.add.existing(n.buttonOk),n.buttonClose=n.relativeRectangleButton(278,241,31,36,{click:function(){n.destroy(!0)}}),n.game.add.existing(n.buttonClose),n.buttonUp=n.relativeRectangleButton(274,32,17,27,{click:function(){n.scrollUp()}}),n.game.add.existing(n.buttonUp),n.buttonDown=n.relativeRectangleButton(274,184,17,27,{click:function(){n.scrollDown()}}),n.game.add.existing(n.buttonDown),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ur(e,t)}(t,e),r=t,n=[{key:"relativeRectangleButton",value:function(e,t,r,n,i){return Xe.fromRectangle(this.game,this.leftPoint+e,this.topPoint+t,r,n,i)}},{key:"scrollUp",value:function(){console.log("Scroll up")}},{key:"scrollDown",value:function(){console.log("Scroll down")}},{key:"destroy",value:function(e){var r,n,i,o,a;document.getElementById("player").removeChild(this.input_path.input),document.getElementById("player").removeChild(this.input_file.input),(r=t,n="destroy",i=this,a=ar(sr(1&(o=3)?r.prototype:r),n,i),2&o&&"function"==typeof a?function(e){return a.apply(i,e)}:a)([e])}}],n&&rr(r.prototype,n),i&&rr(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(x.A);function cr(e){return cr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cr(e)}function fr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hr(n.key),n)}}function hr(e){var t=function(e,t){if("object"!=cr(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=cr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==cr(t)?t:t+""}const mr=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.game=t,this.game.mulle.user.savedCars||(this.game.mulle.user.savedCars=[])}return t=e,r=[{key:"saveCar",value:function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";console.log("Save car to page ".concat(e)),this.game.mulle.user.savedCars[e]={parts:t,medals:r,name:n},this.game.mulle.user.save()}},{key:"saveCurrentCar",value:function(e){this.saveCar(e,this.game.mulle.user.Car.Parts,this.game.mulle.user.Car.Medals,this.game.mulle.user.Car.Name)}},{key:"loadCar",value:function(e){if(!this.isSaved(e))throw new Error("No car saved on page "+e);console.log(this.game.mulle.user.savedCars[e]),"parts"in this.game.mulle.user.savedCars[e]||this.saveCar(e,this.game.mulle.user.savedCars[e],[]);var t=this.game.mulle.user.savedCars[e];return[t.parts,t.medals,t.name]}},{key:"importCar",value:function(t,r){var n=e.parseOriginalGame(r),i=n.parts,o=n.name,a=n.medals;this.saveCar(t,i,a,o)}},{key:"isSaved",value:function(e){return e in this.game.mulle.user.savedCars}}],n=[{key:"parseOriginalGame",value:function(e){return e=(e=(e="{"+(e=e.replace(/#([a-zA-Z0-9]+):/g,'"$1":')).substring(1,e.length-1)+"}").replace("[:]","[]")).replace(/("cacheList": )\[(.+)]/,"$1{$2}"),console.log(e),JSON.parse(e)}}],r&&fr(t.prototype,r),n&&fr(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r,n}();function dr(e){return dr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dr(e)}function pr(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=gr(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function yr(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,s=[],u=!0,l=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||gr(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function gr(e,t){if(e){if("string"==typeof e)return vr(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?vr(e,t):void 0}}function vr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function br(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wr(n.key),n)}}function wr(e){var t=function(e,t){if("object"!=dr(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=dr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==dr(t)?t:t+""}function Pr(e,t,r){return t=jr(t),function(e,t){if(t&&("object"==dr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,kr()?Reflect.construct(t,r||[],jr(e).constructor):t.apply(e,r))}function kr(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(kr=function(){return!!e})()}function Sr(e,t,r,n){var i=Or(jr(1&n?e.prototype:e),t,r);return 2&n&&"function"==typeof i?function(e){return i.apply(r,e)}:i}function Or(){return Or="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=jr(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},Or.apply(null,arguments)}function jr(e){return jr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},jr(e)}function Dr(e,t){return Dr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Dr(e,t)}const Ar=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Pr(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Dr(e,t)}(t,e),r=t,n=[{key:"positionSprite",value:function(e,t){var r=this.game.mulle.getDirectorImage(e,t),n=320-r.frame.regpoint.x,i=240-r.frame.regpoint.y;return new Phaser.Sprite(this.game,n,i,r.key,r.name)}},{key:"init",value:function(e){this.mode=e}},{key:"preload",value:function(){this.DirResource="06.DXR",Sr(t,"preload",this,3)([]),this.game.load.pack("album","assets/album.json",null,this),this.game.load.pack("fileBrowser","assets/fileBrowser.json",null,this)}},{key:"buildPages",value:function(){for(var e,t=this,r=function(r){if(e=t.loadSave.isSaved(r)?t.positionSprite(t.DirResource,r+60):t.positionSprite(t.DirResource,r+48),r===t.selectedPage)t.pagenumSpriteSelected&&t.pagenumSpriteSelected.destroy(),t.pagenumSpriteSelected=t.positionSprite(t.DirResource,r+72),t.game.add.existing(t.pagenumSpriteSelected);else{var n=Xe.fromRectangle(t.game,e.x,e.y,40,40,{click:function(){t.setPage(r)}});t.game.add.existing(n)}t.game.add.existing(e)},n=1;n<=12;n++)r(n)}},{key:"setPage",value:function(e){this.selectedPage=e,this.game.mulle.playAudio("06e003v0"),this.showSavedCar(e),this.buildPages()}},{key:"albumCar",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.albumCarImage&&this.albumCarImage.destroy(),this.albumCarImage=new _e(this.game,320,240,e,!0,!1),this.background_layer.add(this.albumCarImage)}},{key:"showPasteFrame",value:function(){var e=this;this.imageFrame=new Xe(this.game,67,401,{imageDefault:[this.DirResource,159],click:function(){e.pasteCar()}}),this.game.add.existing(this.imageFrame),this.pasting_car=new _e(this.game,0,400,null,!0,!1),this.pasting_car.height=this.pasting_car.height/2,this.pasting_car.width=this.pasting_car.width/2,this.game.add.existing(this.pasting_car)}},{key:"pasteCar",value:function(){this.imageFrame.destroy(),this.imageFrame.displaySprite.visible=!1,this.pasting_car.destroy(),this.albumCar(),this.game.mulle.user.Car.Name=this.carName.value(),this.loadSave.saveCurrentCar(this.selectedPage)}},{key:"buildSavedCar",value:function(e){var t,r,n=yr(this.loadSave.loadCar(e),3),i=n[0],o=n[1],a=n[2],s=pr(this.game.mulle.user.Car.Parts);try{for(s.s();!(r=s.n()).done;)(t=r.value)in i||(this.game.mulle.PartsDB[t].master&&(t=this.game.mulle.PartsDB[t].master),this.game.mulle.user.addPart("Pile1",t,null,!0))}catch(e){s.e(e)}finally{s.f()}this.removeParts(i),this.game.mulle.user.Car.Parts=[];var u,l=pr(i);try{for(l.s();!(u=l.n()).done;)t=u.value,this.game.mulle.user.Car.Parts.push(t)}catch(e){l.e(e)}finally{l.f()}this.game.mulle.user.Car.Medals=o,this.game.mulle.user.Car.Name=a,this.game.mulle.user.Car.updateStats(),this.close()}},{key:"showSavedCar",value:function(e){if(this.loadSave.isSaved(e)){var t=yr(this.loadSave.loadCar(e),3),r=t[0],n=t[1],i=t[2];this.albumCar(r),this.parts=r,this.carName.text(i),this.showMedals(n),"load"===this.mode&&this.fetchButton.show()}else this.albumCarImage&&this.albumCarImage.destroy(),"load"===this.mode&&this.fetchButton.hide(),this.medals&&this.medals.destroy(!0)}},{key:"removePart",value:function(e){for(var t in this.game.mulle.PartsDB[e].master&&(e=this.game.mulle.PartsDB[e].master),this.game.mulle.user.Junk)e in this.game.mulle.user.Junk[t]&&(console.log("Remove part ".concat(e," from ").concat(t)),delete this.game.mulle.user.Junk[t][e])}},{key:"removeParts",value:function(e){var t,r=pr(e);try{for(r.s();!(t=r.n()).done;){var n=t.value;this.removePart(n)}}catch(e){r.e(e)}finally{r.f()}}},{key:"importCar",value:function(){var e=this;this.browser=new lr(this.game,function(t){e.loadSave.importCar(e.selectedPage,t),e.showSavedCar(e.selectedPage)}),this.album_ui.add(this.browser)}},{key:"showMedals",value:function(e){this.medals&&this.medals.destroy(!0),this.medals=this.game.add.group();var t,r=1,n=pr(e);try{for(n.s();!(t=n.n()).done;){var i=t.value,o=this.game.mulle.getDirectorImage(this.DirResource,20+i),a=o.key,s=o.frame,u=new Phaser.Sprite(this.game,550,55*r,a,s.name);this.medals.add(u),r++}}catch(e){n.e(e)}finally{n.f()}}},{key:"create",value:function(){var e=this;this.game.mulle.addAudio("album"),Sr(t,"create",this,3)([]),this.loadSave=new mr(this.game),this.background_layer=this.game.add.group(),this.album_ui=this.game.add.group(),this.background=new x.A(this.game,320,240),this.background.setDirectorMember(this.DirResource,93),this.background_layer.add(this.background),this.name_input=Pt.A.sprite(this.game,210,427,this.DirResource,101,!1,!1),this.album_ui.add(this.name_input),this.carName=new er(this.game,this.name_input.x+5,this.name_input.y+5,203,20),this.carName.id("car_name"),"save"===this.mode?(this.game.mulle.playAudio("06e002v0",function(){e.game.mulle.playAudio("06d001v0")}),this.showPasteFrame(),this.export_button=new Xe(this.game,487,413,{imageDefault:["06.DXR",164],click:function(){console.warn("Export car not implemented")}}),this.game.add.existing(this.export_button)):(this.game.mulle.playAudio("07d001v0"),this.fetchButton=new Xe(this.game,76,400,{imageDefault:[this.DirResource,162],click:function(){e.buildSavedCar(e.selectedPage)}}),this.album_ui.add(this.fetchButton),this.carName.input.readOnly=!0,this.importButton=new Xe(this.game,487,413,{imageDefault:["06.DXR",161],click:function(){e.importCar()}}),this.album_ui.add(this.importButton)),this.close_button=new Xe(this.game,554,414,{imageDefault:["06.DXR",153],click:function(){console.log("Close album"),e.close()}}),this.album_ui.add(this.close_button),this.setPage(1)}},{key:"close",value:function(){this.game.state.start("garage")}},{key:"shutdown",value:function(e){this.cutscene=83,this.carName.remove(),Sr(t,"shutdown",this,3)([e])}}],n&&br(r.prototype,n),i&&br(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(N);function Cr(e){return Cr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Cr(e)}function xr(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Rr(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Rr(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function Rr(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function _r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Tr(n.key),n)}}function Tr(e){var t=function(e,t){if("object"!=Cr(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Cr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Cr(t)?t:t+""}function Er(e,t,r){return t=Br(t),function(e,t){if(t&&("object"==Cr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Mr()?Reflect.construct(t,r||[],Br(e).constructor):t.apply(e,r))}function Mr(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Mr=function(){return!!e})()}function Ir(){return Ir="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=Br(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},Ir.apply(null,arguments)}function Br(e){return Br=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Br(e)}function Nr(e,t){return Nr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Nr(e,t)}const Lr=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Er(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Nr(e,t)}(t,e),r=t,n=[{key:"init",value:function(e){this.previousState=e}},{key:"preload",value:function(){var e,r,n,i,o;this.DirResource="08.DXR",(e=t,r="preload",n=this,o=Ir(Br(1&(i=3)?e.prototype:e),r,n),2&i&&"function"==typeof o?function(e){return o.apply(n,e)}:o)([]),this.game.load.pack("diploma","assets/diploma.json",null,this),this.load.json("strings","assets/diploma-strings.json")}},{key:"create",value:function(){console.log("Previous state",this.previousState),this.scroll_level=0,this.whiteLayer=this.add.group(),this.background_layer=this.game.add.group(),this.ui_layer=this.game.add.group(),this.scroll_layer=this.game.add.group(),this.header=Pt.A.sprite(this.game,14,2,this.DirResource,71,!1,!1),this.scroll_layer.add(this.header),this.rightMenuRectangle=new Phaser.Rectangle(0,-9,587,503),this.wood=Pt.A.sprite(this.game,614,240,this.DirResource,15),this.ui_layer.add(this.wood),this.upButton=Pt.A.button(this.game,612,20,this.scrollUp,this,this.DirResource,17,17,!0),this.ui_layer.add(this.upButton),this.downButton=Pt.A.button(this.game,612,186,this.scrollDown,this,this.DirResource,18,18,!0),this.ui_layer.add(this.downButton),this.printButton=Pt.A.button(this.game,612,378,function(){console.log("print")},this,this.DirResource,67,67,!0),this.ui_layer.addChild(this.printButton),this.closeButton=Pt.A.button(this.game,611,441,this.close,this,this.DirResource,68,68,!0),this.ui_layer.add(this.closeButton);var e=this.add.graphics(0,0,this.whiteLayer);e.beginFill(16777215),e.drawRect(572,0,13,479),e.drawRect(52,100,518,368),e.drawRect(0,0,587,503);var t=this.game.cache.getJSON("strings");this.userName=new Phaser.Text(this.game,0,0,this.game.mulle.user.UserId,{font:"36pt Arial",boundsAlignH:"center",boundsAlignV:"center"}),this.userName.setTextBounds(150,this.header.height+this.header.y-6,303,43),this.scroll_layer.add(this.userName),this.forCarText=new Phaser.Text(this.game,0,0,t[this.DirResource][69],{font:"24pt Arial",boundsAlignH:"center",boundsAlignV:"center"}),this.forCarText.setTextBounds(150,this.header.height+this.header.y+36,303,29),this.scroll_layer.addChild(this.forCarText),this.carName=new Phaser.Text(this.game,0,0,this.game.mulle.user.Car.Name,{font:"36pt Arial",boundsAlignH:"center",boundsAlignV:"center"}),this.carName.setTextBounds(150,this.header.height+this.header.y+56,303,44),this.scroll_layer.add(this.carName),this.carImageRectangle=new Phaser.Rectangle(52,this.header.height+this.header.y+100,518,368),this.carImage=new _e(this.game,this.carImageRectangle.centerX,this.carImageRectangle.centerY,null,!0),this.scroll_layer.add(this.carImage),this.medals=this.game.add.group(this.scroll_layer);var r,n=32,i=xr(this.game.mulle.user.Car.Medals);try{for(i.s();!(r=i.n()).done;){var o=r.value,a=this.game.mulle.getDirectorImage(this.DirResource,20+o),s=a.key,u=a.frame,l=new Phaser.Sprite(this.game,n,623,s,u.name);this.medals.add(l),l.width=60,l.height=60,n=l.right+40;var c=new Phaser.Text(this.game,0,0,t[this.DirResource][80+o],{font:"11pt Times New Roman",boundsAlignH:"center",boundsAlignV:"center",wordWrap:!0,wordWrapWidth:l.width});console.log(l),c.setTextBounds(l.x,l.bottom+10,l.width,40),this.medals.add(c)}}catch(e){i.e(e)}finally{i.f()}var f=this.add.graphics(0,0,this.scroll_layer);f.beginFill(0);var h=f.drawRect(12,2,2,777);f.drawRect(572,2,2,777),this.bottom=Pt.A.sprite(this.game,14,h.bottom-39,this.DirResource,70,!1,!1),this.scroll_layer.add(this.bottom)}},{key:"scrollUp",value:function(){this.scroll_level>0&&(this.scroll_layer.forEach(function(e){e.y=e.y+200}),this.scroll_level--)}},{key:"scrollDown",value:function(){this.scroll_level<2&&(this.scroll_layer.forEach(function(e){e.y=e.y-200}),this.scroll_level++)}},{key:"close",value:function(){this.game.state.start(this.previousState)}}],n&&_r(r.prototype,n),i&&_r(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(N);function Fr(e){return Fr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fr(e)}function Xr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Hr(n.key),n)}}function Hr(e){var t=function(e,t){if("object"!=Fr(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Fr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Fr(t)?t:t+""}function Ur(e,t,r){return t=Vr(t),function(e,t){if(t&&("object"==Fr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Jr()?Reflect.construct(t,r||[],Vr(e).constructor):t.apply(e,r))}function Jr(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Jr=function(){return!!e})()}function Wr(){return Wr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=Vr(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},Wr.apply(null,arguments)}function Vr(e){return Vr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Vr(e)}function Gr(e,t){return Gr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Gr(e,t)}const qr=function(e){function t(e){var r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=Ur(this,t,[e])).DirResource="05.DXR",r.setDirectorMember("05.DXR",121),r.spriteFrames={"-2":{},"-1":{},0:{},1:{},2:{}};for(var n=0;n<16;n++)r.spriteFrames[-2][n+1]=r.game.mulle.getDirectorImage("05.DXR",78+n).name;for(n=0;n<16;n++)r.spriteFrames[-1][n+1]=r.game.mulle.getDirectorImage("05.DXR",94+n).name;for(n=0;n<16;n++)r.spriteFrames[0][n+1]=r.game.mulle.getDirectorImage("05.DXR",110+n).name;for(n=0;n<16;n++)r.spriteFrames[1][n+1]=r.game.mulle.getDirectorImage("05.DXR",126+n).name;for(n=0;n<16;n++)r.spriteFrames[2][n+1]=r.game.mulle.getDirectorImage("05.DXR",142+n).name;r.speed=0,r.direction=0,r.altitude=0,r.inclination=0,r.stopTimer=0,r.acceleration=0,r.reachForSpeed=0,r.Steering=0,r.forwardBackward=0,r.lastPosition=new Phaser.Point(0,0),r.previousData=[];for(n=0;n<10;n++)r.previousData.push([new Phaser.Point(0,0),1]);r.OutOfBounds=0,r.internalDirection=0,r.nrOfDirections=16,r.keySteer=1,r.mapOffset=new Phaser.Point(4,2),r.directionList=[];for(n=1;n<=r.nrOfDirections;n++){var i=2*Math.PI*n/r.nrOfDirections,o=Math.sin(i),a=-Math.cos(i);r.directionList.push(new Phaser.Point(o,a))}r.wheelPositions=[];for(n=1;n<=r.directionList.length;n++){var s=8*r.directionList[n-1].x,u=8*r.directionList[n-1].y;r.wheelPositions.push(new Phaser.Point(s,u))}return r.setDirection(1),r.cursors=r.game.input.keyboard.createCursorKeys(),r.wasd=r.game.input.keyboard.addKeys({up:Phaser.KeyCode.W,down:Phaser.KeyCode.S,left:Phaser.KeyCode.A,right:Phaser.KeyCode.D}),r.logicLoop=r.game.time.events.loop(Phaser.Timer.SECOND/30,r.drive,r),r.game.physics.enable(r,Phaser.Physics.ARCADE),r.engineSounds=[["05e073v0","05e079v0","05e074v0","05e075v0","05e076v0","05e077v0","05e078v0"],["05e067v0","05e073v0","05e068v0","05e069v0","05e070v0","05e071v0","05e072v0"],["05e025v0","05e031v0","05e026v0","05e027v0","05e028v0","05e029v0","05e030v0"],["05e004v0","05e010v0","05e005v0","05e006v0","05e007v0","05e008v0","05e009v0"],["05e011v0","05e017v0","05e012v0","05e013v0","05e014v0","05e015v0","05e016v0"],["05e053v0","05e059v0","05e054v0","05e055v0","05e056v0","05e057v0","05e058v0"],["05e018v0","05e024v0","05e019v0","05e020v0","05e021v0","05e022v0","05e023v0"],["05e060v0","05e066v0","05e061v0","05e062v0","05e063v0","05e064v0","05e065v0"],["05e032v0","05e038v0","05e033v0","05e034v0","05e035v0","05e036v0","05e037v0"]],r.hornSounds=["05e050v0","05e049v0","05e044v0","05e042v0","05d013v0"],r.ignition=!1,r.limitList=[10,20,40,70],r.lastSpeed=-1,r.setEngineSound(),r.fuelMax=r.getQuickProperty("fuelvolume"),r.fuelCurrent=.8*r.fuelMax,r.maxAcc=r.getQuickProperty("break"),r.maxAcc<r.getQuickProperty("acceleration")&&(r.maxAcc=r.getQuickProperty("acceleration")),r.enabled=!0,r.memeMode=!1,r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Gr(e,t)}(t,e),r=t,n=[{key:"enableMemeMode",value:function(){this.body.drag.set(10),this.body.maxVelocity.set(30*this.getQuickProperty("speed")),this.body.maxAngular=500,this.body.angularDrag=500,this.body.velocity.x=0,this.body.velocity.y=0,this.body.allowRotation=!1,this.memeMode=!0}},{key:"getProperty",value:function(e){return this.game.mulle.user.Car.getProperty(e.toLowerCase())}},{key:"getQuickProperty",value:function(e){return this.game.mulle.user.Car.getQuickProperty(e.toLowerCase())}},{key:"setEngineSound",value:function(){var e=this.getProperty("enginetype",1),t=this.getProperty("speed",0),r=Math.abs(this.speed)/t*100;if(e){var n=0;if(this.ignition?r>=70?n=6:r>=40?n=5:r>=20?n=4:r>=10?n=3:r<10&&(n=2):(this.ignition=!0,n=0),this.lastSpeed===n)return;var i=this.engineSounds[e-1];this.engineAudio&&(this.engineAudio.stop(),this.engineAudio=null),this.engineAudio=this.game.mulle.playAudio(i[n]),this.lastSpeed=n}else console.error("no engine type")}},{key:"correctDirection",value:function(e){return e>this.nrOfDirections?e-this.nrOfDirections:e<1?e+this.nrOfDirections:e}},{key:"updatePivot",value:function(){this._frame?this._frame.regpoint?(this.regPoint.set(this._frame.regpoint.x,this._frame.regpoint.y+3*this.altitude),this.pivot.set(this.regPoint.x,this.regPoint.y)):console.warn("no regpoint",this._frame,this.key,this._frame.name):console.warn("no frame")}},{key:"setCoordinate",value:function(e){this.position.set(e.x,e.y)}},{key:"getCoordinate",value:function(){return this.position}},{key:"setDirection",value:function(e){this.direction=this.correctDirection(e),this.internalDirection=100*this.direction,this.updateImage()}},{key:"setSpeed",value:function(e){this.reachForSpeed=0,this.acceleration=0,this.speed=e,this.speed>0?this.forwardBackward=1:this.speed<0?this.forwardBackward=-1:this.forwardBackward=0}},{key:"changeSpeed",value:function(e){this.acceleration=e,this.reachForSpeed=0}},{key:"destroy",value:function(){var e,r,n,i,o;this.engineAudio&&(this.engineAudio.stop(),this.engineAudio=null),this.game.time.events.remove(this.logicLoop),(e=t,r="destroy",n=this,o=Wr(Vr(1&(i=3)?e.prototype:e),r,n),2&i&&"function"==typeof o?function(e){return o.apply(n,e)}:o)([])}},{key:"updateImage",value:function(){if(this.spriteFrames[this.inclination]){var e=this.spriteFrames[this.inclination][this.direction];this.frameName=e}else console.error("invalid inclination",this.inclination)}},{key:"drive",value:function(){var e=this;if(this.enabled)if(this.fuelCurrent<=0)this.enabled=!1,this.engineAudio&&this.engineAudio.stop(),this.game.mulle.playAudio("05d011v0").onStop.addOnce(function(){setTimeout(function(){e.game.state.start("garage")},500)});else if(this.OutOfBounds>5){for(var t=0;t<4;t++){var r=this.position.clone();if(0===t&&(r.y-=this.OutOfBounds),1===t&&(r.x+=this.OutOfBounds),2===t&&(r.y+=this.OutOfBounds),3===t&&(r.x-=this.OutOfBounds),this.pixelCheck(r)<240)return this.position.set(r.x,r.y),void(this.OutOfBounds=0)}this.OutOfBounds++}else{if(this.keySteer&&(this.cursors.up.isDown||this.wasd.up.isDown?this.changeSpeed(1):this.cursors.down.isDown||this.wasd.down.isDown?this.changeSpeed(-1):this.changeSpeed(0),this.cursors.left.isDown||this.wasd.left.isDown?this.Steering=-1:this.cursors.right.isDown||this.wasd.right.isDown?this.Steering=1:this.Steering=0),this.calculateSpeed(),this.Steering&&(this.memeMode?(this.body.velocity.rotate(0,0,10*this.Steering,!0),this.internalDirection=Math.round(100*this.nrOfDirections/this.body.angle),console.log(this.internalDirection,this.direction)):this.internalDirection+=this.Steering*this.getQuickProperty("steering"),this.internalDirection>100*this.nrOfDirections?this.internalDirection-=100*this.nrOfDirections:this.internalDirection<=0&&(this.internalDirection=100*this.nrOfDirections+this.internalDirection),this.direction=this.correctDirection(Math.round(this.internalDirection/100))),this.speed){for(var n=0;n<=1;n++){var i=0===n?-1:1,o=1===this.forwardBackward?7+this.speed:-3,a=this.directionList[this.correctDirection(this.direction+i)-1].clone();if(a.multiply(o,o),(r=this.position.clone()).add(a.x,a.y),this.pixelCheck(r)>=240){this.setDirection(this.direction-i),this.speed=.9*this.speed,this.speed<.1&&this.speed>-.1&&(this.speed=0);break}}var s=this.directionList[this.direction-1];if(this.memeMode);else{var u=this.position.clone();u.x+=s.x*this.speed,u.y+=s.y*this.speed;var l=this.pixelCheck(u);if(l>=240)console.warn("hit wall",u,l),this.setSpeed(0),this.OutOfBounds++;else{var c=!0,f=l%16;if(f>2?(f=2,this.game.mulle.user.Car.criteria.BigHill||(console.log("big hill check"),c=!1,this.speed=0)):f>1&&(this.game.mulle.user.Car.criteria.SmallHill||(console.log("small hill check"),c=!1,this.speed=0)),32===l)if(this.game.mulle.user.Car.criteria.MudGrip){if(!this.game.mulle.user.Car.hasMedal(3)){this.game.mulle.user.Car.addMedal(3);var h=Pt.A.sprite(this.game,16,420,this.DirResource,71,!1,!1);this.game.add.existing(h)}}else console.log("mud"),c=!1,this.speed=0,this.SoundMud||(this.game.mulle.playAudio("05d003v0").onStop.addOnce(function(){e.SoundMud=null}),this.SoundMud=!0);16===l&&(this.game.mulle.user.Car.criteria.HolesDurability||(console.log("rocks"),c=!1,this.speed=0,this.SoundRocks||(this.game.mulle.playAudio("05d002v0").onStop.addOnce(function(){e.SoundRocks=null}),this.SoundRocks=!0))),c&&(this.altitude=f,this.lastPosition.set(this.position.x,this.position.y),this.position.set(u.x,u.y))}}this.fuelCurrent-=Math.abs(this.speed)*this.getQuickProperty("fuelconsumption")/100}this.setEngineSound();var m=this.checkBorders(this.direction,this.forwardBackward);m&&(console.log(m),console.log("Change map"),-1===m.x&&(this.position.x=631),1===m.x&&(this.position.x=12),-1===m.y&&(this.position.y=395),1===m.y&&(this.position.y=12),this.state.changeMap(m)),this.state.mapObjects.forEach(function(t){if(t.enabled&&t.def){var r=e.position.distance(t.position),n=r<=t.InnerRadius/2;r<=t.OuterRadius/2?t.enteredOuter||(t.enteredOuter=!0,t.onEnterOuter(e)):t.enteredOuter&&(t.enteredOuter=!1,t.onExitOuter(e)),n?t.enteredInner||(t.enteredInner=!0,t.onEnterInner(e)):t.enteredInner&&(t.enteredInner=!1,t.onExitInner(e))}}),this.previousData.push([this.position.clone(),this.direction]),this.previousData.splice(0,1),this.updateImage()}}},{key:"collisionHandler",value:function(e,t){console.log(e,t)}},{key:"checkBorders",value:function(e,t){var r=this.getCoordinate().clone();if(r.subtract(this.mapOffset.x,this.mapOffset.y),r.divide(2,2),1===t){var n=this.wheelPositions[Math.abs(e)-1];r.add(n.x,n.y)}return r.x<3?new Phaser.Point(-1,0):r.x>314?new Phaser.Point(1,0):r.y<3?new Phaser.Point(0,-1):r.y>196?new Phaser.Point(0,1):0}},{key:"calculateSpeed",value:function(){if(this.stopTimer>0&&this.stopTimer--,this.acceleration)if(this.memeMode)this.game.physics.arcade.accelerationFromRotation(this.body.angle,50*this.acceleration,this.body.acceleration);else{if(0===this.stopTimer){var e=0;0===this.forwardBackward||this.forwardBackward===this.acceleration?e=this.acceleration*this.getQuickProperty("acceleration"):(e=this.acceleration*this.getQuickProperty("break"),Math.abs(this.speed)<=this.maxAcc&&(this.speed=0,this.stopTimer=10,e=0));var t=this.getQuickProperty("speed",0);this.speed<=t&&this.speed>=-t/2&&(this.speed+=e),this.speed>t?this.speed=t:this.speed<-t/4&&(this.speed=-t/4)}this.speed>0?this.forwardBackward=1:this.speed<0?this.forwardBackward=-1:this.forwardBackward=0}else this.memeMode&&this.body.acceleration.set(0)}},{key:"pixelCheck",value:function(e){var t=Math.round((e.x-4)/2),r=Math.round((e.y-2)/2);return t<0||r<0||t>=316||r>=198?(console.error("pixel check out of bounds"),0):this.topology.getPixel(t,r).r}},{key:"stepback",value:function(e){console.log("stepback",e);var t=this.previousData[this.previousData.length-1-e];this.position.set(t[0].x,t[0].y),this.direction=t[1]}}],n&&Xr(r.prototype,n),i&&Xr(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(x.A);var Kr=r(702);function Yr(e){return Yr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Yr(e)}function $r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Qr(n.key),n)}}function Qr(e){var t=function(e,t){if("object"!=Yr(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Yr(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Yr(t)?t:t+""}function zr(e,t,r){return t=tn(t),function(e,t){if(t&&("object"==Yr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Zr()?Reflect.construct(t,r||[],tn(e).constructor):t.apply(e,r))}function Zr(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Zr=function(){return!!e})()}function en(){return en="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=tn(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},en.apply(null,arguments)}function tn(e){return tn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},tn(e)}function rn(e,t){return rn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},rn(e,t)}var nn={};["Cows","Ferry","Gas","Racing","Goats","WBridge","CBridge","FarAway","Picture","Hill","Stop","Sound","Teleport"].forEach(function(e){nn[e]=r(212)("./"+e).default});const on=function(e){function t(e,r,n,i){var o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(o=zr(this,t,[e])).id=r,o.position.set(n.x,n.y),o.opt=i,o.optionalData=i,o.enteredInner=!1,o.enteredOuter=!1,o.enabled=!0,o.def=o.game.mulle.ObjectsDB[o.id],o.OuterRadius=o.opt&&o.opt.OuterRadius?o.opt.OuterRadius:o.def.OuterRadius,o.InnerRadius=o.opt&&o.opt.InnerRadius?o.opt.InnerRadius:o.def.InnerRadius,o.CustomObject=o.def.CustomObject,o.Sounds=o.def.Sounds,o.FrameList=o.def.FrameList,o.SetWhenDone=o.def.SetWhenDone,o.CheckFor=o.def.CheckFor,o.IfFound=o.def.IfFound,o.SpriteInfo=o.def.SpriteInfo?o.def.SpriteInfo:{},o.animationHelper=new Kr.default(o),o.outer=new Phaser.Circle(o.x,o.y,o.OuterRadius),o.inner=new Phaser.Circle(o.x,o.y,o.InnerRadius),o.CustomObject&&Object.assign(o,nn[o.CustomObject]),o.onCreate(),o.id,o.def,o.opt,o}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&rn(e,t)}(t,e),r=t,n=[{key:"collide",value:function(e){}},{key:"setFrameList",value:function(e,t){var r;this.def.FrameList[1]?(t||(t="1"),this.def.FrameList[t][e]&&"Dummy"!==(r=this.def.FrameList[t][e][0])&&this.setDirectorMember(r)):this.def.FrameList[e]&&"Dummy"!==(r=this.def.FrameList[e][0])&&this.setDirectorMember(r)}},{key:"onCreate",value:function(){this.custom&&this.custom.onCreate?this.custom.onCreate.call(this):this.def.FrameList&&"object"===Yr(this.def.FrameList)&&(this.opt&&this.opt.Show?this.setFrameList("normal",this.opt.Show):this.setFrameList("normal"))}},{key:"onEnterOuter",value:function(e){this.custom&&this.custom.onEnterOuter&&this.custom.onEnterOuter.call(this,e)}},{key:"onExitOuter",value:function(e){this.custom&&this.custom.onExitOuter&&this.custom.onExitOuter.call(this,e)}},{key:"onEnterInner",value:function(e){var t=this;this.custom&&this.custom.onEnterInner?this.custom.onEnterInner.call(this,e):("#dest"!==this.def.type&&"#rdest"!==this.def.type||(e.enabled=!1,e.engineAudio.stop()),this.def.Sounds&&this.def.Sounds.length>0?(console.log("object sound",this.def.Sounds),this.game.mulle.playAudio(this.def.Sounds[0]).onStop.addOnce(function(){t.onEnterInnerCallback(e)},this)):this.onEnterInnerCallback(e))}},{key:"onEnterInnerCallback",value:function(e){if("#dest"!==this.def.type&&"#rdest"!==this.def.type||(this.game.state.states[this.game.state.current].saveSession(this),this.game.mulle.SetWhenDone=this.SetWhenDone),"#dest"===this.def.type){var t=this.def.DirResource;console.log("change scene",t),this.game.mulle.activeCutscene="00b008v0",this.game.state.states[this.game.mulle.scenes[t]]?this.game.state.start(this.game.mulle.scenes[t]):(alert('unhandled scene "'+this.game.mulle.scenes[t]+'"'),e.enabled=!0)}else if("#rdest"===this.def.type){var r=this.def.DirResource;console.log("change rscene",r),this.game.mulle.activeCutscene="00b008v0",this.game.state.states[this.game.mulle.scenes[r]]?this.game.state.start(this.game.mulle.scenes[r]):(alert('unhandled rscene "'+this.game.mulle.scenes[r]+'"'),e.enabled=!0)}}},{key:"onExitInner",value:function(e){this.custom&&this.custom.onExitInner&&this.custom.onExitInner.call(this,e)}},{key:"doCheck",value:function(){var e=this;this.def.CheckFor&&this.def.CheckFor.Cache&&this.def.CheckFor.Cache.forEach(function(t){e.game.mulle.user.Car.hasCache(t)&&"#NoDisplay"===e.def.IfFound&&(e.enabled=!1,e.renderable=!1,console.log("disable map object",e.id,e.def.CheckFor.Cache,e.game.mulle.user.Car.CacheList))})}},{key:"destroy",value:function(){var e,r,n,i,o;this.custom&&this.custom.onDestroy?this.custom.onDestroy.call(this):(e=t,r="destroy",n=this,o=en(tn(1&(i=3)?e.prototype:e),r,n),2&i&&"function"==typeof o?function(e){return o.apply(n,e)}:o)([])}}],n&&$r(r.prototype,n),i&&$r(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(x.A);function an(e){return an="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},an(e)}function sn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,un(n.key),n)}}function un(e){var t=function(e,t){if("object"!=an(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=an(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==an(t)?t:t+""}function ln(e,t,r){return t=hn(t),function(e,t){if(t&&("object"==an(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,cn()?Reflect.construct(t,r||[],hn(e).constructor):t.apply(e,r))}function cn(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(cn=function(){return!!e})()}function fn(){return fn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=hn(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},fn.apply(null,arguments)}function hn(e){return hn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},hn(e)}function mn(e,t){return mn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},mn(e,t)}const dn=function(e){function t(e){var r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(r=ln(this,t,[e])).setDirectorMember("05.DXR",121),r.spriteFrames={};for(var n=0;n<16;n++)r.spriteFrames[n+1]=r.game.mulle.getDirectorImage("05.DXR",110+n).name;return r.direction=1,r.enabled=!0,r.nametag=new Phaser.Text(r.game,0,-15,"Player",{font:"10px arial",fill:"#ffffff",stroke:"#000000",strokeThickness:2,boundsAlignH:"center",boundsAlignV:"middle"}),r.addChild(r.nametag),r}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mn(e,t)}(t,e),r=t,n=[{key:"updateImage",value:function(){var e=this.spriteFrames[this.direction];this.frameName=e}},{key:"destroy",value:function(){var e,r,n,i,o;this.nametag.destroy(),(e=t,r="destroy",n=this,o=fn(hn(1&(i=3)?e.prototype:e),r,n),2&i&&"function"==typeof o?function(e){return o.apply(n,e)}:o)([])}}],n&&sn(r.prototype,n),i&&sn(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(x.A);function pn(e){return pn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pn(e)}function yn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gn(n.key),n)}}function gn(e){var t=function(e,t){if("object"!=pn(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=pn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==pn(t)?t:t+""}const vn=function(){return e=function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.game=t,this.MapId=r,this._data={}},(t=[{key:"reset",value:function(){this.MapImage=this._data.MapImage,this.Topology=this._data.Topology,this.objects=this._data.objects}},{key:"fromJSON",value:function(e){this._data=e,this.reset()}}])&&yn(e.prototype,t),r&&yn(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}();function bn(e){return bn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},bn(e)}function wn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Pn(n.key),n)}}function Pn(e){var t=function(e,t){if("object"!=bn(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=bn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==bn(t)?t:t+""}const kn=function(){return e=function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.game=t,this.WorldId=r},(t=[{key:"getMap",value:function(e,t){return this.map[t-1][e-1]}},{key:"calcRandomDestinations",value:function(){this.allRDests={};for(var e=0;e<this.map.length;e++)for(var t=0;t<this.map[e].length;t++){var r=this.map[e][t];for(var n in r.MapId,r.objects){var i=r.objects[n][0];if("#rdest"===this.game.mulle.ObjectsDB[i].type){var o=new Phaser.Point(t+1,e+1);this.allRDests[i]?this.allRDests[i].push(o):this.allRDests[i]=[o]}}}}},{key:"randomizeDestinations",value:function(){for(var e in this.rDests={},this.allRDests){var t=this.allRDests[e];this.rDests[e]=this.game.rnd.pick(t)}}},{key:"fromJSON",value:function(e){this.StartCoordinate=Phaser.Point.parse(e.StartCoordinate),this.StartDirection=e.StartDirection,this.StartMap=Phaser.Point.parse(e.StartMap),this.map=[];for(var t=0;t<e.map.length;t++){for(var r=[],n=0;n<e.map[t].length;n++){var i=e.map[t][n],o=new vn(this.game,i);o.fromJSON(this.game.mulle.MapsDB[i]),r.push(o)}this.map.push(r)}}}])&&wn(e.prototype,t),r&&wn(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}();function Sn(e){return Sn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Sn(e)}function On(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jn(n.key),n)}}function jn(e){var t=function(e,t){if("object"!=Sn(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Sn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Sn(t)?t:t+""}function Dn(e,t,r){return t=Rn(t),function(e,t){if(t&&("object"==Sn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,An()?Reflect.construct(t,r||[],Rn(e).constructor):t.apply(e,r))}function An(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(An=function(){return!!e})()}function Cn(e,t,r,n){var i=xn(Rn(1&n?e.prototype:e),t,r);return 2&n&&"function"==typeof i?function(e){return i.apply(r,e)}:i}function xn(){return xn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=Rn(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},xn.apply(null,arguments)}function Rn(e){return Rn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Rn(e)}function _n(e,t){return _n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},_n(e,t)}const Tn=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Dn(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_n(e,t)}(t,e),r=t,n=[{key:"preload",value:function(){Cn(t,"preload",this,3)([]),this.game.load.pack("driving","assets/driving.json",null,this),this.game.load.pack("map","assets/map.json",null,this),this.game.load.atlas("topography","assets/topography/topography.png","assets/topography/topography.json",Phaser.Loader.TEXTURE_ATLAS_JSON_HASH)}},{key:"saveSession",value:function(e){console.log("save session"),this.game.mulle.lastSession={mapCoordinate:this.mapCoordinate.clone(),carPosition:this.driveCar.position.clone(),carDirection:this.driveCar.direction,carFuel:this.driveCar.fuelCurrent,carMaxFuel:this.driveCar.fuelMax},e&&(this.game.mulle.lastSession.mapObject=e.id)}},{key:"loadSession",value:function(){var e=this;this.changeMap(this.game.mulle.lastSession.mapCoordinate,!0),this.game.mulle.lastSession.mapObject&&this.mapObjects.forEach(function(t){t.id===e.game.mulle.lastSession.mapObject&&(console.log("disable object",t.id),t.enteredInner=!0,t.enteredOuter=!0)}),this.driveCar.position.set(this.game.mulle.lastSession.carPosition.x,this.game.mulle.lastSession.carPosition.y),this.driveCar.direction=this.game.mulle.lastSession.carDirection,this.driveCar.fuelCurrent=this.game.mulle.lastSession.carFuel}},{key:"removeSession",value:function(){this.game.mulle.lastSession=null}},{key:"changeMap",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log("Change map",e);var n=e.y,i=e.x;r||(n+=this.mapCoordinate.y,i+=this.mapCoordinate.x);var o=this.activeWorld.getMap(i,n);console.log("map coordinates",i,n);var a=o.MapId,s=o.MapImage,u=o.Topology;this.mapSprite.setDirectorMember("CDDATA.CXT",s),this.topSprite?this.topSprite.frameName=u:this.topSprite=this.game.add.sprite(-320,-240,"topography",u),this.topSprite.smoothed=!1,this.topBitmap.draw(this.topSprite,0,0),this.topBitmap.update();for(var l=this.mapObjects.children.length;l>=0;l--){var c=this.mapObjects.children[l];c&&c.def&&this.mapObjects.remove(c,!0)}o.objects&&o.objects.forEach(function(e){var r=e[0],n=Phaser.Point.parse(e[1]),i=e[2];if("#rdest"===t.game.mulle.ObjectsDB[r].type){var o=t.activeWorld.rDests[r];if(!t.mapCoordinate.equals(o))return o.x,void o.y}var a=new on(t.game,r,n,i);a.doCheck(),t.mapObjects.add(a),"#Correct"===a.def.type&&t.driveCar.position.distance(a.position)<=a.InnerRadius/2&&t.driveCar.position.set(a.position.x,a.position.y)}),this.mapCoordinate=new Phaser.Point(i,n),this.mapId=a,this.game.mulle.net.send({map:a})}},{key:"create",value:function(){var e=this;Cn(t,"create",this,3)([]),this.topBitmap=null,this.topSprite=null,this.mapSprite=null,this.mapObjects=null,this.driveCar=null,this.activeWorld=null,this.game.mulle.addAudio("driving"),this.game.physics.startSystem(Phaser.Physics.ARCADE),this.topBitmap=this.game.make.bitmapData(316,198),this.mapSprite=new x.A(this.game,320,200),this.mapSprite.inputEnabled=!0,this.mapSprite.hoverPoint=new Phaser.Point(0,0),this.game.add.existing(this.mapSprite),this.mapObjects=this.game.add.group(),this.activeWorld=new kn(this.game,"Da Hood"),this.activeWorld.fromJSON(this.game.mulle.WorldsDB["Da Hood"]),this.activeWorld.calcRandomDestinations(),this.activeWorld.randomizeDestinations(),this.game.mulle.lastSession?(this.driveCar=new qr(this.game),this.driveCar.topology=this.topBitmap,this.driveCar.state=this,this.loadSession(),this.removeSession(),this.mapObjects.add(this.driveCar)):(this.mapCoordinate=this.activeWorld.StartMap.clone(),this.driveCar=new qr(this.game),this.driveCar.setCoordinate(this.activeWorld.StartCoordinate),this.driveCar.setDirection(this.activeWorld.StartDirection),this.driveCar.topology=this.topBitmap,this.driveCar.state=this,this.mapObjects.add(this.driveCar),this.changeMap(this.mapCoordinate,!0)),this.spriteDashboard=new x.A(this.game,320,440),this.spriteDashboard.loadDirectorTexture("01b003v0"),this.game.add.existing(this.spriteDashboard);for(var r=[],n=27;n<43;n++)r.push(["05.DXR",n]);this.spriteFuelNeedle=new x.A(this.game,491,447),this.spriteFuelNeedle.loadDirectorTexture("01a001v0"),this.spriteFuelNeedle.addAnimation("fuel",r,10,!0),this.spriteFuelNeedle.animations.stop("fuel"),this.game.add.existing(this.spriteFuelNeedle),this.spriteSpeedometer=new x.A(this.game,99,446),this.spriteSpeedometer.loadDirectorTexture("01a003v0"),this.game.add.existing(this.spriteSpeedometer);var i=this.game.add.graphics(0,0);if(i.beginFill(16777215),i.drawRect(88,0,300,480),this.spriteSpeedometer.mask=i,this.lastFuelAmount=0,this.toolbox=new Ke(this.game,659,439),this.game.add.existing(this.toolbox),this.toolbox.showToolbox=function(){console.log("show",e),e.popupMenu=new x.A(e.game,320,200),e.popupMenu.loadDirectorTexture("19b001v0"),e.game.add.existing(e.popupMenu);var t,r={Steering:[116,114,197,244],Home:[216,116,281,249],Diploma:[316,127,368,264],quit:[390,125,460,266],Cancel:[470,255,528,365]},n={Home:"09d006v0",Cancel:"09d004v0",Steering:"09d005v0",quit:"09d003v0",Diploma:"09d002v0"},i={Home:function(){e.game.state.start("yard")},Cancel:function(){e.toolbox.toggleToolbox(e.toolbox)},quit:function(){e.game.state.start("menu")},Diploma:function(){e.game.state.start("diploma",!0,!1,e.key)}};e.popupMenuButtons=game.add.group();var o=function(o){var a=r[o],s=new Phaser.Button(e.game,a[0],a[1]-40);s.width=a[2]-a[0],s.height=a[3]-a[1],s.onInputOver.add(function(){t&&t.stop(),t=e.game.mulle.playAudio(n[o])}),s.onInputDown.add(function(){t&&t.stop(),i[o]()}),e.popupMenuButtons.addChild(s)};for(var a in r)o(a);return e.driveCar.enabled=!1,e.driveCar.engineAudio.stop(),!0},this.toolbox.hideToolbox=function(){return console.log("hide",e),e.popupMenu.destroy(),e.popupMenuButtons.destroy(),e.driveCar.enabled=!0,e.driveCar.engineAudio&&e.driveCar.engineAudio.play(),!0},this.game.mulle.net.connected&&(this.networkTicks=4,this.networkListener=this.networkUpdate.bind(this),this.game.mulle.net.socket.addEventListener("message",this.networkListener),this.netLoop=this.game.time.events.loop(Phaser.Timer.SECOND/this.networkTicks,this.networkSend,this),this.clients={},this.clientCars=this.game.add.group(),this.chatInput=document.createElement("input"),this.chatInput.style.position="absolute",this.chatInput.style.bottom="18%",this.chatInput.style.left="1%",this.chatInput.className="chatInput",this.chatInput.maxLength=140,this.chatInput.addEventListener("keyup",function(t){13===t.keyCode&&(e.game.mulle.net.send({msg:e.chatInput.value}),e.chatInput.value="")}),document.getElementById("player").appendChild(this.chatInput),this.chatLog=[],this.chatHistory=new Phaser.Text(this.game,0,0,"",{font:"11px arial",fill:"#ffffff",stroke:"#000000",strokeThickness:2,boundsAlignH:"left",boundsAlignV:"bottom"}),this.chatHistory.lineSpacing=-5,this.chatHistory.setTextBounds(5,290,300,80),this.game.add.existing(this.chatHistory)),this.game.mulle.cheats)for(var o=function(t){for(var r=document.createElement("div"),n=function(n){var i=e.activeWorld.map[t][n],o=document.createElement("button");o.innerHTML=i.MapId,o.className="button",o.addEventListener("click",function(r){e.changeMap(new Phaser.Point(n+1,t+1),!0)}),r.appendChild(o)},i=0;i<e.activeWorld.map[t].length;i++)n(i);document.getElementById("cheats").appendChild(r)},a=0;a<this.activeWorld.map.length;a++)o(a)}},{key:"networkRefresh",value:function(){var e=this;for(var t in this.clientCars.killAll(!0),this.clients){var r=new dn(this.game);r.position.set(this.clients[t].x,this.clients[t].y),r.updateImage(),this.clients[t].n&&(r.nametag.text=this.clients[t].n),r.inputEnabled=!0,r.input.useHandCursor=!0,r.events.onInputDown.add(function(){e.driveCar.enabled=!1;var r=new _e(e.game,320,240,e.clients[t].p,!0,!1);e.game.add.existing(r),setTimeout(function(){e.driveCar.enabled=!0,r.destroy()},3e3)}),this.clientCars.addChild(r),this.clients[t].car=r}}},{key:"networkUpdate",value:function(e){var t=JSON.parse(e.data);if(t.c&&(this.clients=t.c,this.networkRefresh()),t.leave&&(delete this.clients[t.leave],this.networkRefresh()),t.x&&t.y){if(!this.clients[t.i])return void console.error("invalid client",t.i);this.clients[t.i].x=t.x,this.clients[t.i].y=t.y,this.clients[t.i].d=t.d,game.add.tween(this.clients[t.i].car).to({x:t.x,y:t.y},Phaser.Timer.SECOND/this.networkTicks,Phaser.Easing.Linear.None,!0),this.clients[t.i].car.direction=t.d,this.clients[t.i].car.updateImage()}if(t.msg){var r="";this.chatLog.push(t),this.chatLog.forEach(function(e){r+=e.p+": "+e.msg+"\n"}),this.chatLog.length>5&&this.chatLog.splice(0,1),this.chatHistory.text=r.trim("\n")}}},{key:"networkSend",value:function(){if(this.game.mulle.net.socket){if(0===Object.keys(this.clients).length)return;if(this.lastX===Math.round(this.driveCar.position.x)&&this.lastY===Math.round(this.driveCar.position.y)&&this.lastD===this.driveCar.direction)return;this.game.mulle.net.send({x:Math.round(this.driveCar.position.x),y:Math.round(this.driveCar.position.y),d:this.driveCar.direction}),this.lastX=Math.round(this.driveCar.position.x),this.lastY=Math.round(this.driveCar.position.y),this.lastD=this.driveCar.direction}}},{key:"update",value:function(){var e=Math.max(0,Math.min(16,Math.round(this.driveCar.fuelCurrent/this.driveCar.fuelMax*16)));this.lastFuelAmount!==e&&(this.spriteFuelNeedle.animations.frame=this.spriteFuelNeedle.animations._outputFrames[e],this.lastFuelAmount=e),this.spriteSpeedometer.position.x=100+Math.abs(this.driveCar.speed/this.driveCar.getQuickProperty("speed")*140);var t=this.game.input.activePointer;if(this.game.input.keyboard.isDown(77)&&(this.driveCar.memeMode||(this.changeMap(new Phaser.Point(4,5),!0),this.driveCar.position.set(400,62),this.driveCar.direction=12,this.driveCar.enableMemeMode())),this.game.mulle.debug?t.isDown&&t.position.y<400&&(this.driveCar.position.set(t.position.x,t.position.y),this.driveCar.speed=0):(t.isDown&&(this.driveCar.keySteer=0),(this.driveCar.cursors.up.isDown||this.driveCar.cursors.down.isDown||this.driveCar.cursors.left.isDown||this.driveCar.cursors.right.isDown)&&(this.driveCar.keySteer=1)),!this.driveCar.keySteer){var r=t.position,n=this.driveCar.position,i=22.5*this.driveCar.direction,o=this.game.math.wrapAngle(r.angle(n,!0)-i-90-11.25);if(this.driveCar.Steering=o>=22.5?1:o<=-22.5?-1:0,t.isDown){var a=o<-90||o>90?-1:1;this.driveCar.changeSpeed(a)}else this.driveCar.changeSpeed(0)}}},{key:"render",value:function(){var e=this;this.game.mulle.debug&&this.mapObjects.forEach(function(t){t.def&&(e.game.debug.geom(t.outer,"rgba(155,0,0,.6)"),e.game.debug.geom(t.inner,"rgba(255,255,0,.6)"),e.game.debug.text("#"+t.id,t.x,t.y),e.game.debug.text("D "+t.def.DirResource,t.x,t.y+16))}),this.game.input.keyboard.addKey(Phaser.Keyboard.C).onDown.add(function(){e.game.state.start("credits")}),this.game.input.keyboard.addKey(Phaser.Keyboard.W).onDown.add(function(){e.game.state.start("worldselect")})}},{key:"shutdown",value:function(){this.topBitmap.destroy(),this.cutscene&&(this.cutscene.destroy(),this.cutscene=null),this.game.mulle.net.connected&&(this.game.mulle.net.socket.removeEventListener("message",this.networkListener),this.clientCars.destroy()),this.netLoop&&this.game.time.events.remove(this.netLoop),this.chatInput&&this.chatInput.parentNode.removeChild(this.chatInput),this.chatHistory&&this.chatHistory.destroy()}}],n&&On(r.prototype,n),i&&On(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(N);function En(e){return En="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},En(e)}function Mn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,In(n.key),n)}}function In(e){var t=function(e,t){if("object"!=En(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=En(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==En(t)?t:t+""}var Bn=function(){return e=function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.game=t,this.callback=n,this.callbackContext=i,this.sound=this.game.mulle.playAudio("00e028v0"),this.sprite=r,this.blinkSprite()},t=[{key:"blinkSprite",value:function(){var e=1e3/12*(arguments.length>0&&void 0!==arguments[0]?arguments[0]:2);this.toggleSprite(e)}},{key:"toggleSprite",value:function(e){this.sprite.visible=!this.sprite.visible,this.sprite.visible,this.sound.isPlaying,this.sound.isPlaying?this.game.time.events.add(e,this.toggleSprite,this,e):(this.sprite.destroy(),void 0!==this.callback&&this.callback.apply(this.callbackContext))}}],t&&Mn(e.prototype,t),r&&Mn(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}();const Nn=Bn;function Ln(e){return Ln="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ln(e)}function Fn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Xn(n.key),n)}}function Xn(e){var t=function(e,t){if("object"!=Ln(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Ln(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Ln(t)?t:t+""}function Hn(e,t,r){return t=Vn(t),function(e,t){if(t&&("object"==Ln(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Un()?Reflect.construct(t,r||[],Vn(e).constructor):t.apply(e,r))}function Un(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Un=function(){return!!e})()}function Jn(e,t,r,n){var i=Wn(Vn(1&n?e.prototype:e),t,r);return 2&n&&"function"==typeof i?function(e){return i.apply(r,e)}:i}function Wn(){return Wn="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=Vn(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},Wn.apply(null,arguments)}function Vn(e){return Vn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Vn(e)}function Gn(e,t){return Gn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Gn(e,t)}const qn=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Hn(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Gn(e,t)}(t,e),r=t,(n=[{key:"preload",value:function(){Jn(t,"preload",this,3)([]),this.game.load.pack("figgeferrum","assets/figgeferrum.json",null,this),this.subtitles=new et(this.game,"figgeferrum",["dutch","english","swedish"]),this.subtitles.preload()}},{key:"create",value:function(){var e=this;Jn(t,"create",this,3)([]),this.game.mulle.addAudio("figgeferrum"),this.subtitles.load(),this.car=null;var r=new x.A(this.game,320,240);r.setDirectorMember("92.DXR",1),this.game.add.existing(r);var n=new G(this.game,95,300,"mulleDefault");n.animations.play("idle"),n.talkAnimation="talkRegular",n.silenceAnimation="idle",this.game.add.existing(n),this.game.mulle.actors.mulle=n;var i=new G(this.game,271,347,"buffa");i.animations.play("idle"),this.game.add.existing(i),this.game.mulle.actors.buffa=i;var o=new x.A(this.game,102,292);o.setDirectorMember("92.DXR",16),this.game.add.existing(o);var a=new G(this.game,102,292,"figge");this.game.add.existing(a),this.game.mulle.actors.figge=a,this.game.mulle.playAudio("92e002v0"),this.game.mulle.user.Car.hasCache("#ExtraTank")?this.game.mulle.actors.mulle.talk("92d007v0",function(){e.game.state.start("world")}):(console.log("last session",this.game.mulle.lastSession),this.game.mulle.actors.figge.talk("92d002v0",function(){e.game.mulle.user.Car.hasCache("#Dog")?e.game.mulle.actors.mulle.talk("92d004v0",function(){var t=new G(e.game,200,363,"salkaLeft");t.animations.play("idle"),e.game.add.existing(t),e.game.mulle.actors.figge.talk("92d005v0",function(){var t=new x.A(e.game,168,413);t.setDirectorMember("92.DXR",11),e.game.add.existing(t),e.game.mulle.actors.mulle.talk("92d006v0",function(){e.game.mulle.user.Car.addCache("#ExtraTank"),e.game.mulle.lastSession.carFuel=e.game.mulle.lastSession.carMaxFuel,new Nn(e.game,t,function(){e.game.state.start("world")},e)})})}):e.game.mulle.actors.mulle.talk("92d003v0",function(){e.game.state.start("world")})}))}},{key:"shutdown",value:function(){this.game.mulle.stopAudio("92e002v0"),this.game.mulle.actors.figge=null,this.game.mulle.actors.mulle=null,this.game.mulle.actors.buffa=null,Jn(t,"shutdown",this,3)([])}}])&&Fn(r.prototype,n),i&&Fn(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(N);function Kn(e){return Kn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Kn(e)}function Yn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$n(n.key),n)}}function $n(e){var t=function(e,t){if("object"!=Kn(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Kn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Kn(t)?t:t+""}function Qn(e,t,r){return t=ti(t),function(e,t){if(t&&("object"==Kn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,zn()?Reflect.construct(t,r||[],ti(e).constructor):t.apply(e,r))}function zn(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(zn=function(){return!!e})()}function Zn(e,t,r,n){var i=ei(ti(1&n?e.prototype:e),t,r);return 2&n&&"function"==typeof i?function(e){return i.apply(r,e)}:i}function ei(){return ei="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=ti(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},ei.apply(null,arguments)}function ti(e){return ti=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ti(e)}function ri(e,t){return ri=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ri(e,t)}const ni=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Qn(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ri(e,t)}(t,e),r=t,(n=[{key:"preload",value:function(){Zn(t,"preload",this,3)([]),this.game.load.pack("roaddog","assets/roaddog.json",null,this)}},{key:"create",value:function(){var e=this;Zn(t,"create",this,3)([]),this.game.mulle.addAudio("roaddog"),this.car=null;var r=new x.A(this.game,320,240);r.setDirectorMember("85.DXR",25),this.game.add.existing(r),this.car=new _e(this.game,368,240,null,!0,!0),this.game.add.existing(this.car);var n=new G(this.game,480,386,"salkaRight");n.animations.play("idle"),this.game.add.existing(n),this.game.mulle.playAudio("85e001v0"),this.game.mulle.subtitle.setLines("85d002v0","swedish",["- Jahadu lilla {Salka}, du har kommit vilse igen.","- Då kör vi hem dig till {Figge}!"],"mulle"),this.game.mulle.subtitle.setLines("85d002v0","english",["- Oh {Salka}, you've gotten lost again.","- We'll drive you home to {Figge}!"],"mulle"),this.game.mulle.actors.mulle.talk("85d002v0",function(){e.game.mulle.activeCutscene="00b008v0",e.game.mulle.user.Car.addCache("#GotDogOnce"),e.game.mulle.user.Car.addCache("#Dog"),new Nn(e.game,n,function(){e.game.state.start("world")},e)})}},{key:"shutdown",value:function(){this.game.mulle.stopAudio("85e001v0"),Zn(t,"shutdown",this,3)([])}}])&&Yn(r.prototype,n),i&&Yn(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(N);function ii(e){return ii="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ii(e)}function oi(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return ai(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ai(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function ai(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function si(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ui(n.key),n)}}function ui(e){var t=function(e,t){if("object"!=ii(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=ii(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ii(t)?t:t+""}function li(e,t,r){return t=mi(t),function(e,t){if(t&&("object"==ii(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,ci()?Reflect.construct(t,r||[],mi(e).constructor):t.apply(e,r))}function ci(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(ci=function(){return!!e})()}function fi(e,t,r,n){var i=hi(mi(1&n?e.prototype:e),t,r);return 2&n&&"function"==typeof i?function(e){return i.apply(r,e)}:i}function hi(){return hi="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=mi(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},hi.apply(null,arguments)}function mi(e){return mi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},mi(e)}function di(e,t){return di=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},di(e,t)}const pi=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),li(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&di(e,t)}(t,e),r=t,(n=[{key:"preload",value:function(){fi(t,"preload",this,3)([]),this.game.load.pack("roadthing","assets/roadthing.json",null,this)}},{key:"create",value:function(){var e=this;fi(t,"create",this,3)([]),this.DirResource="84.DXR",this.game.mulle.addAudio("roadthing"),this.car=null;var r,n=new x.A(this.game,320,240);n.setDirectorMember(this.DirResource,25),this.game.add.existing(n),this.car=new _e(this.game,368,240,null,!0,!0),this.game.add.existing(this.car),this.game.mulle.SetWhenDone||(this.game.mulle.SetWhenDone={Cache:["#RoadThing1"],Parts:[287,"#Random"]});var i,o=oi(this.game.mulle.SetWhenDone.Parts);try{for(o.s();!(i=o.n()).done;){var a=i.value;if("#Random"===a)a=this.game.mulle.user.getRandomPart();else if(this.game.mulle.user.hasPart(a))continue;r=a;break}}catch(e){o.e(e)}finally{o.f()}console.log("given part",r);var s=new we(this.game,r,150,400);s.input.inputEnabled=!1,s.input.disableDrag(),this.game.add.existing(s),this.game.mulle.user.addPart("yard",r),this.game.mulle.user.Car.addCache(this.game.mulle.SetWhenDone.Cache[0]),this.game.mulle.actors.mulle.talk("84d001v0",function(){new Nn(e.game,s,function(){e.game.state.start("world")},e)})}},{key:"shutdown",value:function(){fi(t,"shutdown",this,3)([])}}])&&si(r.prototype,n),i&&si(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(N);function yi(e){return yi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yi(e)}function gi(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,vi(n.key),n)}}function vi(e){var t=function(e,t){if("object"!=yi(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=yi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==yi(t)?t:t+""}function bi(e,t,r){return t=Si(t),function(e,t){if(t&&("object"==yi(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,wi()?Reflect.construct(t,r||[],Si(e).constructor):t.apply(e,r))}function wi(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(wi=function(){return!!e})()}function Pi(e,t,r,n){var i=ki(Si(1&n?e.prototype:e),t,r);return 2&n&&"function"==typeof i?function(e){return i.apply(r,e)}:i}function ki(){return ki="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=Si(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},ki.apply(null,arguments)}function Si(e){return Si=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Si(e)}function Oi(e,t){return Oi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Oi(e,t)}const ji=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),bi(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Oi(e,t)}(t,e),r=t,(n=[{key:"preload",value:function(){Pi(t,"preload",this,3)([]),this.game.load.pack("carshow","assets/carshow.json",null,this)}},{key:"create",value:function(){var e=this;Pi(t,"create",this,3)([]),this.car=null,this.game.mulle.addAudio("carshow");var r=new x.A(this.game,320,240);r.setDirectorMember("94.DXR",200),this.game.add.existing(r);var n=new G(this.game,155,210,"judge");n.talkAnimation="talk",n.silenceAnimation="idle",this.game.add.existing(n),this.game.mulle.actors.judge=n;var i=new x.A(this.game,177,93);i.setDirectorMember("94.DXR",17),this.game.add.existing(i),i.visible=!1;var o=new G(this.game,89,337,"mulleDefault");o.talkAnimation="talkRegular",o.silenceAnimation="idle",this.game.add.existing(o),this.game.mulle.actors.mulle=o,o.animations.play("lookLeft"),this.car=new _e(this.game,321,288,null,!0,!1),this.game.add.existing(this.car),this.game.mulle.playAudio("94e001v0");var a,s=this.game.mulle.SetWhenDone.Medals[0],u=this.game.mulle.user.Car.getProperty("funnyfactor",0);a=u<2?1:u<3?2:u<5?3:u<7?4:5;var l={1:"94d008v0",2:"94d007v0",3:"94d006v0",4:"94d005v0",5:"94d004v0"};console.log("funnyfactor",u,a),n.displayScore=function(){n.talkAnimation="talkScore",console.log("display score"),i.setDirectorMember("94.DXR",a-1+17),i.visible=!0,n.talk(l[a],function(){console.log("end"),e.game.state.start("world")}),u>8&&!e.game.mulle.user.Car.hasMedal(s)&&e.game.mulle.user.Car.addMedal(s)},n.talkAnimation="talk",n.talk("94d003v0",function(){console.log("raise score"),setTimeout(function(){n.animations.play("raiseScore")},500)}),console.log("Car show")}},{key:"shutdown",value:function(){this.game.mulle.stopAudio("94e001v0"),this.game.mulle.actors.mulle=null,this.game.mulle.actors.judge=null}}])&&gi(r.prototype,n),i&&gi(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(N);function Di(e){return Di="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Di(e)}function Ai(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ci(n.key),n)}}function Ci(e){var t=function(e,t){if("object"!=Di(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Di(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Di(t)?t:t+""}function xi(e,t,r){return t=Ei(t),function(e,t){if(t&&("object"==Di(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Ri()?Reflect.construct(t,r||[],Ei(e).constructor):t.apply(e,r))}function Ri(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Ri=function(){return!!e})()}function _i(e,t,r,n){var i=Ti(Ei(1&n?e.prototype:e),t,r);return 2&n&&"function"==typeof i?function(e){return i.apply(r,e)}:i}function Ti(){return Ti="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=Ei(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},Ti.apply(null,arguments)}function Ei(e){return Ei=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ei(e)}function Mi(e,t){return Mi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Mi(e,t)}const Ii=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),xi(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Mi(e,t)}(t,e),r=t,(n=[{key:"preload",value:function(){_i(t,"preload",this,3)([]),this.game.load.pack("sturestortand","assets/sturestortand.json",null,this)}},{key:"create",value:function(){var e=this;_i(t,"create",this,3)([]),this.DirResource="88.DXR",this.game.mulle.addAudio("sturestortand"),this.car=null;var r=this.game.mulle.user.Car.hasCache("#Lemonade"),n=this.game.mulle.user.Car.hasPart(172),i=new x.A(this.game,320,240);i.setDirectorMember(this.DirResource,r?32:40),this.game.add.existing(i);var o=new G(this.game,351,234,"mulleDefault");if(o.talkAnimation="talkRegular",o.silenceAnimation="idle",this.game.add.existing(o),this.game.mulle.actors.mulle=o,o.scale.x=-1,this.car=new _e(this.game,41,301,null,!0,!1),this.game.add.existing(this.car),r){var a=new x.A(this.game,304,245);a.setDirectorMember(this.DirResource,17),this.game.add.existing(a);for(var s=[],u=0;u<7;u++)s.push([this.DirResource,17+u]);a.addAnimation("idle",s,5,!0),a.animations.play("idle"),(l=new G(this.game,285,162,"stureHappy")).talkAnimation="talk",l.silenceAnimation="idle",this.game.add.existing(l),this.game.mulle.actors.sture=l,l.talk("88d005v0",function(){o.talk("88d006v0",function(){e.game.mulle.user.addPart("yard",162),e.game.mulle.user.Car.removeCache("#Lemonade"),game.time.events.add(1*Phaser.Timer.SECOND,function(){e.game.state.start("world")})})})}else{var l;(l=new G(this.game,285,162,"stureSad")).talkAnimation="talk",l.silenceAnimation="idle",this.game.add.existing(l),this.game.mulle.actors.sture=l,l.talk("88d002v0",function(){n?o.talk("88d004v0",function(){game.time.events.add(1*Phaser.Timer.SECOND,function(){e.game.state.start("world")})}):o.talk("88d003v0",function(){game.time.events.add(1*Phaser.Timer.SECOND,function(){e.game.state.start("world")})})})}this.game.mulle.playAudio("88e001v0")}},{key:"shutdown",value:function(){this.game.mulle.stopAudio("88e001v0"),this.game.mulle.actors.mulle=null,_i(t,"shutdown",this,3)([])}}])&&Ai(r.prototype,n),i&&Ai(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(N);function Bi(e){return Bi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bi(e)}function Ni(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Li(n.key),n)}}function Li(e){var t=function(e,t){if("object"!=Bi(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Bi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Bi(t)?t:t+""}function Fi(e,t,r){return t=Ji(t),function(e,t){if(t&&("object"==Bi(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Xi()?Reflect.construct(t,r||[],Ji(e).constructor):t.apply(e,r))}function Xi(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Xi=function(){return!!e})()}function Hi(e,t,r,n){var i=Ui(Ji(1&n?e.prototype:e),t,r);return 2&n&&"function"==typeof i?function(e){return i.apply(r,e)}:i}function Ui(){return Ui="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=Ji(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},Ui.apply(null,arguments)}function Ji(e){return Ji=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ji(e)}function Wi(e,t){return Wi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Wi(e,t)}const Vi=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Fi(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Wi(e,t)}(t,e),r=t,(n=[{key:"preload",value:function(){Hi(t,"preload",this,3)([]),this.game.load.pack("saftfabrik","assets/saftfabrik.json",null,this)}},{key:"create",value:function(){var e=this;Hi(t,"create",this,3)([]),this.DirResource="87.DXR",this.game.mulle.addAudio("saftfabrik"),this.car=null;var r=this.game.mulle.user.Car.hasCache("#Lemonade"),n=this.game.mulle.user.Car.hasPart(172),i=new x.A(this.game,320,240);i.setDirectorMember(this.DirResource,208),this.game.add.existing(i);var o=new G(this.game,496,332,"mulleDefault");o.talkAnimation="talkRegular",o.silenceAnimation="idle",this.game.add.existing(o),this.game.mulle.actors.mulle=o,this.car=new _e(this.game,217,335,null,!0,!1),this.game.add.existing(this.car);var a=new G(this.game,537,218,"garson");a.talkAnimation="talk",a.silenceAnimation="idle",this.game.add.existing(a),this.game.mulle.actors.garson=a,r?o.talk("87d007v0",function(){game.time.events.add(1*Phaser.Timer.SECOND,function(){e.game.state.start("world")})}):a.talk("87d002v0",function(){n?(o.talk("87d004v0",function(){var t=new x.A(e.game,320,241);t.setDirectorMember(e.DirResource,26),e.game.add.existing(t);for(var r=[],n=0;n<4;n++)r.push([e.DirResource,26+n]);t.addAnimation("idle",r,5,!0),t.animations.play("idle"),e.game.mulle.playAudio("87e001v0",function(){t.destroy(),a.talk("87d005v0",function(){o.talk("87d006v0",function(){game.time.events.add(1*Phaser.Timer.SECOND,function(){e.game.state.start("world")})})})})}),e.game.mulle.user.Car.addCache("#Lemonade")):o.talk("87d003v0",function(){game.time.events.add(1*Phaser.Timer.SECOND,function(){e.game.state.start("world")})})})}},{key:"shutdown",value:function(){this.game.mulle.stopAudio("87e001v0"),this.game.mulle.actors.mulle=null,Hi(t,"shutdown",this,3)([])}}])&&Ni(r.prototype,n),i&&Ni(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(N);function Gi(e){return Gi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gi(e)}function qi(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ki(n.key),n)}}function Ki(e){var t=function(e,t){if("object"!=Gi(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Gi(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Gi(t)?t:t+""}function Yi(e,t,r){return t=Zi(t),function(e,t){if(t&&("object"==Gi(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,$i()?Reflect.construct(t,r||[],Zi(e).constructor):t.apply(e,r))}function $i(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return($i=function(){return!!e})()}function Qi(e,t,r,n){var i=zi(Zi(1&n?e.prototype:e),t,r);return 2&n&&"function"==typeof i?function(e){return i.apply(r,e)}:i}function zi(){return zi="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=Zi(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},zi.apply(null,arguments)}function Zi(e){return Zi=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Zi(e)}function eo(e,t){return eo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},eo(e,t)}const to=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Yi(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&eo(e,t)}(t,e),r=t,(n=[{key:"preload",value:function(){Qi(t,"preload",this,3)([]),this.game.load.pack("solhem","assets/solhem.json",null,this)}},{key:"create",value:function(){var e=this;Qi(t,"create",this,3)([]),this.DirResource="86.DXR",this.game.mulle.addAudio("solhem"),this.car=null;var r=new x.A(this.game,320,240);r.setDirectorMember(this.DirResource,1),this.game.add.existing(r);var n=this.game.mulle.user.Car.hasPart(173);if(this.game.mulle.user.hasStuff("#FerryTicket"))i=new _e(this.game,257,344,null,!0,!0),this.game.add.existing(i),this.game.mulle.actors.mulle.talk("86d007v0",function(){e.game.state.start("world")});else{var i=new _e(this.game,257,344,null,!0,!1);this.game.add.existing(i);var o=new G(this.game,350,398,"mulleDefault");o.animations.play("idle"),o.talkAnimation="talkRegular",o.silenceAnimation="idle",this.game.add.existing(o),this.game.mulle.actors.mulle=o;var a=new G(this.game,277,246,"miaBody");a.animations.play("idle"),a.talkAnimation="talk",a.silenceAnimation="idle",this.game.add.existing(a),this.game.mulle.actors.miaBody=a;var s=new G(this.game,535,336,"miaHead");s.animations.play("idle"),s.talkAnimation="talk",s.silenceAnimation="idle",this.game.add.existing(s),this.game.mulle.actors.miaHead=s;var u=new G(this.game,278,240,"cat");u.animations.play("idle"),this.game.add.existing(u),this.game.mulle.actors.cat=u,s.talk("86d002v0",function(){n?o.talk("86d004v0",function(){if(n){var t=new x.A(e.game,0,0);t.setDirectorMember(e.DirResource,3),t.sortIndex=12,i.add(t),i.forEach(function(e){173===e.partId&&e.destroy()}),i.sortLayers()}u.animations.play("jump1").onComplete.addOnce(function(){a.position.set(278,240),s.position.set(528,337),a.animations.play("catchIntro"),s.visible=!1,u.animations.play("jump2").onComplete.addOnce(function(){u.visible=!1,a.animations.play("catchEnd").onComplete.addOnce(function(){s.animations.play("idleCat"),s.visible=!0,s.talkAnimation="talkCat",s.silenceAnimation="idleCat",s.talk("86d005v0",function(){e.game.mulle.user.addStuff("#FerryTicket"),o.talk("86d006v0",function(){e.game.state.start("world")})})})})})}):o.talk("86d003v0",function(){e.game.state.start("world")})})}this.game.mulle.playAudio("86e005v0")}},{key:"shutdown",value:function(){this.game.mulle.actors.mulle=null,this.game.mulle.actors.miaHead=null,this.game.mulle.actors.miaBody=null,this.game.mulle.actors.cat=null,this.game.mulle.stopAudio("86e005v0"),Qi(t,"shutdown",this,3)([])}}])&&qi(r.prototype,n),i&&qi(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(N);function ro(e){return ro="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ro(e)}function no(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,io(n.key),n)}}function io(e){var t=function(e,t){if("object"!=ro(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=ro(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ro(t)?t:t+""}function oo(e,t,r){return t=lo(t),function(e,t){if(t&&("object"==ro(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,ao()?Reflect.construct(t,r||[],lo(e).constructor):t.apply(e,r))}function ao(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(ao=function(){return!!e})()}function so(e,t,r,n){var i=uo(lo(1&n?e.prototype:e),t,r);return 2&n&&"function"==typeof i?function(e){return i.apply(r,e)}:i}function uo(){return uo="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=lo(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},uo.apply(null,arguments)}function lo(e){return lo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},lo(e)}function co(e,t){return co=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},co(e,t)}const fo=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),oo(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&co(e,t)}(t,e),r=t,(n=[{key:"preload",value:function(){so(t,"preload",this,3)([]),this.game.load.pack("dorisdigital","assets/dorisdigital.json",null,this)}},{key:"create",value:function(){var e=this;so(t,"create",this,3)([]),this.DirResource="90.DXR",this.game.mulle.addAudio("dorisdigital");var r=new x.A(this.game,320,240);r.setDirectorMember(this.DirResource,1),this.game.add.existing(r);var n=new x.A(this.game,320,240);n.setDirectorMember(this.DirResource,18),this.game.add.existing(n),n.addAnimation("game",[["90.DXR",18],["90.DXR",19]],12,!0),n.play("game");var i=this.game.mulle.playAudio("90e001v0");if(console.log("given part",306),this.game.mulle.user.hasPart(306))this.car=new _e(this.game,446,368,null,!0,!0),this.game.add.existing(this.car),this.game.mulle.playAudio("90d007v0",function(){i.stop(),e.game.state.start("world")});else{this.car=new _e(this.game,446,368,null,!0,!1),this.game.add.existing(this.car);var o=new x.A(this.game,82,326);o.setDirectorMember("CDDATA.CXT",1003),this.game.add.existing(o);var a=new G(this.game,275,327,"buffa");a.animations.play("idle"),this.game.add.existing(a),this.game.mulle.actors.buffa=a,this.game.mulle.user.addPart("yard",306),this.game.mulle.playAudio("90d001v0",function(){e.game.mulle.playAudio("90d003v0",function(){console.log("return to world"),e.game.state.start("world"),i.stop()})})}}},{key:"shutdown",value:function(){so(t,"shutdown",this,3)([])}}])&&no(r.prototype,n),i&&no(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(N);function ho(e){return ho="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ho(e)}function mo(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,po(n.key),n)}}function po(e){var t=function(e,t){if("object"!=ho(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=ho(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ho(t)?t:t+""}function yo(e,t,r){return t=wo(t),function(e,t){if(t&&("object"==ho(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,go()?Reflect.construct(t,r||[],wo(e).constructor):t.apply(e,r))}function go(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(go=function(){return!!e})()}function vo(e,t,r,n){var i=bo(wo(1&n?e.prototype:e),t,r);return 2&n&&"function"==typeof i?function(e){return i.apply(r,e)}:i}function bo(){return bo="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=wo(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},bo.apply(null,arguments)}function wo(e){return wo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},wo(e)}function Po(e,t){return Po=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Po(e,t)}var ko=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),yo(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Po(e,t)}(t,e),r=t,n=[{key:"preload",value:function(){vo(t,"preload",this,3)([]),this.game.load.pack("viola","assets/viola.json",null,this),this.subtitles=new et(this.game,"viola",["dutch","english"]),this.subtitles.preload()}},{key:"create",value:function(){var e=this;vo(t,"create",this,3)([]),this.game.mulle.addAudio("viola"),this.subtitles.load(),this.game.mulle.playAudio("89e001v0");var r=new x.A(this.game,320,240);r.setDirectorMember("89.DXR",1),this.game.add.existing(r),this.car=new _e(this.game,445,370,null,!1,!1),this.game.add.existing(this.car);var n=new G(this.game,360,320,"buffa");n.setDirectorMember("00.CXT",214),this.game.add.existing(n),this.game.mulle.actors.buffa=n;var i=0,o=!1,a=this.game.time.events.loop(150,function(){!o&&i<8&&(n.animations.play("scratch1",null,!1),n.animations.currentAnim.onComplete.addOnce(function(){n.setDirectorMember("00.CXT",214),++i>=8&&(o=!0,e.game.time.events.add(3e3,function(){i=0,o=!1}))}))}),s=new x.A(this.game,246,154);s.setDirectorMember("89.DXR",18),this.game.add.existing(s);var u=18,l=this.game.time.events.loop(300,function(){++u>20&&(u=18),s.setDirectorMember("89.DXR",u)}),c=new x.A(this.game,2,332);c.setDirectorMember("CDDATA.CXT",436),c.partId=172,c.properties={Weight:4,Color:1,Funnyfactor:5},c.requires=["#b1"],c.covers=["#a5","#a6","#a7","#b1"],this.game.add.existing(c),this.game.mulle.playAudio("89d001v0",function(){e.game.mulle.playAudio("89d003v0",function(){e.game.mulle.user.Junk.yard[172]={x:e.game.rnd.integerInRange(290,580),y:440},e.game.time.events.remove(a),n.animations.stop(),new Nn(e.game,c,function(){e.game.mulle.stopAudio("89e001v0"),e.game.time.events.remove(l),e.game.time.events.remove(a),n.animations.stop(),e.game.state.start("world")},e)})})}},{key:"shutdown",value:function(){this.game.mulle.stopAudio("viola"),vo(t,"shutdown",this,3)([])}}],n&&mo(r.prototype,n),i&&mo(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(N);const So=ko;function Oo(e){return Oo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Oo(e)}function jo(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Do(n.key),n)}}function Do(e){var t=function(e,t){if("object"!=Oo(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Oo(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Oo(t)?t:t+""}function Ao(e,t,r){return t=_o(t),function(e,t){if(t&&("object"==Oo(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Co()?Reflect.construct(t,r||[],_o(e).constructor):t.apply(e,r))}function Co(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Co=function(){return!!e})()}function xo(e,t,r,n){var i=Ro(_o(1&n?e.prototype:e),t,r);return 2&n&&"function"==typeof i?function(e){return i.apply(r,e)}:i}function Ro(){return Ro="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=_o(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},Ro.apply(null,arguments)}function _o(e){return _o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_o(e)}function To(e,t){return To=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},To(e,t)}const Eo=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),Ao(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&To(e,t)}(t,e),r=t,(n=[{key:"preload",value:function(){xo(t,"preload",this,3)([]),this.game.load.pack("treecar","assets/treecar.json",null,this),this.subtitles=new et(this.game,"roadtree",["dutch","english"]),this.subtitles.preload()}},{key:"create",value:function(){xo(t,"create",this,3)([]),this.game.mulle.addAudio("treecar"),this.subtitles.load();var e=new x.A(this.game,320,240);e.setDirectorMember("83.DXR",1),this.game.add.existing(e),this.car=new _e(this.game,445,370,null,!0,!1),this.game.add.existing(this.car);var r=new x.A(this.game,320,240);r.setDirectorMember("83.DXR",2),this.game.add.existing(r);var n=this.game.mulle.user.Car.getProperty("strength",0);console.log("Car strength:",n),n<3?this.weakCar():this.strongCar(r)}},{key:"weakCar",value:function(){var e=this;this.game.mulle.playAudio("83d003v0",function(){e.game.state.start("world")})}},{key:"strongCar",value:function(e){var t=this;this.game.mulle.playAudio("83d007v0",function(){t.game.mulle.playAudio("83d008v0",function(){new Nn(t.game,e,function(){t.showReward()},t)})})}},{key:"showReward",value:function(){var e=this,t=this.game.mulle.user.getRandomPart(),r=this.game.mulle.PartsDB[t],n=new x.A(this.game,320,300);n.setDirectorMember("CDDATA.CXT",r.junkView),n.partId=t,this.game.add.existing(n),this.game.mulle.playAudio("00d035v0"),new Nn(this.game,n,function(){e.game.mulle.user.Junk.yard[t]={x:e.game.rnd.integerInRange(290,580),y:440},e.game.mulle.user.Car.addCache("#TreeRemoved"),e.game.state.start("world")},this)}},{key:"shutdown",value:function(){this.game.mulle.stopAudio("treecar"),xo(t,"shutdown",this,3)([])}}])&&jo(r.prototype,n),i&&jo(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(N);function Mo(e){return Mo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Mo(e)}function Io(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Bo(n.key),n)}}function Bo(e){var t=function(e,t){if("object"!=Mo(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Mo(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Mo(t)?t:t+""}function No(e,t,r){return t=Ho(t),function(e,t){if(t&&("object"==Mo(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Lo()?Reflect.construct(t,r||[],Ho(e).constructor):t.apply(e,r))}function Lo(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Lo=function(){return!!e})()}function Fo(e,t,r,n){var i=Xo(Ho(1&n?e.prototype:e),t,r);return 2&n&&"function"==typeof i?function(e){return i.apply(r,e)}:i}function Xo(){return Xo="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=Ho(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},Xo.apply(null,arguments)}function Ho(e){return Ho=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ho(e)}function Uo(e,t){return Uo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Uo(e,t)}const Jo=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),No(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Uo(e,t)}(t,e),r=t,(n=[{key:"preload",value:function(){Fo(t,"preload",this,3)([]),this.game.load.pack("luddelabb","assets/luddelabb.json",null,this),this.subtitles=new et(this.game,"luddelabb",["dutch","english"]),this.subtitles.preload()}},{key:"create",value:function(){Fo(t,"create",this,3)([]),this.game.mulle.addAudio("luddelabb"),this.subtitles.load(),this.game.mulle.playAudio("91e001v0");var e=new x.A(this.game,320,240);e.setDirectorMember("91.DXR",1),this.game.add.existing(e),this.car=new _e(this.game,445,370,null,!0,!1),this.game.add.existing(this.car);var r=new x.A(this.game,200,300);r.setDirectorMember("91.DXR",10),this.game.add.existing(r),this.playDialogs()}},{key:"playDialogs",value:function(){var e=this;this.game.mulle.playAudio("91d001v0",function(){e.game.mulle.playAudio("91d003v0",function(){e.game.mulle.playAudio("91d007v0",function(){e.giveReward()})})})}},{key:"giveReward",value:function(){var e=this,t=this.game.mulle.user.getRandomPart(),r=this.game.mulle.PartsDB[t],n=new x.A(this.game,320,300);n.setDirectorMember("CDDATA.CXT",r.junkView),n.partId=t,this.game.add.existing(n),this.game.mulle.playAudio("00d035v0"),new Nn(this.game,n,function(){e.game.mulle.user.Junk.yard[t]={x:e.game.rnd.integerInRange(290,580),y:440},e.game.mulle.user.Car.addCache("#LuddeLabVisited"),e.game.mulle.stopAudio("91e001v0"),e.game.state.start("world")},this)}},{key:"shutdown",value:function(){this.game.mulle.stopAudio("91e001v0"),Fo(t,"shutdown",this,3)([])}}])&&Io(r.prototype,n),i&&Io(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(N);function Wo(e){return Wo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wo(e)}function Vo(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Go(n.key),n)}}function Go(e){var t=function(e,t){if("object"!=Wo(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Wo(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Wo(t)?t:t+""}function qo(e,t,r){return t=Qo(t),function(e,t){if(t&&("object"==Wo(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Ko()?Reflect.construct(t,r||[],Qo(e).constructor):t.apply(e,r))}function Ko(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Ko=function(){return!!e})()}function Yo(e,t,r,n){var i=$o(Qo(1&n?e.prototype:e),t,r);return 2&n&&"function"==typeof i?function(e){return i.apply(r,e)}:i}function $o(){return $o="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=Qo(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},$o.apply(null,arguments)}function Qo(e){return Qo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Qo(e)}function zo(e,t){return zo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},zo(e,t)}const Zo=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),qo(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&zo(e,t)}(t,e),r=t,(n=[{key:"preload",value:function(){Yo(t,"preload",this,3)([]),this.game.load.pack("ocean","assets/ocean.json",null,this)}},{key:"create",value:function(){var e=this;Yo(t,"create",this,3)([]),this.game.mulle.addAudio("ocean"),this.game.mulle.playAudio("93e001v0");var r=new x.A(this.game,320,240);r.setDirectorMember("93.DXR",1),this.game.add.existing(r),this.car=new _e(this.game,445,370,null,!1,!1),this.game.add.existing(this.car);var n=new x.A(this.game,200,300);n.setDirectorMember("93.DXR",5),this.game.add.existing(n);var i=new x.A(this.game,250,320);i.setDirectorMember("00.CXT",214),this.game.add.existing(i);var o=new x.A(this.game,400,120);o.setDirectorMember("93.DXR",10),this.game.add.existing(o);var a=10;this.game.time.events.loop(200,function(){++a>12&&(a=10),o.setDirectorMember("93.DXR",a)}),this.game.time.events.add(3e3,function(){e.showWoodenWheel()})}},{key:"showWoodenWheel",value:function(){var e=this;if(this.game.mulle.user.Car.hasCache("#OceanVisited"))return this.game.mulle.stopAudio("93e001v0"),void this.game.state.start("world");var t=this.game.mulle.PartsDB[157],r=new x.A(this.game,320,280);r.setDirectorMember("CDDATA.CXT",t.junkView),r.partId=157,this.game.add.existing(r),this.game.mulle.playAudio("00d035v0"),new Nn(this.game,r,function(){e.game.mulle.user.Junk.yard[157]={x:e.game.rnd.integerInRange(290,580),y:440},e.game.mulle.user.Car.addCache("#OceanVisited"),e.game.mulle.stopAudio("93e001v0"),e.game.state.start("world")},this)}},{key:"shutdown",value:function(){this.game.mulle.stopAudio("93e001v0"),Yo(t,"shutdown",this,3)([])}}])&&Vo(r.prototype,n),i&&Vo(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(N);function ea(e){return ea="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ea(e)}function ta(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ra(n.key),n)}}function ra(e){var t=function(e,t){if("object"!=ea(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=ea(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ea(t)?t:t+""}function na(e,t,r){return t=sa(t),function(e,t){if(t&&("object"==ea(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,ia()?Reflect.construct(t,r||[],sa(e).constructor):t.apply(e,r))}function ia(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(ia=function(){return!!e})()}function oa(e,t,r,n){var i=aa(sa(1&n?e.prototype:e),t,r);return 2&n&&"function"==typeof i?function(e){return i.apply(r,e)}:i}function aa(){return aa="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=sa(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},aa.apply(null,arguments)}function sa(e){return sa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},sa(e)}function ua(e,t){return ua=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ua(e,t)}const la=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),na(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ua(e,t)}(t,e),r=t,(n=[{key:"preload",value:function(){oa(t,"preload",this,3)([])}},{key:"create",value:function(){oa(t,"create",this,3)([]),this.game.stage.backgroundColor="#1a3a5a",this.creditsY=this.game.height+50;var e=this.getCreditsText();this.creditsTextObj=this.game.add.text(this.game.width/2,this.creditsY,e,{font:"20px Arial",fill:"#ffffff",align:"center",wordWrap:!0,wordWrapWidth:500}),this.creditsTextObj.anchor.setTo(.5,0),this.mulle=this.game.add.sprite(100,this.game.height-150,null),this.mulle.anchor.setTo(.5,1),this.buffa=this.game.add.sprite(200,this.game.height-150,null),this.buffa.anchor.setTo(.5,1),this.scrollSpeed=.5,this.game.input.onDown.add(this.speedUp,this),this.fastMode=!1}},{key:"getCreditsText",value:function(){return"MIEL MONTEUR BOUWT AUTO'S\n    \nWeb Port 2025\n\n\n═══════════════════════\n\nORIGINELE GAME\n═══════════════════════\n\nOriginele Titel:\nMULLE MECK BYGGER BILAR\n\nOntwikkelaar:\nLevande Böcker\n(Levende Boeken)\n\nJaar:\n1997\n\n\n═══════════════════════\n\nCREATIEF TEAM\n═══════════════════════\n\nVerhaal & Concept:\nGeorge Johansson\n\nIllustraties:\nJens Ahlbom\n\nNederlandse Stem Miel:\nKurt Van Eeghem\n\n\n═══════════════════════\n\nNEDERLANDSE VERSIE\n═══════════════════════\n\nUitgever:\nTransposia\n\nLokalisatie:\nNederlands (NL)\nWest-Vlaams dialect\n\n\n═══════════════════════\n\nWEB PORT 2025\n═══════════════════════\n\nGame Engine:\nPhaser CE\n\nReverse Engineering:\nLingo → JavaScript port\n\nAssets Extractie:\nDirector/Shockwave tools\n\nDevelopment:\nOpen source project\n\n\n═══════════════════════\n\nPERSONAGES\n═══════════════════════\n\nMiel Monteur (Mulle Meck)\nRifka (Buffa) - De boxer\nStaf Schroot - Vriend\nLaika - Staf's hond\nPeggy PC - Computer expert\nMia - Kabouter\nSalka - De hond op de weg\nBoris Blaff - Avonturier\nViola - Accordeoniste\nSture Stortand - Tandarts\nDoris Digital - Tech expert\nFigge Ferrum - Uitvinder\n\n\n═══════════════════════\n\nLOCATIES\n═══════════════════════\n\nBlauwwater (Djupforsen)\nDe Garage\nHet Schroothof\nDe Wereld\nHet Strand\nDe Saftfabriek\nHet Automuseum\nEn vele anderen...\n\n\n═══════════════════════\n\nDANK AAN\n═══════════════════════\n\nDe originele ontwikkelaars\nbij Levande Böcker\n\nAlle fans die Miel Monteur\ndoor de jaren heen\neen warm hart toedragen\n\nEn natuurlijk...\nKurt Van Eeghem\nvoor zijn onvergetelijke stem\n\n\n═══════════════════════\n\n\n\"Er is geen schroot.\nAlles is gewoon oude dingen\ndie op nieuwe manieren\ngebruikt kunnen worden.\"\n\n- Miel Monteur\n\n\n═══════════════════════\n\n\nBedankt voor het spelen!\n\n\n═══════════════════════\n\n\nAmai, dat was het!\nReken maar!\n\n\n🔧🚗⚙️\n\n\n═══════════════════════\n\n\nKlik om terug te gaan\nnaar het hoofdmenu\n\n\n"}},{key:"update",value:function(){var e=this;this.fastMode?this.creditsY-=5*this.scrollSpeed:this.creditsY-=this.scrollSpeed,this.creditsTextObj.y=this.creditsY,this.creditsY<-this.creditsTextObj.height-200&&this.game.time.events.add(2e3,function(){e.returnToMenu()})}},{key:"speedUp",value:function(){this.fastMode?this.returnToMenu():this.fastMode=!0}},{key:"returnToMenu",value:function(){this.game.state.start("menu")}},{key:"shutdown",value:function(){oa(t,"shutdown",this,3)([])}}])&&ta(r.prototype,n),i&&ta(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(N);function ca(e){return ca="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ca(e)}function fa(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ha(n.key),n)}}function ha(e){var t=function(e,t){if("object"!=ca(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=ca(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ca(t)?t:t+""}function ma(e,t,r){return t=ga(t),function(e,t){if(t&&("object"==ca(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,da()?Reflect.construct(t,r||[],ga(e).constructor):t.apply(e,r))}function da(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(da=function(){return!!e})()}function pa(e,t,r,n){var i=ya(ga(1&n?e.prototype:e),t,r);return 2&n&&"function"==typeof i?function(e){return i.apply(r,e)}:i}function ya(){return ya="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=ga(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},ya.apply(null,arguments)}function ga(e){return ga=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ga(e)}function va(e,t){return va=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},va(e,t)}const ba=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),ma(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&va(e,t)}(t,e),r=t,(n=[{key:"preload",value:function(){pa(t,"preload",this,3)([]),this.game.load.pack("worldselect","assets/worldselect.json",null,this)}},{key:"create",value:function(){var e=this;pa(t,"create",this,3)([]),this.game.mulle.addAudio("worldselect");var r=new x.A(this.game,320,240);r.setDirectorMember("18.DXR",8),this.game.add.existing(r),this.game.add.text(320,50,"Selecteer een Wereld",{font:"32px Arial",fill:"#ffffff",align:"center"}).anchor.setTo(.5,.5),this.game.cache.getJSON("MissionsDB");var n=new Xe(this.game,320,240,{imageDefault:["18.DXR",9],imageHover:["18.DXR",10],click:function(){e.selectWorld("Da Hood")}});this.game.add.existing(n),this.game.add.text(320,240,"Blauwwater",{font:"24px Arial",fill:"#000000"}).anchor.setTo(.5,.5);var i=new Xe(this.game,320,420,{imageDefault:["18.DXR",27],click:function(){e.game.state.start("menu")}});this.game.add.existing(i)}},{key:"selectWorld",value:function(e){console.log("Selected world:",e),this.game.mulle.user.activeWorld=e,this.game.state.start("world")}},{key:"shutdown",value:function(){pa(t,"shutdown",this,3)([])}}])&&fa(r.prototype,n),i&&fa(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(N);function wa(e){return wa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},wa(e)}function Pa(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ka(n.key),n)}}function ka(e){var t=function(e,t){if("object"!=wa(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=wa(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==wa(t)?t:t+""}const Sa=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.game=t,this.textLines=[],this.lastLine=null,this.database={swedish:{},english:{}},this.setLines("20d124v0","swedish",["- Bra hjul, på riktiga fälgar."],"mulle"),this.setLines("03d012v0","swedish",["- Inga hjul, inge kul, inge snurr och inge rull."],"mulle"),this.setLines("03d013v0","swedish",["- Det verkar som om liksom själva motorn fattas."],"mulle"),this.setLines("03d014v0","swedish",["- Batteriet som ska ge ström, var är det?"],"mulle"),this.setLines("03d015v0","swedish",["- Soppa saknas!","- Tanken är inte bara tom,","- den finns ju inte ens!"],"mulle"),this.setLines("03d016v0","swedish",["- Hördu, här fattas ju växellådan!","- Det är ju den som ser till att motorn kan driva hjulen."],"mulle"),this.setLines("03d017v0","swedish",["- Ratten kallas femte hjulet.","- Med den styr man i sol som mulet."],"mulle"),this.setLines("03d018v0","swedish",["- Stopp, stopp stopp! Hur ska du bromsa?"],"mulle"),this.setLines("20d124v0","english",["- Good wheels, on real rims."],"mulle"),this.setLines("03d012v0","english",["- No wheels, no fun, no spin, no roll."],"mulle"),this.setLines("03d013v0","english",["- It seems as if the engine itself is missing."],"mulle"),this.setLines("03d014v0","english",["- The battery that's gonna supply power, where's that?"],"mulle"),this.setLines("03d015v0","english",["- No juice!","- The tank isn't just empty,","- it doesn't exist!"],"mulle"),this.setLines("03d016v0","english",["- Hey! The transmission is missing!","- It's the one making it possible for the engine to spin the wheels."],"mulle"),this.setLines("03d017v0","english",["- The steering wheel","- is called the fifth wheel.","- With it, you steer whether it's sunny or cloudy."],"mulle"),this.setLines("03d018v0","english",["- Stop, stop stop! How are you going to brake?"],"mulle"),this.actorColors={mulle:"#CDE7CF"}},(t=[{key:"makeObject",value:function(){this.textObject&&this.textObject.destroy(),this.textObject=new Phaser.Text(this.game,0,0,"",{font:"20px arial",fill:"#ffffff",stroke:"#000000",strokeThickness:3,backgroundColor:"rgba(0, 0, 0, .6)",align:"center",boundsAlignH:"center",boundsAlignV:"bottom"}),this.textObject.setTextBounds(0,420,640,40),this.textObject.lineSpacing=-8,this.game.add.existing(this.textObject),console.log("add text",this.textObject)}},{key:"showLine",value:function(e,t){var r=this;if(!e)return console.error("subtitle line with no text"),!1;this.textObject||this.makeObject();var n=this.textLines.push({text:e,time:Date.now(),actor:t}),i=1e3*Math.log(e.length);return this.game.time.events.add(i,function(){console.log("remove line",n),r.textLines.splice(0,1),r.refresh()}),this.refresh(),this.lastLine=Date.now(),!0}},{key:"getData",value:function(e,t){return t||(t=this.game.mulle.user?this.game.mulle.user.language:this.game.mulle.defaultLanguage),!(!this.database[t]||!this.database[t][e])&&this.database[t][e]}},{key:"setLines",value:function(e,t,r,n){return!!this.database[t]&&(this.database[t][e]={lines:r,actor:n},!0)}},{key:"refresh",value:function(){var e=this;this.textObject.clearColors();var t="",r=function(r){var n=e.textLines[r].text;n=n.replace(/\{([A-Za-z0-9\s]+)\}/g,function(n,i,o){return e.textObject.addColor("#88B14E",t.length-r+o),e.textObject.addColor("#FFFFFF",t.length-r+o+i.length),i}),t+=n,t+="\n"};for(var n in this.textLines)r(n);t=t.trim("\n"),this.textObject.text=t,this.textObject.visible=""!==t}}])&&Pa(e.prototype,t),r&&Pa(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}();function Oa(e){return Oa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Oa(e)}function ja(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Da(n.key),n)}}function Da(e){var t=function(e,t){if("object"!=Oa(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Oa(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Oa(t)?t:t+""}function Aa(e,t,r){return t=xa(t),function(e,t){if(t&&("object"==Oa(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Ca()?Reflect.construct(t,r||[],xa(e).constructor):t.apply(e,r))}function Ca(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Ca=function(){return!!e})()}function xa(e){return xa=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},xa(e)}function Ra(e,t){return Ra=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ra(e,t)}const _a=function(){function e(t,r){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Aa(this,e,[t,r])}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ra(e,t)}(e,Phaser.AudioSprite),t=e,(r=[{key:"playId",value:function(e){for(var t in this.config.spritemap)if(this.config.spritemap[t].id&&e===this.config.spritemap[t].id)return this.play(t)}}])&&ja(t.prototype,r),n&&ja(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r,n}();var Ta=r(913);function Ea(e){return Ea="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ea(e)}function Ma(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,o,a,s=[],u=!0,l=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(s.push(n.value),s.length!==t);u=!0);}catch(e){l=!0,i=e}finally{try{if(!u&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ia(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ia(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ia(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Ba(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Na(n.key),n)}}function Na(e){var t=function(e,t){if("object"!=Ea(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Ea(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Ea(t)?t:t+""}const La=function(){return e=function e(t,r,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:12,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,s=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],u=!(arguments.length>7&&void 0!==arguments[7])||arguments[7];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.game=t,this.movie=r,this.frames=n,this.offsetX=o,this.offsetY=a,this.destroy=s,this.director_pos=u;var l=Ma(this.resolveCastToSprites(),3),c=l[0],f=l[1],h=l[2];this.spriteSheet=c,this.spriteFrames=f,this.spriteFrameObjects=h,this.createSprite(),this.frameCount=n.length,this.delay=1e3/i},t=[{key:"resolveCastToSprites",value:function(){var e,t,r=(e=this.frames,t="cast",e.map(function(e){return e[t]}));return Ta.A.resolveDirectorFrames(game,this.movie,r)}},{key:"getPosition",value:function(e){var t,r;if(0===this.offsetX&&0===this.offsetY){var n=Ma(Pt.A.CenterToOuter(this.frames[e].x,this.frames[e].y,this.frames[e].h,this.frames[e].w),2);t=n[0],r=n[1]}else t=this.frames[e].x-this.offsetX,r=this.frames[e].y-this.offsetY;return[t,r]}},{key:"createSprite",value:function(){if(this.director_pos)this.sprite=new Phaser.Sprite(this.game,null,null,this.spriteSheet),this.setFrame(0);else{var e=Ma(this.getPosition(0),2),t=e[0],r=e[1];this.sprite=new Phaser.Sprite(this.game,t,r,this.spriteSheet,this.spriteFrameObjects[0].name)}this.currentSprite=this.spriteFrames[0],this.currentFrame=0}},{key:"play",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;this.setNextFrame(),this.callback=e,this.callbackContext=t}},{key:"setFrame",value:function(e){if(this.currentFrame=e,this.director_pos){var t=this.spriteFrameObjects[e];this.sprite.x=this.frames[e].x,this.sprite.y=this.frames[e].y,this.sprite.pivot=t.regpoint}else{var r=Ma(this.getPosition(e),2),n=r[0],i=r[1];this.sprite.x=n,this.sprite.y=i}this.spriteFrames[e]!==this.currentSprite&&(console.log("Set texture to ".concat(this.spriteFrames[e]," at frame ").concat(e)),this.sprite.loadTexture(this.spriteSheet,this.spriteFrames[e]),this.currentSprite=this.spriteFrames[e])}},{key:"setNextFrame",value:function(){this.setFrame(this.currentFrame+1),this.currentFrame+1<this.frameCount?game.time.events.add(this.delay,this.setNextFrame,this):(this.destroy&&this.sprite.destroy(),void 0!==this.callback&&this.callback.apply(this.callbackContext))}}],r=[{key:"offset",value:function(e,t){return[e-320,t-240]}}],t&&Ba(e.prototype,t),r&&Ba(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}();function Fa(e){return Fa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fa(e)}function Xa(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Ha(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ha(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function Ha(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Ua(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ja(n.key),n)}}function Ja(e){var t=function(e,t){if("object"!=Fa(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Fa(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Fa(t)?t:t+""}const Wa=function(){return e=function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.game=t},(t=[{key:"getPart",value:function(){if(console.log(this.game.mulle),void 0===this.game.mulle.SetWhenDone)return console.error("SetWhenDone is not defined, state not started from MapObject?"),0;var e,t=Xa(this.game.mulle.SetWhenDone.Parts);try{for(t.s();!(e=t.n()).done;){var r=e.value;if("#Random"===r)return this.game.mulle.user.getRandomPart();if(!this.game.mulle.user.hasPart(r))return r}}catch(e){t.e(e)}finally{t.f()}}},{key:"showPart",value:function(e,t,r){var n=new we(this.game,e,t,r);return n.input.inputEnabled=!1,n.input.disableDrag(),n}}])&&Ua(e.prototype,t),r&&Ua(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,r}();function Va(e){return Va="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Va(e)}function Ga(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return qa(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?qa(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw o}}}}function qa(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Ka(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ya(n.key),n)}}function Ya(e){var t=function(e,t){if("object"!=Va(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=Va(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Va(t)?t:t+""}function $a(e,t,r){return t=es(t),function(e,t){if(t&&("object"==Va(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,Qa()?Reflect.construct(t,r||[],es(e).constructor):t.apply(e,r))}function Qa(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Qa=function(){return!!e})()}function za(e,t,r,n){var i=Za(es(1&n?e.prototype:e),t,r);return 2&n&&"function"==typeof i?function(e){return i.apply(r,e)}:i}function Za(){return Za="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=es(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},Za.apply(null,arguments)}function es(e){return es=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},es(e)}function ts(e,t){return ts=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ts(e,t)}const rs=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),$a(this,t,arguments)}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ts(e,t)}(t,e),r=t,(n=[{key:"preload",value:function(){za(t,"preload",this,3)([]),this.game.load.pack("mudcar","assets/mudcar.json",null,this),this.dirResource="82.DXR",this.game.load.json("JustDoIt_car","data/score/82.DXR_JustDoIt_4.json"),this.game.load.json("JustDoIt_rope","data/score/82.DXR_JustDoIt_5.json"),this.game.load.json("MudcarAnimations","data/82.DXR-animations.json")}},{key:"driverAnimation",value:function(){var e=this,t=Pt.A.sprite(this.game,412,216,this.dirResource,26);this.car_layer.add(t);var r=this.animations.TittAnimChart.Actions.suck;Ta.A.addAnimation(t,"suck",r,26,!0),t.animations.play("suck"),this.game.mulle.playAudio("82d009v0",function(){t.destroy(),e.checkStrength()})}},{key:"checkStrength",value:function(){var e=this.game.mulle.user.Car.getProperty("strength");console.log("Car strength is",e),e<=2?this.weakCar():this.strongCar()}},{key:"addPart",value:function(){var e=new Wa(this.game);this.partId=e.getPart(),this.partSprite=e.showPart(this.partId,412,326),this.background_layer.add(this.partSprite)}},{key:"findPart",value:function(){var e=this,t=new G(this.game,15,254,"mulleDefault"),r=Pt.A.sprite(this.game,218,244,this.dirResource,57);this.game.add.existing(r),t.talkAnimation="talkRegular",t.silenceAnimation="idle",this.game.add.existing(t),this.game.mulle.actors.mulle=t,this.game.mulle.actors.mulle.talk("82d006v0",function(){new Nn(e.game,e.partSprite,e.exit,e)})}},{key:"strongCar",value:function(){var e=this;this.moose(),this.addPart(),this.game.mulle.playAudio("82e002v0",function(){e.buffaEnterAnimation()});var t=this.animations.StrongCarAnimChart.Actions.strong;Ta.A.addAnimation(this.rope,"strong",t,34).onComplete.add(this.pullCar,this),this.rope.animations.play("strong",12)}},{key:"pullCar",value:function(){this.stuckCar.destroy(),this.rope.destroy();var e=this.game.cache.getJSON("JustDoIt_car"),t=new La(this.game,this.dirResource,e);this.game.add.existing(t.sprite),t.play();var r=this.game.cache.getJSON("JustDoIt_rope"),n=new La(this.game,this.dirResource,r);this.game.add.existing(n.sprite),n.play(),this.game.mulle.user.Car.addCache("#RescuedMudCar")}},{key:"weakCar",value:function(){var e=this;this.moose();var t=this.animations.WeakCarAnimChart.Actions.Svag;Ta.A.addAnimation(this.rope,"weak",t,34),console.log("Engine too weak"),this.rope.animations.play("weak",12,!0),this.game.mulle.playAudio("82e001v0",function(){console.log("Audio finished, stop animation"),e.rope.animations.stop("weak",!0),e.game.mulle.playAudio("82d003v0",function(){e.game.state.start("world")})})}},{key:"buffaEnterAnimation",value:function(){var e,t=0,r=[],n=Ga(this.animations.SittAnimChart.Actions.Sitt);try{for(n.s();!(e=n.n()).done;)e.value,r[t]={x:5*t-16,y:239,cast:50+t},t+=1}catch(e){n.e(e)}finally{n.f()}this.buffaAnimation=new La(this.game,this.dirResource,r),this.game.add.existing(this.buffaAnimation.sprite),this.buffaAnimation.play(this.findPart,this)}},{key:"moose",value:function(){var e=this.animations.MooseAnimChart.Actions.Blink,t=Pt.A.sprite(this.game,87,155,this.dirResource,18);this.game.add.existing(t),Ta.A.addAnimation(t,"blink",e,18),t.animations.play("blink",12,!1,!0)}},{key:"create",value:function(){za(t,"create",this,3)([]),this.game.mulle.addAudio("mudcar"),this.car=null,this.background_layer=this.game.add.group(),this.car_layer=this.game.add.group();var e=Pt.A.sprite(this.game,320,240,this.dirResource,1);this.background_layer.add(e),this.stuckCar=Pt.A.sprite(this.game,389,279,this.dirResource,43),this.car_layer.add(this.stuckCar),this.rope=Pt.A.sprite(this.game,321,248,this.dirResource,34),this.car_layer.add(this.rope),this.animations=this.game.cache.getJSON("MudcarAnimations"),this.driverAnimation()}},{key:"exit",value:function(){this.game.state.start("world")}}])&&Ka(r.prototype,n),i&&Ka(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r;var r,n,i}(N);function ns(e){return ns="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ns(e)}function is(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,os(n.key),n)}}function os(e){var t=function(e,t){if("object"!=ns(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=ns(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==ns(t)?t:t+""}function as(e,t,r){return t=us(t),function(e,t){if(t&&("object"==ns(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,ss()?Reflect.construct(t,r||[],us(e).constructor):t.apply(e,r))}function ss(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(ss=function(){return!!e})()}function us(e){return us=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},us(e)}function ls(e,t){return ls=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ls(e,t)}var cs={},fs={};var hs=new(function(){function e(){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),(t=as(this,e,[{width:640,height:480,type:Phaser.AUTO,parent:"player",antialias:!1}])).mulle={},t.mulle.game=t,t.mulle.debug=!1,t.mulle.cheats=!0,t.mulle.networkEnabled=!0,t.mulle.networkServer="wss://miel.dtun.nl/ws",t.mulle.networkDevServer="ws://localhost:8765",t.mulle.defaultLanguage="english",t.director=new Pt.A(t),t.mulle.scenes={"02":"junk","03":"garage","04":"yard","05":"world","06":"album","08":"diploma",10:"menu",12:"credits",18:"worldselect",66:"plugin",82:"mudcar",83:"treecar",84:"roadthing",85:"roaddog",86:"solhem",87:"saftfabrik",88:"sturestortand",89:"viola",90:"dorisdigital",91:"luddelabb",92:"figgeferrum",93:"ocean",94:"carshow"},t.mulle.states={boot:u,load:w,menu:ce,credits:la,worldselect:ba,junk:Et,garage:ht,yard:$t,world:Tn,album:Ar,diploma:Lr,mudcar:rs,treecar:Eo,roadthing:pi,roaddog:ni,solhem:to,saftfabrik:Vi,sturestortand:Ii,dorisdigital:fo,luddelabb:Jo,figgeferrum:qn,ocean:Zo,viola:So,carshow:ji},t.mulle.audio={},t.mulle.subtitle=new Sa(t),t.mulle.actors={},t.mulle.playAudio=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;for(var r in this.game.mulle.audio){var n=this.game.mulle.audio[r];for(var i in n.sounds)if(n.sounds[i].extraData&&e.toLowerCase()===n.sounds[i].extraData.dirName.toLowerCase()){var o=n.play(i);return o&&t&&o.onStop.addOnce(t),o}}return console.error("sound not found",e,this.game.mulle.audio),!1},t.mulle.addAudio=function(e){if(!this.game.mulle.audio[e]){for(var t in this.game.mulle.audio[e]=new _a(this.game,e+"-audio"),this.game.mulle.audio[e].config.spritemap)this.game.mulle.audio[e].sounds[t].extraData=this.game.mulle.audio[e].config.spritemap[t].data;this.game.mulle.audio[e]}},t.mulle.stopAudio=function(e){for(var t in this.game.mulle.audio){var r=this.game.mulle.audio[t];for(var n in r.sounds)if(r.sounds[n].extraData&&e===r.sounds[n].extraData.dirName)return r.stop(n)}return console.error("sound not found",e),!1},t.mulle.cursor=new C(t),t.mulle.PartsDB={},t.mulle.getPart=function(e){return this.PartsDB[e]},t.mulle.UsersDB=[],t.mulle.saveData=function(){window.localStorage.setItem("mulle_SaveData",JSON.stringify(this.game.mulle.UsersDB))},t.mulle.setData=function(e,t){this.game.mulle.UsersDB[this.game.mulle.activeProfile][e]=t},t.mulle.loadData=function(){this.game.mulle.UsersDB={};var e=window.localStorage.getItem("mulle_SaveData");if(e){var t=JSON.parse(e);for(var r in t)this.game.mulle.UsersDB[r]=new re(this.game,t[r]),this.game.mulle.UsersDB[r];this.game.mulle.UsersDB}else console.warn("[userdata]","empty")},t.mulle.findFrame=function(e,t){for(var r in e){var n=e[r];if(n.frameData.checkFrameName(t))return n.key}return!1},t.mulle.frameLookup={},t.mulle.findFrameById=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this.game.cache.getKeys(Phaser.Cache.IMAGE);for(var n in r){var i=this.game.cache.getImage(r[n],!0),o=i.frameData.getFrames();for(var a in o)if(o[a].id&&e===o[a].id)return t?{frame:o[a],key:i.key,name:o[a].name}:[i.key,o[a].name]}return!1},t.mulle.findDirectorMember=function(e){if(cs[e])return cs[e];var t=this.game.cache.getKeys(Phaser.Cache.IMAGE);for(var r in t){var n=this.game.cache.getImage(t[r],!0).frameData.getFrames();for(var i in n)if(n[i].dirName===e)return cs[e]=n[i],n[i]}console.error("get member fail",e)},t.mulle.getDirectorImage=function(e,t){if(!e||!t)return!1;var r=e+"_"+t;if(fs[r])return fs[r];var n=this.game.cache.getKeys(Phaser.Cache.IMAGE);for(var i in n){var o=this.game.cache.getImage(n[i],!0),a=o.frameData.getFrames();for(var s in a)if(a[s].dirFile===e&&(a[s].dirNum===t||a[s].dirName===t)){var u={frame:a[s],key:o.key,name:a[s].name};return fs[r]=u,u}}return console.error("get image fail",e,t),!1},t.mulle.getFrameRegPoint=function(e){var t=this.game.mulle.findFrameById(e,!0);return!!t&&t.regpoint},t.mulle.net=new O(t),t}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ls(e,t)}(e,Phaser.Game),t=e,(r=[{key:"setup",value:function(){for(var e in this.mulle.states)this.state.add(e,this.mulle.states[e]);this.state.start("boot")}}])&&is(t.prototype,r),n&&is(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,r,n}());Phaser.AnimationParser.JSONDataHash=function(e,t){if(!t.frames)return console.warn("Phaser.AnimationParser.JSONDataHash: Invalid Texture Atlas JSON given, missing 'frames' object"),void console.log(t);var r,n=new Phaser.FrameData,i=t.frames,o=0;for(var a in i)r=n.addFrame(new Phaser.Frame(o,i[a].frame.x,i[a].frame.y,i[a].frame.w,i[a].frame.h,a)),i[a].trimmed&&r.setTrim(i[a].trimmed,i[a].sourceSize.w,i[a].sourceSize.h,i[a].spriteSourceSize.x,i[a].spriteSourceSize.y,i[a].spriteSourceSize.w,i[a].spriteSourceSize.h),i[a].rotated&&(r.rotated=!0),i[a].regpoint&&(r.regpoint=new Phaser.Point(i[a].regpoint.x,i[a].regpoint.y)),r.dirName=i[a].dirName,r.dirFile=i[a].dirFile,r.dirNum=i[a].dirNum,i[a].id&&(r.id=i[a].id),o++;return n},window.addEventListener("beforeunload",function(e){hs.state.states[hs.state.current].shutdown()}),window.game=hs})()})();